users.union.CountRows = SELECT count (1)c FROM(SELECT DISTINCT  ADGANG_ID, SrcSystemId from stg.MSCRUS_Adgang where AD_Login is not NULL AND IsDeleted=0 union select DISTINCT  ADGANG_ID, SrcSystemId from stg.UNITY_Adgang where AD_Login is not NULL AND IsDeleted=0)q
users.destinationTable.CountRows = select count (*) c from sup.stUser

usersCompany.conditionForAdgangLinOnly.CountRows = select count (*) c from (select  distinct usersBycode.idStUser, hubC.dwhIdHubCompany from hub.hubCompany hubC inner join (select src.VOR_REF, src.SELSKAB, src.SrcSystemId, stU.idStUser from sup.stUser stU  inner join (select distinct VOR_REF, SELSKAB, SrcSystemId   from StagingAreaTest.stg.MSCRUS_AdgangLin union select  distinct VOR_REF, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_AdgangLin) src on src.VOR_REF = stU.userCode)  usersBycode on usersBycode.SELSKAB = hubC.CompanyId )q
usersCompany.conditionForAdgangOnly.CountRows =  select count (*) c from (select src1.AD_LOGIN, src1.SrcSystemId, src1.START_SEL, hubC.dwhIdHubCompany from hub.hubCompany hubC inner join (select scrWithKeys.AD_Login, scrWithKeys.START_SEL, scrWithKeys.SrcSystemId from (select distinct AD_Login, START_SEL, SrcSystemId from StagingAreaTest.stg.MSCRUS_Adgang where AD_Login is not null union select distinct AD_Login, START_SEL, SrcSystemId from StagingAreaTest.stg.UNITY_Adgang where AD_Login is not null) scrWithKeys inner join (select distinct AD_Login from StagingAreaTest.stg.MSCRUS_Adgang where AD_Login is not null union select distinct AD_Login  from StagingAreaTest.stg.UNITY_Adgang where AD_Login is not null) src on src.AD_Login=scrWithKeys.AD_Login) src1 on src1.START_SEL = hubC.CompanyId)w

usersCompany.condition.CountRows = SELECT count (1) c FROM(SELECT hub.dwhIdHubCompany, src.ADGANG_ID, src.srcSystemId FROM hub.hubCompany hub INNER JOIN (SELECT DISTINCT  ADGANG_ID, SrcSystemId, START_SEL from StagingAreaTest.stg.MSCRUS_Adgang where AD_Login is not NULL union select DISTINCT  ADGANG_ID, SrcSystemId, START_SEL from StagingAreaTest.stg.UNITY_Adgang where AD_Login is not NULL) src ON hub.companyId =  src.START_SEL UNION SELECT hub.dwhIdHubCompany, srcstU.userId as ADGANG_ID, srcstU.srcSystemId FROM hub.hubCompany hub INNER JOIN (SELECT src.SELSKAB, stU.userId, stU.srcSystemId  FROM sup.stUser stU INNER join (SELECT DISTINCT  ADGANG_ID, SELSKAB, srcSystemId, ADGANG_LIN_ID from StagingAreaTest.stg.MSCRUS_AdgangLin union select DISTINCT ADGANG_ID, SELSKAB, srcSystemId,  ADGANG_LIN_ID  from StagingAreaTest.stg.UNITY_AdgangLin) src ON stU.userId = src.ADGANG_ID AND stU.SrcSystemId = src.SrcSystemId) srcstU ON hub.companyId =  srcstU.SELSKAB )q 
usersCompany.destinationTable.CountRows = select count (*) c from sup.stUserCompany

deletesUsers.union.CountRows = SELECT count (1)c FROM(SELECT DISTINCT  ADGANG_ID, SrcSystemId from stg.MSCRUS_Adgang where AD_Login is not NULL  AND cdcOperation ='D ' UNION select DISTINCT  ADGANG_ID, SrcSystemId from stg.UNITY_Adgang where AD_Login is not NULL  AND cdcOperation ='D ')q
deletesUsers.destinationTable.CountRows = select count (*) c from sup.stUser WHERE status =0

deletedUsersCompany.condition.CountRows = SELECT count (1)c FROM(SELECT hub.dwhIdHubCompany, src.ADGANG_ID, src.srcSystemId FROM hub.hubCompany hub INNER JOIN (SELECT DISTINCT  ADGANG_ID, SrcSystemId, START_SEL from StagingAreaTest.stg.MSCRUS_Adgang where AD_Login is not NULL AND cdcOperation ='D 'UNION select DISTINCT  ADGANG_ID, SrcSystemId, START_SEL from StagingAreaTest.stg.UNITY_Adgang where AD_Login is not NULL AND cdcOperation ='D ') src ON hub.companyId =  src.START_SEL UNION SELECT hub.dwhIdHubCompany, srcstU.userId as ADGANG_ID, srcstU.srcSystemId FROM hub.hubCompany hub INNER JOIN (SELECT src.SELSKAB, stU.userId, stU.srcSystemId  FROM sup.stUser stU INNER join (SELECT DISTINCT  ADGANG_ID, SELSKAB, srcSystemId, ADGANG_LIN_ID from StagingAreaTest.stg.MSCRUS_AdgangLin WHERE  cdcOperation ='D ' UNION select DISTINCT ADGANG_ID, SELSKAB, srcSystemId,  ADGANG_LIN_ID  from StagingAreaTest.stg.UNITY_AdgangLin WHERE  cdcOperation ='D ') src ON stU.userId = src.ADGANG_ID AND stU.SrcSystemId = src.SrcSystemId) srcstU ON hub.companyId =  srcstU.SELSKAB)q 
deletedUsersCompany.destinationTable.CountRows = select count (*) c from sup.stUserCompany WHERE status =0
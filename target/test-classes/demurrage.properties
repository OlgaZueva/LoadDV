demurrage.linkTable.create = if object_id('etl.DemurragefctMSCRUSTestTable_OZ','U') is null create table etl.DemurragefctMSCRUSTestTable_OZ (accessCompanyId SMALLINT, bookingNumber BIGINT, containerNr NVARCHAR(15), demurrageStorageCode NVARCHAR(10), demurrageId INT, demurrageStorageStatus NVARCHAR(10), amount DECIMAL(12,2), invoicedAmount DECIMAL(12,2), theoreticalAmount DECIMAL(12,2), reissue NVARCHAR(10), clientRoe DECIMAL(18,6), roe DECIMAL(18,6), stdCurrencyRoe DECIMAL(18,6), daysNumber SMALLINT, startDate DATETIME, endDate DATETIME, startMark NVARCHAR(10), endMark NVARCHAR(10), startDays SMALLINT, freeDays SMALLINT, stdDays SMALLINT, ruleId int, stdRuleId int, orderNr int, clientCurrency NVARCHAR(6), demurrCurrency NVARCHAR(6), stdCurrency NVARCHAR(6), startMoveCode NVARCHAR(20), endMoveCode NVARCHAR(20), client DECIMAL(10), dwhIdHubBookingCargo BIGINT, dwhIdHubCompany BIGINT, dwhIdHubContainerDemurrageRulesSTD BIGINT, dwhIdHubContainerDemmurageRulesFACT BIGINT, dwhIdHubContainerMoveTypesStartMove BIGINT, dwhIdHubContainerMoveTypesEndMove BIGINT, dwhIdHubCurrencyDemurrCurrency BIGINT, dwhIdHubCurrencyClientCurrency BIGINT, dwhIdHubCurrencyStdCurrency BIGINT, dwhIdHubCustomers BIGINT, dwhIdhubInvoice BIGINT, srcSystemId SMALLINT, validFrom DATETIME)
demurrage.linkTable.truncate = TRUNCATE TABLE etl.DemurragefctMSCRUSTestTable_OZ

demurrage.allData.select = SELECT COMPANY, BOOK_NO, CONT_NO, CODE, DEM_ID, STATUS, AMOUNT,CLIENT, CLIENT_CURR, CLIENT_ROE, CURRENCY, DAYS, END_DATE, END_MARK, END_MOVE, FREE_DAYS, INVOICED_AMOUNT, ORDRE_NO, REISSUE, ROE, RULE_ID, START_DATE, START_DAYS, START_MARK, START_MOVE, STD_CURRENCY, STD_DAYS, STD_ROE, STD_RULE_ID, THEORETICAL_AMOUNT,srcSystemId, CdcTimestamp FROM StagingAreaTest.stg.MSCRUS_Demurrage

demurrage.fct.insert = INSERT etl.DemurragefctMSCRUSTestTable_OZ (accessCompanyId,  bookingNumber, containerNr, demurrageStorageCode, demurrageId, demurrageStorageStatus , amount , invoicedAmount , theoreticalAmount, reissue, clientRoe, roe, stdCurrencyRoe , daysNumber , startDate , endDate , startMark, endMark , startDays , freeDays, stdDays , ruleId, stdRuleId , orderNr , clientCurrency , demurrCurrency , stdCurrency , startMoveCode, endMoveCode, client, dwhIdHubBookingCargo , dwhIdHubCompany , dwhIdHubContainerDemurrageRulesSTD , dwhIdHubContainerDemmurageRulesFACT , dwhIdHubContainerMoveTypesStartMove, dwhIdHubContainerMoveTypesEndMove , dwhIdHubCurrencyDemurrCurrency , dwhIdHubCurrencyClientCurrency , dwhIdHubCurrencyStdCurrency , dwhIdHubCustomers, dwhIdhubInvoice , srcSystemId , validFrom) VALUES(

dwhIdHubCompany.id.select = SELECT distinct dwhIdHubCompany FROM hub.hubCompany WHERE
companyId.value.select = companyId =
srcSystemId.value.select = srcSystemId =
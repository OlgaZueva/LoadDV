system.RownumPool = 1000
system.PercentOfRows = 0.0005

customers.dwh.CountRows = select count (*) c from (select distinct dwhIdHubCustomers, validFrom from sat.satCustomers union select distinct dwhIdHubCustomers, validFrom from sat.satCustomersStatus) q
customers.dim.CountRows = select COUNT (*) c from (select dwhIdHubCustomers, validFrom c from [dim].[dimCustomers])q
customers.dataInDV.RowByRowNum = select * from (SELECT ROW_NUMBER() OVER (Order by hubSat.dwhIdHubCustomers) AS RowNumber, hubSat.dwhIdHubCustomers, hubSat.customerNr, hubSat.number, hubSat.bookingNumber, hubSat.blNumber, hubSat.customerType, hubSat.refType, hubSat.customerName, hubSat.shortName, hubSat.TMScustomerNr, hubSat.address1, hubSat.address2, hubSat.address3, hubSat.email, hubSat.fax, hubSat.phone, hubSat.countryCode, hubSat.cityCode, hubSat.cityName, hubSat.masterNameCode, hubSat.clientReference, hubSat.accountManagerCode1, hubSat.accountManagerCode2, hubSat.accessCompanyId, hubSat.srcSystemId, satStatus.status, satStatus.validFrom  from sat.satCustomersStatus satStatus inner join (select distinct hub.dwhIdHubCustomers, hub.customerNr, hub.number, hub.bookingNumber, hub.blNumber, hub.customerType, hub.refType, sat.customerName, sat.shortName, sat.TMScustomerNr, sat.address1, sat.address2, sat.address3, sat.email, sat.fax, sat.phone, sat.countryCode, sat.cityCode, sat.cityName, sat.masterNameCode, sat.clientReference, sat.accountManagerCode1, sat.accountManagerCode2, hub.accessCompanyId, hub.srcSystemId  from sat.satCustomers sat inner join (select dwhIdHubCustomers, customerNr, number, bookingNumber, blNumber, customerType, refType, accessCompanyId, srcSystemId from hub.hubCustomers) hub on hub.dwhIdHubCustomers = sat.dwhIdHubCustomers) hubSat on hubSat.dwhIdHubCustomers = satStatus.dwhIdHubCustomers) q where RowNumber =
customers.dataInDM.RowByKeys = select dwhIdHubCustomers, customerNr, number, bookingNumber, blNumber, customerType, refType, customerName, shortName, TMScustomerNr, address1, address2, address3, email, fax, phone,countryCode, cityCode, cityName, masterNameCode, clientReference, accountManagerCode1, accountManagerCode2,accessCompanyId, srcSystemId, dmStatus as status, validFrom   from  dim.dimCustomers

fileLiner.dwh.CountRows = select count (*) c from (select distinct dwhIdHubCustomers, validFrom from sat.satCustomers union select distinct dwhIdHubCustomers, validFrom from sat.satCustomersStatus) q
fileLiner.dim.CountRows = select COUNT (*) c from (select dwhIdHubCustomers, validFrom c from dim.dimCustomers)q
fileLiner.dataInDV.RowByRowNum = select * from (SELECT ROW_NUMBER() OVER (Order by hubSat.dwhIdHubCustomers) AS RowNumber, hubSat.dwhIdHubCustomers, hubSat.customerNr, hubSat.number, hubSat.bookingNumber, hubSat.blNumber, hubSat.customerType, hubSat.refType, hubSat.customerName, hubSat.shortName, hubSat.TMScustomerNr, hubSat.address1, hubSat.address2, hubSat.address3, hubSat.email, hubSat.fax, hubSat.phone, hubSat.countryCode, hubSat.cityCode, hubSat.cityName, hubSat.masterNameCode, hubSat.clientReference, hubSat.accountManagerCode1, hubSat.accountManagerCode2, hubSat.accessCompanyId, hubSat.srcSystemId, satStatus.status, satStatus.validFrom  from sat.satCustomersStatus satStatus inner join (select distinct hub.dwhIdHubCustomers, hub.customerNr, hub.number, hub.bookingNumber, hub.blNumber, hub.customerType, hub.refType, sat.customerName, sat.shortName, sat.TMScustomerNr, sat.address1, sat.address2, sat.address3, sat.email, sat.fax, sat.phone, sat.countryCode, sat.cityCode, sat.cityName, sat.masterNameCode, sat.clientReference, sat.accountManagerCode1, sat.accountManagerCode2, hub.accessCompanyId, hub.srcSystemId  from sat.satCustomers sat inner join (select dwhIdHubCustomers, customerNr, number, bookingNumber, blNumber, customerType, refType, accessCompanyId, srcSystemId from hub.hubCustomers) hub on hub.dwhIdHubCustomers = sat.dwhIdHubCustomers) hubSat on hubSat.dwhIdHubCustomers = satStatus.dwhIdHubCustomers) q where RowNumber =
fileLiner.dataInDM.RowByKeys = select dwhIdHubCustomers, customerNr, number, bookingNumber, blNumber, customerType, refType, customerName, shortName, TMScustomerNr, address1, address2, address3, email, fax, phone,countryCode, cityCode, cityName, masterNameCode, clientReference, accountManagerCode1, accountManagerCode2,accessCompanyId, srcSystemId, dmStatus as status, validFrom   from  DataMartTest.dim.dimCustomers

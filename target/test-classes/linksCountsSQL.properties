lnkAccountingTransactionBooking.lnk.CountRows = select count (*) c from lin.lnkAccountingTransactionBooking
lnkAccountingTransactionBooking.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubAccountingTransaction, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubAccountingTransaction, src.SELSKAB, src.SrcSystemId, src.REF_NR from hub.hubAccountingTransaction hub1 inner join (select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, REF_NR from StagingAreaTest.stg.MSCRUS_BogfTrans where isDeleted = 0 and REF_NR is not null union select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, REF_NR from StagingAreaTest.stg.UNITY_BogfTrans where isDeleted = 0 and REF_NR is not null) src on hub1.itemNr = src.BILAGSNR and hub1.sequenceNr = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.REF_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId) union (select distinct srcHub1.dwhIdHubAccountingTransaction, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubAccountingTransaction, src.SELSKAB, src.SrcSystemId, src.REF_NR from hub.hubAccountingTransaction hub1 inner join (select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, REF_NR from StagingAreaTest.stg.MSCRUS_BogfTrans where REF_NR is not null  and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, REF_NR from StagingAreaTest.stg.UNITY_BogfTrans where REF_NR is not null  and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.itemNr = src.BILAGSNR and hub1.sequenceNr = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.REF_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q
lnkAccountingTransactionBooking.satLnk.CountRows = select count (*) c from sat.satLnkAccountingTransactionBooking

lnkAccountingTransactionCurrency.lnk.CountRows =  select count (*) c from lin.lnkAccountingTransactionCurrency
lnkAccountingTransactionCurrency.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubAccountingTransaction, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubAccountingTransaction, src.SELSKAB, src.SrcSystemId, src.MONT_ENHED from hub.hubAccountingTransaction hub1 inner join (select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.MSCRUS_BogfTrans where isDeleted = 0 and MONT_ENHED is not null union select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.UNITY_BogfTrans where isDeleted = 0 and MONT_ENHED is not null) src on hub1.itemNr = src.BILAGSNR and hub1.sequenceNr = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.MONT_ENHED and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubAccountingTransaction, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubAccountingTransaction, src.SELSKAB, src.SrcSystemId, src.MONT_ENHED from hub.hubAccountingTransaction hub1 inner join (select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.MSCRUS_BogfTrans where isDeleted = 0 and MONT_ENHED is null union select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.UNITY_BogfTrans where isDeleted = 0 and MONT_ENHED is null) src on hub1.itemNr = src.BILAGSNR and hub1.sequenceNr = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCurrency = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0) union (select distinct srcHub1.dwhIdHubAccountingTransaction, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubAccountingTransaction, src.SELSKAB, src.SrcSystemId, src.MONT_ENHED from hub.hubAccountingTransaction hub1 inner join (select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.MSCRUS_BogfTrans where MONT_ENHED is not null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.UNITY_BogfTrans where MONT_ENHED is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.itemNr = src.BILAGSNR and hub1.sequenceNr = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.MONT_ENHED and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubAccountingTransaction, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubAccountingTransaction, src.SELSKAB, src.SrcSystemId, src.MONT_ENHED from hub.hubAccountingTransaction hub1 inner join (select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.MSCRUS_BogfTrans where MONT_ENHED is null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.UNITY_BogfTrans where MONT_ENHED is null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.itemNr = src.BILAGSNR and hub1.sequenceNr = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCurrency = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0))q
lnkAccountingTransactionCurrency.satLnk.CountRows = select count (*) c from sat.satLnkAccountingTransactionCurrency

lnkAccountingTransactionCompany.lnk.CountRows = select count (*) c from lin.lnkAccountingTransactionCompany
lnkAccountingTransactionCompany.condition.CountRows = select count (*) c from ((select distinct hub2.dwhIdHubCompany, srcHub1.dwhIdHubAccountingTransaction, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubAccountingTransaction, src.SELSKAB, src.SrcSystemId from hub.hubAccountingTransaction hub1 inner join (select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BogfTrans where isDeleted = 0 union select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BogfTrans where isDeleted = 0) src on hub1.itemNr = src.BILAGSNR and hub1.sequenceNr = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId) union (select distinct hub2.dwhIdHubCompany, srcHub1.dwhIdHubAccountingTransaction, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubAccountingTransaction, src.SELSKAB, src.SrcSystemId from hub.hubAccountingTransaction hub1 inner join (select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BogfTrans where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BogfTrans where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.itemNr = src.BILAGSNR and hub1.sequenceNr = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q


lnkPaymentsInvoicePosting.lnk.CountRows =  select count (*) c from lin.lnkPaymentsInvoicePosting
lnkPaymentsInvoicePosting.condition.CountRows =   select count (*) c from (select distinct srcHub1.dwhIdHubPayments, hub2.dwhIdHubInvoicePosting, srcHub1.SrcSystemId from  hub.hubInvoicePosting hub2 inner join (select hub1.dwhIdHubPayments, src.SELSKAB, src.SrcSystemId, src.F_TYPE, src.FAKTURANR, src.K_TYPE, src.KUNDE from hub.hubPayments hub1 inner join (select F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_AbPost where isDeleted = 0 union select F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_AbPost where isDeleted = 0) src on hub1.invoiceType = src.F_TYPE and hub1.invoiceNr = src.FAKTURANR and hub1.debitCredit = src.K_TYPE and hub1.customerCode = src.KUNDE and hub1.sequenceNr = src.LOBE_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.invoiceType = srcHub1.F_TYPE and hub2.invoiceNr = srcHub1.FAKTURANR and hub2.debitCredit = srcHub1.K_TYPE and hub2.customerCode = srcHub1.KUNDE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkPaymentsInvoicePosting.satLnk.CountRows =  select count (*) c from sat.satLnkPaymentsInvoicePosting
lnkPaymentsInvoicePosting.error.CountRows = select count (*) c  from [err].[errLnkAbPost] where packageCreator like '%lnkPaymentsInvoicePosting%'

lnkPaymentsCompany.lnk.CountRows = select count (*) c from lin.lnkPaymentsCompany
lnkPaymentsCompany.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubCompany, srcHub1.dwhIdHubPayments, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubPayments, src.SELSKAB, src.SrcSystemId from hub.hubPayments hub1 inner join (select F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_AbPost where isDeleted = 0 union select F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_AbPost where isDeleted = 0) src on hub1.invoiceType = src.F_TYPE and hub1.invoiceNr = src.FAKTURANR and hub1.debitCredit = src.K_TYPE and hub1.customerCode = src.KUNDE and hub1.sequenceNr = src.LOBE_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkCustomersCountry.lnk.CountRows =  select count (*) c from lin.lnkCustomersCountry
lnkCustomersCountry.condition.CountRows = select count (*) c from (select distinct hubCountry.dwhIdHubCountry, srcHubCust.dwhIdHubCustomers, srcHubCust.SrcSystemId from  hub.hubCountry hubCountry inner join (select hubCustomers.dwhIdHubCustomers, src.DEB_LAND, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hubCustomers inner join (select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, DEB_LAND from StagingAreaTest.stg.MSCRUS_Adresse where isDeleted = 0 and DEB_LAND is not null union select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, DEB_LAND from StagingAreaTest.stg.UNITY_Adresse where isDeleted = 0 and DEB_LAND is not null) src on hubCustomers.number =  src.NR and hubCustomers.bookingNumber = src.REF_NR and hubCustomers.refType =  src.REF_TYPE and hubCustomers.accessCompanyId = src.SELSKAB and hubCustomers.srcSystemId = src.srcSystemId)srcHubCust on hubCountry.countryCode = srcHubCust.DEB_LAND and hubCountry.accessCompanyId =  srcHubCust.SELSKAB and hubCountry.srcSystemId = srcHubCust.SrcSystemId union select distinct hubCountry.dwhIdHubCountry, srcHubCust.dwhIdHubCustomers, srcHubCust.SrcSystemId from  hub.hubCountry hubCountry inner join (select hubCustomers.dwhIdHubCustomers, src.DEB_LAND, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hubCustomers inner join (select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, DEB_LAND from StagingAreaTest.stg.MSCRUS_Adresse where isDeleted = 0 and DEB_LAND is null union select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, DEB_LAND from StagingAreaTest.stg.UNITY_Adresse where isDeleted = 0 and DEB_LAND is null) src on hubCustomers.number =  src.NR and hubCustomers.bookingNumber = src.REF_NR and hubCustomers.refType =  src.REF_TYPE and hubCustomers.accessCompanyId = src.SELSKAB and hubCustomers.srcSystemId = src.srcSystemId)srcHubCust on hubCountry.dwhIdHubCountry = -1 and hubCountry.accessCompanyId =  -1 and hubCountry.srcSystemId = 0)q
lnkCustomersCountry.satLnk.CountRows =  select count (*) c from sat.satLnkCustomersCountry

lnkCustomersCompany.lnk.CountRows =  select count (*) c from lin.lnkCustomersCompany
lnkCustomersCompany.conditionAdresse.CountRows = select count (*) c from (select distinct hub2.dwhIdHubCompany, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubCustomers, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hub1 inner join (select NR, REF_NR, REF_TYPE, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Adresse where isDeleted = 0 union select NR, REF_NR, REF_TYPE, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Adresse where isDeleted = 0) src on hub1.number = src.NR and hub1.bookingNumber = src.REF_NR and hub1.refType = src.REF_TYPE and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkCustomersCompany.conditionKunde.CountRows = select count (*) c from (select distinct hub2.dwhIdHubCompany, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubCustomers, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hub1 inner join (select KUNDENR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Kunde where isDeleted = 0 union select KUNDENR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Kunde where isDeleted = 0) src on hub1.customerNr = src.KUNDENR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkBookingBooking.lnk.CountRows =  select count (*) c from lin.lnkBookingBooking
lnkBookingBooking.condition.CountRows =  select count (*) c from ((select srcHub1Sat.dwhidHubBooking1, hub2.dwhidHubBooking as dwhidHubBooking2, srcHub1Sat.SrcSystemId from hub.hubBooking hub2 inner join (select srcHub1.dwhidHubBooking1, sat.dwhidHubBooking, sat.SrcSystemId, srcHub1.CONTROL_SELSKAB from sat.satBooking sat inner join (select hub1.dwhidHubBooking as dwhidHubBooking1, src.CROSS_BOOK, src.SrcSystemId, src.CONTROL_SELSKAB from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, CROSS_BOOK, CONTROL_SELSKAB, IMP_EXP, REF_NR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and SELSKAB != CONTROL_SELSKAB and CONTROL_SELSKAB is not null and IMP_EXP  in ('E') union select distinct BOOK_NR, SELSKAB, SrcSystemId, CROSS_BOOK, CONTROL_SELSKAB,  IMP_EXP, REF_NR from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and SELSKAB != CONTROL_SELSKAB and CONTROL_SELSKAB is not null and IMP_EXP  in ('E')) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId =  SELSKAB and hub1.srcSystemId =  src.SrcSystemId)srcHub1 on  sat.blNumber = srcHub1.CROSS_BOOK and sat.srcSystemId = srcHub1.SrcSystemId)srcHub1Sat on srcHub1Sat.dwhidHubBooking = hub2.dwhIdHubBooking and srcHub1Sat.CONTROL_SELSKAB =  hub2.accessCompanyId union select srcHub1Sat.dwhidHubBooking1, hub2.dwhidHubBooking as dwhidHubBooking2, srcHub1Sat.SrcSystemId from hub.hubBooking hub2 inner join (select srcHub1.dwhidHubBooking1, sat.dwhidHubBooking, sat.SrcSystemId, srcHub1.CONTROL_SELSKAB from sat.satBooking sat inner join (select hub1.dwhidHubBooking as dwhidHubBooking1, src.CROSS_BOOK, src.SrcSystemId, src.CONTROL_SELSKAB, src.REF_NR from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, CROSS_BOOK, CONTROL_SELSKAB, IMP_EXP, REF_NR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and SELSKAB != CONTROL_SELSKAB and CONTROL_SELSKAB is not null and IMP_EXP  in ('I') union select distinct BOOK_NR, SELSKAB, SrcSystemId, CROSS_BOOK, CONTROL_SELSKAB,  IMP_EXP, REF_NR from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and SELSKAB != CONTROL_SELSKAB and CONTROL_SELSKAB is not null and IMP_EXP  in ('I')) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId =  SELSKAB and hub1.srcSystemId =  src.SrcSystemId)srcHub1 on sat.blNumber = srcHub1.REF_NR and sat.srcSystemId = srcHub1.SrcSystemId)srcHub1Sat on srcHub1Sat.dwhidHubBooking = hub2.dwhIdHubBooking and srcHub1Sat.CONTROL_SELSKAB =  hub2.accessCompanyId) union (select srcHub1Sat.dwhidHubBooking1, hub2.dwhidHubBooking as dwhidHubBooking2, srcHub1Sat.SrcSystemId from hub.hubBooking hub2 inner join (select srcHub1.dwhidHubBooking1, sat.dwhidHubBooking, sat.SrcSystemId, srcHub1.CONTROL_SELSKAB from sat.satBooking sat inner join (select hub1.dwhidHubBooking as dwhidHubBooking1, src.CROSS_BOOK, src.SrcSystemId, src.CONTROL_SELSKAB from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, CROSS_BOOK, CONTROL_SELSKAB,  IMP_EXP, REF_NR from StagingAreaTest.stg.MSCRUS_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null and SELSKAB != CONTROL_SELSKAB and CONTROL_SELSKAB is not null and IMP_EXP  in ('E') union select BOOK_NR, SELSKAB, SrcSystemId, CROSS_BOOK, CONTROL_SELSKAB,  IMP_EXP, REF_NR from StagingAreaTest.stg.UNITY_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and SELSKAB != CONTROL_SELSKAB and CONTROL_SELSKAB is not null and IMP_EXP  in ('E')) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId =  SELSKAB and hub1.srcSystemId =  src.SrcSystemId)srcHub1 on sat.blNumber = srcHub1.CROSS_BOOK and sat.srcSystemId = srcHub1.SrcSystemId)srcHub1Sat on srcHub1Sat.dwhidHubBooking = hub2.dwhIdHubBooking and srcHub1Sat.CONTROL_SELSKAB =  hub2.accessCompanyId union select srcHub1Sat.dwhidHubBooking1, hub2.dwhidHubBooking as dwhidHubBooking2, srcHub1Sat.SrcSystemId from hub.hubBooking hub2 inner join (select srcHub1.dwhidHubBooking1, sat.dwhidHubBooking, sat.SrcSystemId, srcHub1.CONTROL_SELSKAB from sat.satBooking sat inner join (select hub1.dwhidHubBooking as dwhidHubBooking1, src.CROSS_BOOK, src.SrcSystemId, src.CONTROL_SELSKAB, src.REF_NR from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, CROSS_BOOK, CONTROL_SELSKAB,  IMP_EXP, REF_NR from StagingAreaTest.stg.MSCRUS_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null and SELSKAB != CONTROL_SELSKAB and CONTROL_SELSKAB is not null and IMP_EXP  in ('I') union  select BOOK_NR, SELSKAB, SrcSystemId, CROSS_BOOK, CONTROL_SELSKAB,  IMP_EXP, REF_NR from StagingAreaTest.stg.UNITY_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and SELSKAB != CONTROL_SELSKAB and CONTROL_SELSKAB is not null and IMP_EXP  in ('I')) src on  hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId =  SELSKAB and hub1.srcSystemId =  src.SrcSystemId)srcHub1 on sat.blNumber = srcHub1.REF_NR and sat.srcSystemId = srcHub1.SrcSystemId)srcHub1Sat on srcHub1Sat.dwhidHubBooking = hub2.dwhIdHubBooking and srcHub1Sat.CONTROL_SELSKAB =  hub2.accessCompanyId))q
lnkBookingBooking.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBooking
lnkBookingBooking.error.CountRows = select count (*) c   from [err].[errLnkBook] where packageCreator like '%lnkBookingBooking'

lnkBookingBookingChargeLines.lnk.CountRows = select count (*) c from lin.lnkBookingBookingChargeLines
lnkBookingBookingChargeLines.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingChargeLines, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingChargeLines, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingChargeLines hub1 inner join (select BOOK_NR, SELSKAB, FRG_BT_NR, LINIE_NR, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookLin where isDeleted = 0 union select BOOK_NR, SELSKAB, FRG_BT_NR, LINIE_NR, SrcSystemId from StagingAreaTest.stg.UNITY_BookLin where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingChargeLines.satLnk.CountRows = select count (*) c from sat.satLnkBookingBookingChargeLines

lnkBookingBookingHaulageDetails.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingHaulageDetails
lnkBookingBookingHaulageDetails.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubBookingHaulageDetails, srcHub1.SrcSystemId from  hub.hubBookingHaulageDetails hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 union select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Book where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId) union (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubBookingHaulageDetails, srcHub1.SrcSystemId from  hub.hubBookingHaulageDetails hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q
lnkBookingBookingHaulageDetails.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingHaulageDetails
lnkBookingBookingHaulageDetails.error.CountRows = select count (*) c   from [err].[errLnkBook] where packageCreator like '%lnkBookingBookingHaulageDetails%' 

lnkBookingBookingReportingCustomer.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingReportingCustomer
lnkBookingBookingReportingCustomer.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubBookingReportingCustomer, srcHub1.SrcSystemId from  hub.hubBookingReportingCustomer hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.REF_NR from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, REF_NR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 union select BOOK_NR, SELSKAB, SrcSystemId, REF_NR from StagingAreaTest.stg.UNITY_Book where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.blNr = srcHub1.REF_NR) union (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubBookingReportingCustomer, srcHub1.SrcSystemId from  hub.hubBookingReportingCustomer hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.REF_NR from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, REF_NR from StagingAreaTest.stg.MSCRUS_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BOOK_NR, SELSKAB, SrcSystemId, REF_NR from StagingAreaTest.stg.UNITY_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.blNr = srcHub1.REF_NR))q
lnkBookingBookingReportingCustomer.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingReportingCustomer
lnkBookingBookingReportingCustomer.error.CountRows = select count (*) c   from [err].[errLnkBook] where packageCreator like '%lnkBookingBookingReportingCustomer%'

lnkBookingContainerLocation.lnk.CountRows =  select count (*) c from lin.lnkBookingContainerLocation
lnkBookingContainerLocation_E.condition.CountRows = select count (*) c from ((select distinct hub2.dwhIdHubContainerLocation, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubBooking, src.LOC, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and LOC is not null and IMP_EXP= 'E' union select BOOK_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and LOC is not null and IMP_EXP= 'E') src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.containerlocationCode = srcHub1.LOC and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubContainerLocation, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubBooking, src.LOC, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and LOC is null and IMP_EXP= 'E' union select BOOK_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and LOC is null and IMP_EXP= 'E') src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubContainerLocation = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0) union (select distinct hub2.dwhIdHubContainerLocation, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubBooking, src.LOC, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.MSCRUS_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null and LOC is not null and IMP_EXP= 'E' union  select BOOK_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.UNITY_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and LOC is not null and IMP_EXP= 'E') src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.containerlocationCode = srcHub1.LOC and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubContainerLocation, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubBooking, src.LOC, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.MSCRUS_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null and LOC is  null and IMP_EXP= 'E' union select BOOK_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.UNITY_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and LOC is null and IMP_EXP= 'E') src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubContainerLocation = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0))q
lnkBookingContainerLocation_I.condition.CountRows = select count (*) c from ((select distinct hub2.dwhIdHubContainerLocation, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubBooking, src.LOC2, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, LOC2 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and LOC2 is not null and IMP_EXP= 'I' union select BOOK_NR, SELSKAB, SrcSystemId, LOC2 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and LOC2 is not null and IMP_EXP= 'I') src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.containerlocationCode = srcHub1.LOC2 and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubContainerLocation, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubBooking, src.LOC2, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, LOC2 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and LOC2 is null and IMP_EXP= 'I' union select BOOK_NR, SELSKAB, SrcSystemId, LOC2 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and LOC2 is null and IMP_EXP= 'I') src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubContainerLocation = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0) union (select distinct hub2.dwhIdHubContainerLocation, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubBooking, src.LOC2, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, LOC2 from StagingAreaTest.stg.MSCRUS_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and LOC2 is not null and IMP_EXP= 'I' union  select BOOK_NR, SELSKAB, SrcSystemId, LOC2 from StagingAreaTest.stg.UNITY_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and LOC2 is not null and IMP_EXP= 'I') src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.containerlocationCode = srcHub1.LOC2 and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubContainerLocation, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubBooking, src.LOC2, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, LOC2 from StagingAreaTest.stg.MSCRUS_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and LOC2 is null and IMP_EXP= 'I' union select BOOK_NR, SELSKAB, SrcSystemId, LOC2 from StagingAreaTest.stg.UNITY_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and LOC2 is null and IMP_EXP= 'I') src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubContainerLocation = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0))q
lnkBookingContainerLocation.satLnk.CountRows =  select count (*) c from sat.satLnkBookingContainerLocation

lnkBookingControllingOffice.lnk.CountRows =  select count (*) c from lin.lnkBookingControllingOffice
lnkBookingControllingOffice.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubControllingOffice, srcHub1.SrcSystemId from hub.hubControllingOffice hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.CONTROL_SELSKAB, src.CONTROL_KONTOR from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, CONTROL_SELSKAB, CONTROL_KONTOR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and CONTROL_SELSKAB is not null union select BOOK_NR, SELSKAB, SrcSystemId, CONTROL_SELSKAB, CONTROL_KONTOR from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and CONTROL_SELSKAB is not null) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on ISNULL(hub2.officeId, -1) = ISNULL (srcHub1.CONTROL_KONTOR, -1) and hub2.companyId = srcHub1.CONTROL_SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId) union (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubControllingOffice, srcHub1.SrcSystemId from hub.hubControllingOffice hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.CONTROL_SELSKAB, src.CONTROL_KONTOR from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, CONTROL_SELSKAB, CONTROL_KONTOR from StagingAreaTest.stg.MSCRUS_Book where SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BOOK_NR, SELSKAB, SrcSystemId, CONTROL_SELSKAB, CONTROL_KONTOR from StagingAreaTest.stg.UNITY_Book where SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on ISNULL(hub2.officeId, -1) = ISNULL (srcHub1.CONTROL_KONTOR, -1) and hub2.companyId = srcHub1.CONTROL_SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q
lnkBookingControllingOffice.satLnk.CountRows =  select count (*) c from sat.satLnkBookingControllingOffice


lnkBookingCountry.lnk.CountRows =  select count (*) c from lin.lnkBookingCountry
lnkBookingCountry.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubCountry, srcHub1.SrcSystemId from  hub.hubCountry hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.AFSL_LAND from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, AFSL_LAND from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 union select BOOK_NR, SELSKAB, SrcSystemId, AFSL_LAND from StagingAreaTest.stg.UNITY_Book where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.countryCode = srcHub1.AFSL_LAND and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)union (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubCountry, srcHub1.SrcSystemId from  hub.hubCountry hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.AFSL_LAND from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, AFSL_LAND from StagingAreaTest.stg.MSCRUS_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BOOK_NR, SELSKAB, SrcSystemId, AFSL_LAND from StagingAreaTest.stg.UNITY_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.countryCode = srcHub1.AFSL_LAND and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q
lnkBookingCountry.satLnk.CountRows =  select count (*) c from sat.satLnkBookingCountry

lnkBookingCrossBookingType.lnk.CountRows =  select count (*) c from lin.lnkBookingCrossBookingType
lnkBookingCrossBookingType.condition.CountRows = select count (*) c from ((select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.REF_TYPE from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 union select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.UNITY_Book where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)union (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.REF_TYPE from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.MSCRUS_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.UNITY_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId))q
lnkBookingCrossBookingType.foundedForREF_TYPE.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubCrossBookingType, srcHub1.SrcSystemId from  hub.hubCrossBookingType hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.REF_TYPE from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and REF_TYPE is not null union select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and REF_TYPE is not null) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookTypeCode = SUBSTRING(srcHub1.REF_TYPE, 1, 2) union select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubCrossBookingType, srcHub1.SrcSystemId from  hub.hubCrossBookingType hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.REF_TYPE from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and REF_TYPE is null union select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and REF_TYPE is null) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookTypeCode = 'NA')union (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubCrossBookingType, srcHub1.SrcSystemId from  hub.hubCrossBookingType hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.REF_TYPE from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.MSCRUS_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null and REF_TYPE is not null union select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.UNITY_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and REF_TYPE is not null ) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookTypeCode = SUBSTRING(srcHub1.REF_TYPE, 1, 2) union select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubCrossBookingType, srcHub1.SrcSystemId from  hub.hubCrossBookingType hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.REF_TYPE from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.MSCRUS_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null and REF_TYPE is null union select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.UNITY_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and REF_TYPE is null ) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookTypeCode = 'NA'))q
lnkBookingCrossBookingType.satLnk.CountRows =  select count (*) c from sat.satLnkBookingCrossBookingType

lnkBookingCustomers.lnk.CountRows =  select count (*) c from lin.lnkBookingCustomers
lnkBookingCustomers.condition_S_NAMED_ACCOUNT_NotNull.CountRows = select  count (*) c from ((select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NAMED_ACCOUNT, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NAMED_ACCOUNT, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_NAMED_ACCOUNT is not null union select distinct BOOK_NR, SELSKAB, S_NAMED_ACCOUNT, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_NAMED_ACCOUNT is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NAMED_ACCOUNT = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' and hubB1.S_NAMED_ACCOUNT is not null) union (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NAMED_ACCOUNT, src.SrcSystemId from hub.hubBooking hubB inner join (select BOOK_NR, SELSKAB, SrcSystemId, S_NAMED_ACCOUNT from StagingAreaTest.stg.MSCRUS_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null and S_NAMED_ACCOUNT is not null union select BOOK_NR, SELSKAB, SrcSystemId, S_NAMED_ACCOUNT from StagingAreaTest.stg.UNITY_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and S_NAMED_ACCOUNT is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on  hubB1.S_NAMED_ACCOUNT = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' and hubB1.S_NAMED_ACCOUNT is not null))q
lnkBookingCustomers.condition_S_NAMED_ACCOUNT_Null.CountRows = select  count (*) c from ((select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NAMED_ACCOUNT, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NAMED_ACCOUNT, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_NAMED_ACCOUNT is null union select distinct BOOK_NR, SELSKAB, NAMED_ACCOUNT, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_NAMED_ACCOUNT is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NAMED_ACCOUNT = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K') union (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NAMED_ACCOUNT, src.SrcSystemId from hub.hubBooking hubB inner join (select BOOK_NR, SELSKAB, SrcSystemId, NAMED_ACCOUNT from StagingAreaTest.stg.MSCRUS_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and S_NAMED_ACCOUNT is null union select BOOK_NR, SELSKAB, SrcSystemId, NAMED_ACCOUNT from StagingAreaTest.stg.UNITY_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and S_NAMED_ACCOUNT is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NAMED_ACCOUNT = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K'))q 
lnkBookingCustomers.condition_both_NAMED_ACCOUNT_Null.CountRows = select  count (*) c from ((select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_NAMED_ACCOUNT is null and NAMED_ACCOUNT is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_NAMED_ACCOUNT is null and NAMED_ACCOUNT is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0) union (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and S_NAMED_ACCOUNT is null and NAMED_ACCOUNT is null union select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and S_NAMED_ACCOUNT is null and NAMED_ACCOUNT is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0))q
lnkBookingCustomers.condition_S_BOOK_PARTY_NotNull.CountRows = select  count (*) c from ((select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_BOOK_PARTY, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_BOOK_PARTY, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_BOOK_PARTY is not null union select distinct BOOK_NR, SELSKAB, S_BOOK_PARTY, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_BOOK_PARTY is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_BOOK_PARTY = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A') union (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_BOOK_PARTY, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_BOOK_PARTY, srcSystemId from StagingAreaTest.stg.UNITY_Book src where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and  S_BOOK_PARTY is not null union select distinct BOOK_NR, SELSKAB, S_BOOK_PARTY, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and  S_BOOK_PARTY is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_BOOK_PARTY = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A'))q
lnkBookingCustomers.condition_S_BOOK_PARTY_Null.CountRows = select  count (*) c from ((select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.BOOK_PARTY, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, BOOK_PARTY, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and S_BOOK_PARTY is null union select distinct BOOK_NR, SELSKAB, BOOK_PARTY, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_BOOK_PARTY is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.BOOK_PARTY = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')union (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.BOOK_PARTY, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, BOOK_PARTY, srcSystemId from StagingAreaTest.stg.UNITY_Book src where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and S_BOOK_PARTY is null union select distinct BOOK_NR, SELSKAB, BOOK_PARTY, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and  S_BOOK_PARTY is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.BOOK_PARTY = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K'))q
lnkBookingCustomers.condition_both_BOOK_PARTY_Null.CountRows = select  count (*) c from ((select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_BOOK_PARTY is null and BOOK_PARTY is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_BOOK_PARTY is null and BOOK_PARTY is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0) union (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and S_BOOK_PARTY is null and BOOK_PARTY is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and S_BOOK_PARTY is null and BOOK_PARTY is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0))q
lnkBookingCustomers.condition_S_CARE_OF_FWD_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_CARE_OF_FWD, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_CARE_OF_FWD, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_CARE_OF_FWD is not null union select distinct BOOK_NR, SELSKAB, S_CARE_OF_FWD, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_CARE_OF_FWD is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_CARE_OF_FWD = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_CARE_OF_FWD_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.CARE_OF_FWD, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, CARE_OF_FWD, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_CARE_OF_FWD is null union select distinct BOOK_NR, SELSKAB, CARE_OF_FWD, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_CARE_OF_FWD is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.CARE_OF_FWD = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.both_CARE_OF_FWD_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_CARE_OF_FWD is null and CARE_OF_FWD is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_CARE_OF_FWD is null and CARE_OF_FWD is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_AFSENDER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_AFSENDER is not null union select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_AFSENDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_AFSENDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_AFSENDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_AFSENDER is null union select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.AFSENDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_AFSENDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_AFSENDER is null and AFSENDER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_AFSENDER is null and AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_MODTAGER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_MODTAGER is not null union select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_MODTAGER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_MODTAGER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_MODTAGER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_MODTAGER is null union select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.MODTAGER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_MODTAGER_NotNull = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_MODTAGER is null and MODTAGER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_MODTAGER is null and MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_MODTAGER_unionAllCondition.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_MODTAGER is not null union select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_MODTAGER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_MODTAGER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_MODTAGER is null union select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.MODTAGER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_MODTAGER is null and MODTAGER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_MODTAGER is null and MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_SLUTSPED_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_SLUTSPED is not null union select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_SLUTSPED is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_SLUTSPED = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_SLUTSPED_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_SLUTSPED is null union select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.SLUTSPED = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_SLUTSPED_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_SLUTSPED is null and SLUTSPED is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_SLUTSPED is null and SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_NOTIFY2_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_NOTIFY2 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_NOTIFY2 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY2 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_NOTIFY2_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY2 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_NOTIFY2_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_NOTIFY2 is null and NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_NOTIFY2 is null and NOTIFY2 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_NOTIFY3_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_NOTIFY3 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_NOTIFY3 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY3 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_NOTIFY3_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY3 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_NOTIFY3_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_NOTIFY3 is null and NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_NOTIFY3 is null and NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_KUNDE_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_KUNDE is not null union select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_KUNDE is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_KUNDE = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_KUNDE_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_KUNDE is null union select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_KUNDE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.KUNDE = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_KUNDE_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_KUNDE is null and KUNDE is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_KUNDE is null and KUNDE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_CONTRACT_HOLDER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_CONTRACT_HOLDER is not null union select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_CONTRACT_HOLDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_CONTRACT_HOLDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_CONTRACT_HOLDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.CONTRACT_HOLDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_CONTRACT_HOLDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_CONTRACT_HOLDER is null and CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_CONTRACT_HOLDER is null and CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_IC_ELSEWHERE_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_IC_ELSEWHERE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_IC_ELSEWHERE , srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_IC_ELSEWHERE is not null union select distinct BOOK_NR, SELSKAB, S_IC_ELSEWHERE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_IC_ELSEWHERE is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_IC_ELSEWHERE = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_IC_ELSEWHERE_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.IC_ELSEWHERE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, IC_ELSEWHERE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_IC_ELSEWHERE is null union select distinct BOOK_NR, SELSKAB, IC_ELSEWHERE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_IC_ELSEWHERE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.IC_ELSEWHERE = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_IC_ELSEWHERE_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_IC_ELSEWHERE is null and IC_ELSEWHERE is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_IC_ELSEWHERE is null and IC_ELSEWHERE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_FREIGHT_FWD_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_FREIGHT_FWD, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_FREIGHT_FWD , srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_FREIGHT_FWD is not null union select distinct BOOK_NR, SELSKAB, S_FREIGHT_FWD, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_FREIGHT_FWD is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_FREIGHT_FWD = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_FREIGHT_FWD_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.FREIGHT_FWD, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, FREIGHT_FWD, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_FREIGHT_FWD is null union select distinct BOOK_NR, SELSKAB, FREIGHT_FWD, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_FREIGHT_FWD is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.FREIGHT_FWD = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_FREIGHT_FWD_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_FREIGHT_FWD is null and FREIGHT_FWD is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_FREIGHT_FWD is null and FREIGHT_FWD is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_StatCustomer_S_KUNDE_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'S' and S_KUNDE is not null union select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'S' and S_KUNDE is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_KUNDE = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_StatCustomer_S_KUNDE_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'S' and S_KUNDE is null union select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'S' and S_KUNDE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.KUNDE = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_StatCustomer_S_AFSENDER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'A' and S_AFSENDER is not null union select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'A' and S_AFSENDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_AFSENDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_StatCustomer_S_AFSENDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'A' and S_AFSENDER is null union select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'A' and S_AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.AFSENDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_StatCustomer_S_MODTAGER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'M' and S_MODTAGER is not null union select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'M' and S_MODTAGER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_MODTAGER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_StatCustomer_S_MODTAGER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'M' and S_MODTAGER is null union select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'M' and S_MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.MODTAGER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_StatCustomer_S_SLUTSPED_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'N' and S_SLUTSPED is not null union select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'N' and S_SLUTSPED is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_SLUTSPED = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_StatCustomer_S_SLUTSPED_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'N' and S_SLUTSPED is null union select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'N' and S_SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.SLUTSPED = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_StatCustomer_S_NOTIFY2_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = '2' and S_NOTIFY2 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '2' and S_NOTIFY2 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY2 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A')q 
lnkBookingCustomers.condition_StatCustomer_S_NOTIFY2_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = '2' and S_NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '2' and S_NOTIFY2 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY2 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_StatCustomer_S_NOTIFY3_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = '3' and S_NOTIFY3 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '3' and S_NOTIFY3 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY3 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_StatCustomer_S_NOTIFY3_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = '3' and S_NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '3' and S_NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY3 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' )q
lnkBookingCustomers.condition_StatCustomer_S_CONTRACT_HOLDER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is not null union select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_CONTRACT_HOLDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_StatCustomer_S_CONTRACT_HOLDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.CONTRACT_HOLDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_StatCustomer_Union.CountRows= select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'S' and S_KUNDE is not null union select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'S' and S_KUNDE is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_KUNDE = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'S' and S_KUNDE is null union select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'S' and S_KUNDE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.KUNDE = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  KUNDE_STAT = 'S' and S_KUNDE is null and KUNDE is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and KUNDE_STAT = 'S' and S_KUNDE is null and KUNDE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'A' and S_AFSENDER is not null union select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'A' and S_AFSENDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_AFSENDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'A' and S_AFSENDER is null union select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'A' and S_AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.AFSENDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  KUNDE_STAT = 'A' and S_AFSENDER is null and AFSENDER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and KUNDE_STAT = 'A' and S_AFSENDER is null and AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'M' and S_MODTAGER is not null union select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'M' and S_MODTAGER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_MODTAGER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'M' and S_MODTAGER is null union select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'M' and S_MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.MODTAGER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  KUNDE_STAT = 'M' and S_MODTAGER is null and MODTAGER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and KUNDE_STAT = 'M' and S_MODTAGER is null and MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'N' and S_SLUTSPED is not null union select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'N' and S_SLUTSPED is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_SLUTSPED = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'N' and S_SLUTSPED is null union select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'N' and S_SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.SLUTSPED = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  KUNDE_STAT = 'N' and S_SLUTSPED is null and SLUTSPED is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and KUNDE_STAT = 'N' and S_SLUTSPED is null and SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = '2' and S_NOTIFY2 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '2' and S_NOTIFY2 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY2 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = '2' and S_NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '2' and S_NOTIFY2 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY2 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  KUNDE_STAT = '2' and S_NOTIFY2 is null and NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and KUNDE_STAT = '2' and S_NOTIFY2 is null and NOTIFY2 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = '3' and S_NOTIFY3 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '3' and S_NOTIFY3 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY3 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = '3' and S_NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '3' and S_NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY3 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  KUNDE_STAT = '3' and S_NOTIFY3 is null and NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and KUNDE_STAT = '3' and S_NOTIFY3 is null and NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is not null union select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_CONTRACT_HOLDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.CONTRACT_HOLDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is null and CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is null and CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_FreightPayer_S_KUNDE_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'S' and S_KUNDE is not null union select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'S' and S_KUNDE is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_KUNDE = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_FreightPayer_S_KUNDE_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'S' and S_KUNDE is null union select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'S' and S_KUNDE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.KUNDE = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_FreightPayer_S_AFSENDER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'A' and S_AFSENDER is not null union select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'A' and S_AFSENDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_AFSENDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_FreightPayer_S_AFSENDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'A' and S_AFSENDER is null union select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'A' and S_AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.AFSENDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_FreightPayer_S_MODTAGER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'M' and S_MODTAGER is not null union select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'M' and S_MODTAGER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_MODTAGER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_FreightPayer_S_MODTAGER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'M' and S_MODTAGER is null union select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'M' and S_MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.MODTAGER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_FreightPayer_S_SLUTSPED_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'N' and S_SLUTSPED is not null union select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'N' and S_SLUTSPED is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_SLUTSPED = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_FreightPayer_S_SLUTSPED_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'N' and S_SLUTSPED is null union select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'N' and S_SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.SLUTSPED = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_FreightPayer_S_NOTIFY2_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = '2' and S_NOTIFY2 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '2' and S_NOTIFY2 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY2 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A')q 
lnkBookingCustomers.condition_FreightPayer_S_NOTIFY2_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = '2' and S_NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '2' and S_NOTIFY2 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY2 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_FreightPayer_S_NOTIFY3_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = '3' and S_NOTIFY3 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '3' and S_NOTIFY3 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY3 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_FreightPayer_S_NOTIFY3_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = '3' and S_NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '3' and S_NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY3 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' )q
lnkBookingCustomers.condition_FreightPayer_S_CONTRACT_HOLDER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is not null union select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_CONTRACT_HOLDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_FreightPayer_S_CONTRACT_HOLDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.CONTRACT_HOLDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_FreightPayer_Union.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and FREIGHT_PAY = 'S' and S_KUNDE is not null union select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and FREIGHT_PAY = 'S' and S_KUNDE is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_KUNDE = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A'  union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join ( select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and FREIGHT_PAY = 'S' and S_KUNDE is null union select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and FREIGHT_PAY = 'S' and S_KUNDE is null) src on  hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.KUNDE = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  FREIGHT_PAY = 'S' and S_KUNDE is null and KUNDE is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and FREIGHT_PAY = 'S' and S_KUNDE is null and KUNDE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'A' and S_AFSENDER is not null union select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'A' and S_AFSENDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_AFSENDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'A' and S_AFSENDER is null union  select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'A' and S_AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.AFSENDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  FREIGHT_PAY = 'A' and S_AFSENDER is null and AFSENDER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and FREIGHT_PAY = 'A' and S_AFSENDER is null and AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union  select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'M' and S_MODTAGER is not null union select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'M' and S_MODTAGER is not null) src on  hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_MODTAGER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'M' and S_MODTAGER is null union select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'M' and S_MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.MODTAGER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  FREIGHT_PAY = 'M' and S_MODTAGER is null and MODTAGER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and FREIGHT_PAY = 'M' and S_MODTAGER is null and MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union  select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'N' and S_SLUTSPED is not null union select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'N' and S_SLUTSPED is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_SLUTSPED = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'N' and S_SLUTSPED is null union select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'N' and S_SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.SLUTSPED = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  FREIGHT_PAY = 'N' and S_SLUTSPED is null and SLUTSPED is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and FREIGHT_PAY = 'N' and S_SLUTSPED is null and SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0  union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = '2' and S_NOTIFY2 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '2' and S_NOTIFY2 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY2 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = '2' and S_NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '2' and S_NOTIFY2 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY2 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  FREIGHT_PAY = '2' and S_NOTIFY2 is null and NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and FREIGHT_PAY = '2' and S_NOTIFY2 is null and NOTIFY2 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = '3' and S_NOTIFY3 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '3' and S_NOTIFY3 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY3 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A'  union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = '3' and S_NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '3' and S_NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY3 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K'  union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  FREIGHT_PAY = '3' and S_NOTIFY3 is null and NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and FREIGHT_PAY = '3' and S_NOTIFY3 is null and NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (	select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is not null union select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on 	hubB1.S_CONTRACT_HOLDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on 	hubB1.CONTRACT_HOLDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is null and CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is null and CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.satLnk.CountRows =  select count (*) c from sat.satLnkBookingCustomers

lnkBookingFileLiner.lnk.CountRows =  select count (*) c from lin.lnkBookingFileLiner
lnkBookingFileLiner.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubFileLiner hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.SAGSNR, src.AFDELING from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, SAGSNR, AFDELING from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 union select BOOK_NR, SELSKAB, SrcSystemId, SAGSNR, AFDELING from StagingAreaTest.stg.UNITY_Book where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.serviceCode = srcHub1.AFDELING and hub2.fileLinerNr = srcHub1.SAGSNR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)union (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubFileLiner hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.SAGSNR, src.AFDELING from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, SAGSNR, AFDELING from StagingAreaTest.stg.MSCRUS_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BOOK_NR, SELSKAB, SrcSystemId, SAGSNR, AFDELING from StagingAreaTest.stg.UNITY_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.serviceCode = srcHub1.AFDELING and hub2.fileLinerNr = srcHub1.SAGSNR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId ))q
lnkBookingFileLiner.satLnk.CountRows =  select count (*) c from sat.satLnkBookingFileLiner

lnkBookingImportExport.lnk.CountRows =  select count (*) c from lin.lnkBookingImportExport
lnkBookingImportExport.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubImportExport, srcHub1.SrcSystemId from  hub.hubImportExport hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.IMP_EXP from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, IMP_EXP from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and IMP_EXP is not null union select BOOK_NR, SELSKAB, SrcSystemId, IMP_EXP from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and IMP_EXP is not null) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.importExportCode = srcHub1.IMP_EXP union select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubImportExport, srcHub1.SrcSystemId from hub.hubImportExport hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.IMP_EXP from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, IMP_EXP from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and IMP_EXP is null union select BOOK_NR, SELSKAB, SrcSystemId, IMP_EXP from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and IMP_EXP is null) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubImportExport = -1) union (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubImportExport, srcHub1.SrcSystemId from  hub.hubImportExport hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.IMP_EXP from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, IMP_EXP from StagingAreaTest.stg.MSCRUS_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and IMP_EXP is not null union select BOOK_NR, SELSKAB, SrcSystemId, IMP_EXP from StagingAreaTest.stg.UNITY_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and IMP_EXP is not null) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.importExportCode = srcHub1.IMP_EXP  union  select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubImportExport, srcHub1.SrcSystemId from  hub.hubImportExport hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.IMP_EXP from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, IMP_EXP from StagingAreaTest.stg.MSCRUS_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and IMP_EXP is null union select BOOK_NR, SELSKAB, SrcSystemId, IMP_EXP from StagingAreaTest.stg.UNITY_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null and IMP_EXP is null) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubImportExport = -1))q
lnkBookingImportExport.satLnk.CountRows =  select count (*) c from sat.satLnkBookingImportExport

lnkBookingLocations.lnk.CountRows =  select count (*) c from lin.lnkBookingLocations
lnkBookingLocations.condition_AFG_ZONE.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, AFG_ZONE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and AFG_ZONE is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, AFG_ZONE from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and AFG_ZONE is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.AFG_ZONE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, AFG_ZONE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and AFG_ZONE is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, AFG_ZONE from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and AFG_ZONE is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_ANK_ZONE_notNull.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.ANK_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, ANK_ZONE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and ANK_ZONE is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, ANK_ZONE from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and ANK_ZONE is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.ANK_ZONE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingLocations.condition_ANK_ZONE_Null.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.POD, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, POD from StagingAreaTest.stg.MSCRUS_BookDryPort where isDeleted = 0 and BOOK_NR  in (select distinct BOOK_NR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and ANK_ZONE is null)union select distinct BOOK_NR, SELSKAB, SrcSystemId, POD from StagingAreaTest.stg.UNITY_BookDryPort where isDeleted = 0 and BOOK_NR  in (select distinct BOOK_NR from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and ANK_ZONE is null)) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.POD and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId )q
lnkBookingLocations.condition_ANK_ZONE_Null_ForBothNull.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking,  src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and ANK_ZONE is null union select distinct BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and ANK_ZONE is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q 
lnkBookingLocations.condition_POD.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.POD, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, POD from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and POD is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, POD from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and POD is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.POD and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.POD, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, POD from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and POD is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, POD from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and POD is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q 
lnkBookingLocations.condition_POR_notNull.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.POR, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, POR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and POR is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, POR from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and POR is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.POR and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q 
lnkBookingLocations.condition_POR_Null.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.POR, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, POR from StagingAreaTest.stg.MSCRUS_BookDryPort where isDeleted = 0 and BOOK_NR  in (select distinct BOOK_NR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and POR is null) union  select distinct BOOK_NR, SELSKAB, SrcSystemId, POR from StagingAreaTest.stg.UNITY_BookDryPort  where isDeleted = 0 and BOOK_NR  in (select distinct BOOK_NR from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and POR is null)) src on  hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on  hub2.locationCode = srcHub1.POR and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingLocations.condition_POR_Null_ForBothNull.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking,  src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and POR is null union select distinct BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and POR is null) src on  hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_PORT_TRANS.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.PORT_TRANS and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_PORT_TRANS2.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS2, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS2 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS2 is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS2 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS2 is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.PORT_TRANS2 and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS2, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS2 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS2 is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS2 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS2 is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_PORT_TRANS3.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS3, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS3 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS3 is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS3 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS3 is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.PORT_TRANS3 and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS3, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS3 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS3 is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS3 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS3 is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_PORT_TRANS4.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS4, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS4 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS4 is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS4 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS4 is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.PORT_TRANS4 and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS4, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS4 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS4 is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS4 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS4 is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_PORT_TRANS5.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS5, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS5 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS5 is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS5 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS5 is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.PORT_TRANS5 and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS5, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS5 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS5 is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS5 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS5 is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_FREIGHT_PAY.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.FREIGHT_PAY, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and FREIGHT_PAY is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and FREIGHT_PAY is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.FREIGHT_PAY and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.FREIGHT_PAY, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and FREIGHT_PAY is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and FREIGHT_PAY is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_FREIGHT_PAY_IMS.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.FREIGHT_PAY_IMS, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY_IMS from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and FREIGHT_PAY_IMS is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY_IMS from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and FREIGHT_PAY_IMS is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.FREIGHT_PAY_IMS and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.FREIGHT_PAY_IMS, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY_IMS from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and FREIGHT_PAY_IMS is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY_IMS from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and FREIGHT_PAY_IMS is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_DRY_PORT.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.DRY_PORT, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.MSCRUS_BookDryPort where isDeleted = 0 and DRY_PORT is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.UNITY_BookDryPort where isDeleted = 0 and DRY_PORT is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.DRY_PORT and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.DRY_PORT, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.MSCRUS_BookDryPort where isDeleted = 0 and DRY_PORT is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.UNITY_BookDryPort where isDeleted = 0 and DRY_PORT is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_PORT_SAIL.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_SAIL, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_SAIL from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_SAIL is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_SAIL from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_SAIL is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.PORT_SAIL and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_SAIL, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_SAIL from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_SAIL is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_SAIL from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_SAIL is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_PORT_FEED.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_FEED, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_FEED from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_FEED is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_FEED from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_FEED is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.PORT_FEED and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_FEED, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_FEED from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_FEED is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_FEED from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_FEED is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.satLnk.CountRows =  select count (*) c from sat.satLnkBookingLocations

lnkBookingPPCCEE.lnk.CountRows =  select count (*) c from lin.lnkBookingPPCCEE
lnkBookingPPCCEE.condition.CountRows = select count (*) c from ((select distinct hub2.dwhIdHubPPCCEE, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from hub.hubPPCCEE hub2 inner join (select hub1.dwhIdHubBooking, src.BET_KODE, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, BET_KODE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and BET_KODE is not null union select BOOK_NR, SELSKAB, SrcSystemId, BET_KODE from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and BET_KODE is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.paymentTermCode = srcHub1.BET_KODE union select distinct hub2.dwhIdHubPPCCEE, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubPPCCEE hub2 inner join (select hub1.dwhIdHubBooking, src.BET_KODE, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, BET_KODE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and BET_KODE is null union select BOOK_NR, SELSKAB, SrcSystemId, BET_KODE from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and BET_KODE is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubPPCCEE = -1 and hub2.srcSystemId = 0) union (select distinct hub2.dwhIdHubPPCCEE, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from hub.hubPPCCEE hub2 inner join (select hub1.dwhIdHubBooking, src.BET_KODE, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, BET_KODE from StagingAreaTest.stg.MSCRUS_Book where BET_KODE is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BOOK_NR, SELSKAB, SrcSystemId, BET_KODE from StagingAreaTest.stg.UNITY_Book where BET_KODE is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.paymentTermCode = srcHub1.BET_KODE union select distinct hub2.dwhIdHubPPCCEE, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubPPCCEE hub2 inner join (select hub1.dwhIdHubBooking, src.BET_KODE, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, BET_KODE from StagingAreaTest.stg.MSCRUS_Book where BET_KODE is null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BOOK_NR, SELSKAB, SrcSystemId, BET_KODE from StagingAreaTest.stg.UNITY_Book where BET_KODE is null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubPPCCEE = -1 and hub2.srcSystemId = 0))q
lnkBookingPPCCEE.satLnk.CountRows =  select count (*) c from sat.satLnkBookingPPCCEE

lnkBookingCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingCompany
lnkBookingCompany.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 union select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Book where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId) union (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Book where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q


lnkBookingBookingInternalRemarks.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingInternalRemarks
lnkBookingBookingInternalRemarks.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubBookingInternalRemarks, srcHub1.SrcSystemId from  hub.hubBookingInternalRemarks hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 union select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Book where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.SrcSystemId = srcHub1.SrcSystemId) union (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubBookingInternalRemarks, srcHub1.SrcSystemId from  hub.hubBookingInternalRemarks hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Book where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.SrcSystemId = srcHub1.SrcSystemId))q
lnkBookingBookingInternalRemarks.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingInternalRemarks
lnkBookingBookingInternalRemarks.error.CountRows = select  count (*) c  from [err].[errLnkBook] where packageCreator like '%lnkBookingBookingInternalRemarks%'


lnkBookingBranch.lnk.CountRows =  select count (*) c from lin.lnkBookingBranch
lnkBookingBranch.condition.CountRows = select count (*) c from ((select distinct hub2.dwhIdHubBranch, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from hub.hubBranch hub2 inner join (select hub1.dwhIdHubBooking, src.KONTOR, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, KONTOR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and KONTOR is not null union select BOOK_NR, SELSKAB, SrcSystemId, KONTOR from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and KONTOR is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.branchNumber = srcHub1.KONTOR and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.SrcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubBranch, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBranch hub2 inner join (select hub1.dwhIdHubBooking, src.KONTOR, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, KONTOR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and KONTOR is null union select BOOK_NR, SELSKAB, SrcSystemId, KONTOR from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and KONTOR is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubBranch = -1) union (select distinct hub2.dwhIdHubBranch, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from hub.hubBranch hub2 inner join (select hub1.dwhIdHubBooking, src.KONTOR, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, KONTOR from StagingAreaTest.stg.MSCRUS_Book where KONTOR is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BOOK_NR, SELSKAB, SrcSystemId, KONTOR from StagingAreaTest.stg.UNITY_Book where KONTOR is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.branchNumber = srcHub1.KONTOR and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.SrcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubBranch, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from hub.hubBranch hub2 inner join (select hub1.dwhIdHubBooking, src.KONTOR, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, KONTOR from StagingAreaTest.stg.MSCRUS_Book where KONTOR is null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BOOK_NR, SELSKAB, SrcSystemId, KONTOR from StagingAreaTest.stg.UNITY_Book where KONTOR is null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubBranch = -1))q
lnkBookingBranch.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBranch

lnkBookingServiceNames.lnk.CountRows =  select count (*) c from lin.lnkBookingServiceNames
lnkBookingServiceNames.condition.CountRows = select count (*) c from ((select distinct hub2.dwhIdHubServiceNames, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from hub.hubServiceNames hub2 inner join (select hub1.dwhIdHubBooking, src.OCEAN_AFDELING, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, OCEAN_AFDELING from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and OCEAN_AFDELING is not null union select BOOK_NR, SELSKAB, SrcSystemId, OCEAN_AFDELING from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and OCEAN_AFDELING is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.serviceCode = srcHub1.OCEAN_AFDELING and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.SrcSystemId = srcHub1.SrcSystemId union  select distinct hub2.dwhIdHubServiceNames, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubServiceNames hub2 inner join ( select hub1.dwhIdHubBooking, src.AFDELING, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, AFDELING from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and OCEAN_AFDELING is null union select BOOK_NR, SELSKAB, SrcSystemId, AFDELING from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and OCEAN_AFDELING is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.serviceCode = srcHub1.AFDELING and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.SrcSystemId = srcHub1.SrcSystemId) union ( select distinct hub2.dwhIdHubServiceNames, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from hub.hubServiceNames hub2 inner join (select hub1.dwhIdHubBooking, src.OCEAN_AFDELING, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, OCEAN_AFDELING from StagingAreaTest.stg.MSCRUS_Book where OCEAN_AFDELING is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BOOK_NR, SELSKAB, SrcSystemId, OCEAN_AFDELING from StagingAreaTest.stg.UNITY_Book where OCEAN_AFDELING is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.serviceCode = srcHub1.OCEAN_AFDELING and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.SrcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubServiceNames, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubServiceNames hub2 inner join (select hub1.dwhIdHubBooking, src.AFDELING, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, AFDELING from StagingAreaTest.stg.MSCRUS_Book where OCEAN_AFDELING is null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BOOK_NR, SELSKAB, SrcSystemId, AFDELING from StagingAreaTest.stg.UNITY_Book where OCEAN_AFDELING is null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.serviceCode = srcHub1.AFDELING and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.SrcSystemId = srcHub1.SrcSystemId))q
lnkBookingServiceNames.satLnk.CountRows =  select count (*) c from sat.satLnkBookingServiceNames


lnkBookingBookingManifestAdditionals.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingManifestAdditionals
lnkBookingBookingManifestAdditionals.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifestAdditionals, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingManifestAdditionals, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingManifestAdditionals hub1 inner join (select BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDetails where isDeleted = 0 union select BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookDetails where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.segmentCode = src.SEGMENT_CODE and hub1.sequenceNr = src.SEQ_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingManifestAdditionals.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingManifestAdditionals

lnkBookingManifestAdditionalsCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingManifestAdditionalsCompany
lnkBookingManifestAdditionalsCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifestAdditionals, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingManifestAdditionals, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingManifestAdditionals hub1 inner join (select BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDetails where isDeleted = 0 union select BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookDetails where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.segmentCode = src.SEGMENT_CODE and hub1.sequenceNr = src.SEQ_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkBookingBookingManifestedHaulage.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingManifestedHaulage
lnkBookingBookingManifestedHaulage.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifestedHaulage, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingManifestedHaulage, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingManifestedHaulage hub1 inner join (select BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDetailsMof where isDeleted = 0 union select BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookDetailsMof where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.sequenceNumber = src.SEQ_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingManifestedHaulage.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingManifestedHaulage

lnkBookingManifestedHaulageTransportMode.lnk.CountRows =  select count (*) c from lin.lnkBookingManifestedHaulageTransportMode
lnkBookingManifestedHaulageTransportMode.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifestedHaulage, hub2.dwhIdHubTransportMode, srcHub1.SrcSystemId from  hub.hubTransportMode hub2 inner join (select hub1.dwhIdHubBookingManifestedHaulage, src.SELSKAB, src.SrcSystemId, src.PRE_CARRIAGE_MODE from hub.hubBookingManifestedHaulage hub1 inner join (select BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId, PRE_CARRIAGE_MODE from StagingAreaTest.stg.MSCRUS_BookDetailsMof where isDeleted = 0 and PRE_CARRIAGE_MODE is not null union select  BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId, PRE_CARRIAGE_MODE from StagingAreaTest.stg.UNITY_BookDetailsMof where isDeleted = 0 and PRE_CARRIAGE_MODE is not null) src on  hub1.bookingNumber = src.BOOK_NR and  hub1.sequenceNumber = src.SEQ_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.transportModeCode = srcHub1.PRE_CARRIAGE_MODE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubBookingManifestedHaulage, hub2.dwhIdHubTransportMode, srcHub1.SrcSystemId from  hub.hubTransportMode hub2 inner join (select hub1.dwhIdHubBookingManifestedHaulage, src.SELSKAB, src.SrcSystemId, src.PRE_CARRIAGE_MODE from hub.hubBookingManifestedHaulage hub1 inner join (select BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId, PRE_CARRIAGE_MODE from StagingAreaTest.stg.MSCRUS_BookDetailsMof where isDeleted = 0 and PRE_CARRIAGE_MODE is null union select  BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId, PRE_CARRIAGE_MODE from StagingAreaTest.stg.UNITY_BookDetailsMof where isDeleted = 0 and PRE_CARRIAGE_MODE is null) src on hub1.bookingNumber = src.BOOK_NR and hub1.sequenceNumber = src.SEQ_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubTransportMode = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingManifestedHaulageTransportMode.satLnk.CountRows =  select count (*) c from sat.satLnkBookingManifestedHaulageTransportMode

lnkBookingManifestedHaulageCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingManifestedHaulageCompany
lnkBookingManifestedHaulageCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifestedHaulage, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingManifestedHaulage, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingManifestedHaulage hub1 inner join (select BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDetailsMof where isDeleted = 0 union select BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookDetailsMof where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.sequenceNumber = src.SEQ_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkBookingBookingEvents.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingEvents
lnkBookingBookingEvents.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingEvents, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingEvents, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingEvents hub1 inner join (select SEQ, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.MSCRUS_BookEvent where isDeleted = 0 and BOOK_NR is not null union select SEQ, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.UNITY_BookEvent where isDeleted = 0 and BOOK_NR is not null) src on hub1.bookingEventId = src.SEQ and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingEvents.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingEvents

lnkBookingEventsCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingEventsCompany
lnkBookingEventsCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingEvents, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingEvents, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingEvents hub1 inner join (select SEQ, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.MSCRUS_BookEvent where isDeleted = 0 union select SEQ, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.UNITY_BookEvent where isDeleted = 0) src on hub1.bookingEventId = src.SEQ and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkBookingBookingCharges.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingCharges
lnkBookingBookingCharges.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCharges, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingCharges, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingCharges hub1 inner join (select BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookFak where isDeleted = 0 union select BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookFak where isDeleted = 0) src on hub1.bookingNr = src.BOOK_NR and hub1.positionNr = src.FRG_BT_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and  hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingCharges.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingCharges

lnkBookingChargesCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingChargesCompany
lnkBookingChargesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCharges, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingCharges, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingCharges hub1 inner join (select BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookFak where isDeleted = 0 union select BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookFak where isDeleted = 0) src on hub1.bookingNr = src.BOOK_NR and hub1.positionNr = src.FRG_BT_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkBookingBookingCargo.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingCargo
lnkBookingBookingCargo.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCargo, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingCargo, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and  hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingCargo.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingCargo

lnkBookingCargoBookingHaulageDetails.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoBookingHaulageDetails
lnkBookingCargoBookingHaulageDetails.condition.CountRows = select count (*) c from (select distinct hubBChubBHD.dwhIdHubBookingCargo, hubBChubBHD.dwhIdhubBookingHaulageDetails from sat.satBookingHaulageDetails satBHD inner join (select hub2.dwhIdHubBookingHaulageDetails, hubBC.dwhIdHubBookingCargo, hubBC.BOOK_NR, hubBC.VAREPOST_NR, hubBC.SELSKAB, hubBC.SrcSystemId from hub.hubBookingHaulageDetails hub2 inner join (select hub1.dwhIdHubBookingCargo, src.BOOK_NR, src.VAREPOST_NR, src.SELSKAB, src.SrcSystemId from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId from  StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId from  StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr =  src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId) hubBC on hub2.bookingNumber = hubBC.BOOK_NR and hub2.accessCompanyId = hubBC.SELSKAB and hub2.srcSystemId = hubBC.srcSystemId) hubBChubBHD on hubBChubBHD.dwhIdhubBookingHaulageDetails = satBHD.dwhIdhubBookingHaulageDetails and hubBChubBHD.VAREPOST_NR =satBHD.bookLineNr and hubBChubBHD.SrcSystemId = satBHD.srcSystemId)q
lnkBookingCargoBookingHaulageDetails.satLnk.CountRows =  select count (*) c from sat.satLnkBookingCargoBookingHaulageDetails
lnkBookingCargoBookingHaulageDetails.error.CountRows = select count (*) c from (select packageName, srcTablename, ErrorDate, description, BOOK_NR, VAREPOST_NR, SELSKAB  from DataVaultTest.etl.errLogLnkDataVault where packageName like '%lnkBookingCargoBookingHaulageDetails%')q

lnkBookingCargoContainerType.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoContainerType
lnkBookingCargoContainerType.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubContainerType, srcHub1.dwhIdHubBookingCargo, srcHub1.SrcSystemId from  hub.hubContainerType hub2 inner join (select hub1.dwhIdHubBookingCargo, src.CONT_TYPE, src.SELSKAB, src.SrcSystemId from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, CONT_TYPE from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and CONT_TYPE is not null union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, CONT_TYPE from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and CONT_TYPE is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.cargoLineNr  = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and  hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.containerTypeCode = srcHub1.CONT_TYPE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubContainerType, srcHub1.dwhIdHubBookingCargo, srcHub1.SrcSystemId from  hub.hubContainerType hub2 inner join (select hub1.dwhIdHubBookingCargo, src.CONT_TYPE, src.SELSKAB, src.SrcSystemId from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, CONT_TYPE from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and CONT_TYPE is  null union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, CONT_TYPE from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and CONT_TYPE is  null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.cargoLineNr  = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on  hub2.dwhIdHubContainerType = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingCargoContainerType.satLnk.CountRows =  select count (*) c from sat.satLnkBookingCargoContainerType

lnkBookingCargoFullEmpty.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoFullEmpty
lnkBookingCargoFullEmptyE.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCargo, hub2.dwhIdHubFullEmpty, srcHub1.SrcSystemId from  hub.hubFullEmpty hub2 inner join (select hub1.dwhIdHubBookingCargo, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, TRP_MADE1, TRP_MADE2  from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and (TRP_MADE1='MTY' or TRP_MADE2='MTY') union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, TRP_MADE1, TRP_MADE2  from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and (TRP_MADE1='MTY' or TRP_MADE2='MTY') ) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.fillingStatus = 'E' )q
lnkBookingCargoFullEmptyF.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCargo, hub2.dwhIdHubFullEmpty, srcHub1.SrcSystemId from  hub.hubFullEmpty hub2 inner join (select hub1.dwhIdHubBookingCargo, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, TRP_MADE1, TRP_MADE2  from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and (TRP_MADE1 !='MTY' and TRP_MADE2 !='MTY') union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, TRP_MADE1, TRP_MADE2  from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and (TRP_MADE1 !='MTY' and TRP_MADE2 !='MTY')) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.fillingStatus = 'F')q
lnkBookingCargoFullEmpty.satLnk.CountRows = select count (*) c from sat.satLnkBookingCargoFullEmpty

lnkBookingCargoLocations.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoLocations
lnkBookingCargoLocations.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBookingCargo, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBookingCargo, src.DRY_PORT, src.SELSKAB, src.SrcSystemId from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and DRY_PORT is not null union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and DRY_PORT is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.cargoLineNr  = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and  hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.DRY_PORT and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBookingCargo, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBookingCargo, src.DRY_PORT, src.SELSKAB, src.SrcSystemId from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and DRY_PORT is  null union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and DRY_PORT is  null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.cargoLineNr  = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingCargoLocations.satLnk.CountRows =  select count (*) c from sat.satLnkBookingCargoLocations

lnkBookingCargoCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoCompany
lnkBookingCargoCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCargo, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingCargo, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q 


lnkBookingHaulageDetailsCustomers.lnk.CountRows =  select count (*) c from lin.lnkBookingHaulageDetailsCustomers
lnkBookingHaulageDetailsCustomers.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingHaulageDetails, hub2.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCustomers hub2 inner join (select hub1.dwhIdHubBookingHaulageDetails, src.SELSKAB, src.SrcSystemId, src.KUNDE from hub.hubBookingHaulageDetails hub1 inner join (select BOOK_NR, LOBE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.MSCRUS_BookKor where isDeleted = 0 and KUNDE is not null union select BOOK_NR, LOBE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.UNITY_BookKor where isDeleted = 0 and KUNDE is not null ) src on  hub1.bookingNumber = src.BOOK_NR and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.customerNr = srcHub1.KUNDE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubBookingHaulageDetails, hub2.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCustomers hub2 inner join (select hub1.dwhIdHubBookingHaulageDetails, src.SELSKAB, src.SrcSystemId, src.KUNDE from hub.hubBookingHaulageDetails hub1 inner join (select BOOK_NR, LOBE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.MSCRUS_BookKor where isDeleted = 0 and KUNDE is null union select BOOK_NR, LOBE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.UNITY_BookKor where isDeleted = 0 and KUNDE is  null) src on  hub1.bookingNumber = src.BOOK_NR and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on  hub2.dwhIdHubCustomers = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingHaulageDetailsCustomers.satLnk.CountRows =  select count (*) c from sat.satLnkBookingHaulageDetailsCustomers

lnkBookingHaulageDetailsCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingHaulageDetailsCompany
lnkBookingHaulageDetailsCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingHaulageDetails, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingHaulageDetails, src.SELSKAB, src.SrcSystemId from hub.hubBookingHaulageDetails hub1 inner join (select BOOK_NR, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookKor where isDeleted = 0 union select BOOK_NR, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookKor where isDeleted = 0 ) src on hub1.bookingNumber = src.BOOK_NR and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkBookingChargeLinesCurrency.lnk.CountRows =  select count (*) c from lin.lnkBookingChargeLinesCurrency
lnkBookingChargeLinesCurrency.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingChargeLines, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubBookingChargeLines, src.SELSKAB, src.SrcSystemId, src.OMR_VALUTA from hub.hubBookingChargeLines hub1 inner join (select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId, OMR_VALUTA from StagingAreaTest.stg.MSCRUS_BookLin where isDeleted = 0 and OMR_VALUTA is not null union select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId, OMR_VALUTA from StagingAreaTest.stg.UNITY_BookLin where isDeleted = 0 and OMR_VALUTA is not null) src on  hub1.bookingNumber = src.BOOK_NR and hub1.positionNr = src.FRG_BT_NR and hub1.lineNr = src.LINIE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.OMR_VALUTA and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubBookingChargeLines, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubBookingChargeLines, src.SELSKAB, src.SrcSystemId, src.OMR_VALUTA from hub.hubBookingChargeLines hub1 inner join (select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId, OMR_VALUTA from StagingAreaTest.stg.MSCRUS_BookLin where isDeleted = 0 and OMR_VALUTA is  null union select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId, OMR_VALUTA from StagingAreaTest.stg.UNITY_BookLin where isDeleted = 0 and OMR_VALUTA is null) src on hub1.bookingNumber = src.BOOK_NR and hub1.positionNr = src.FRG_BT_NR and hub1.lineNr = src.LINIE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCurrency = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingChargeLinesCurrency.satLnk.CountRows =  select count (*) c from sat.satLnkBookingChargeLinesCurrency

lnkBookingChargesBookingChargeLines.lnk.CountRows =  select count (*) c from lin.lnkBookingChargesBookingChargeLines
lnkBookingChargesBookingChargeLines.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingChargeLines, hub2.dwhIdHubBookingCharges, srcHub1.SrcSystemId from  hub.hubBookingCharges hub2 inner join (select hub1.dwhIdHubBookingChargeLines, src.SELSKAB, src.SrcSystemId, src.BOOK_NR, src.FRG_BT_NR from hub.hubBookingChargeLines hub1 inner join (select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookLin where isDeleted = 0 union select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookLin where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.positionNr = src.FRG_BT_NR and hub1.lineNr = src.LINIE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNr = srcHub1.BOOK_NR and hub2.positionNr = srcHub1.FRG_BT_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingChargesBookingChargeLines.satLnk.CountRows =  select count (*) c from sat.satLnkBookingChargesBookingChargeLines

lnkBookingChargeLinesCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingChargeLinesCompany
lnkBookingChargeLinesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingChargeLines, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingChargeLines, src.SELSKAB, src.SrcSystemId, src.BOOK_NR, src.FRG_BT_NR from hub.hubBookingChargeLines hub1 inner join (select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookLin where isDeleted = 0 union select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookLin where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and  hub1.positionNr = src.FRG_BT_NR and hub1.lineNr = src.LINIE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkBookingBookingManifest.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingManifest
lnkBookingBookingManifest.condition.CountRows =select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifest, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingManifest, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingManifest hub1 inner join (select BOOK_MFT_ID, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.MSCRUS_BookManifests where isDeleted = 0 union select BOOK_MFT_ID, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.UNITY_BookManifests where isDeleted = 0) src on hub1.bookMftId = src.BOOK_MFT_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingManifest.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingManifest

lnkBookingBookingManifestShadowCopy.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingManifestShadowCopy
lnkBookingBookingManifestShadowCopy.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifest, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingManifest, src.SELSKAB, src.SrcSystemId, src.REF_BOOK_NR from hub.hubBookingManifest hub1 inner join (select BOOK_MFT_ID, SELSKAB, SrcSystemId, REF_BOOK_NR from StagingAreaTest.stg.MSCRUS_BookManifests where isDeleted = 0 union select BOOK_MFT_ID, SELSKAB, SrcSystemId, REF_BOOK_NR from StagingAreaTest.stg.UNITY_BookManifests where isDeleted = 0) src on hub1.bookMftId = src.BOOK_MFT_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.REF_BOOK_NR and hub2.accessCompanyID <100 and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingManifestShadowCopy.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingManifestShadowCopy

lnkBookingManifestBookingDTXFile.lnk.CountRows =  select count (*) c from lin.lnkBookingManifestBookingDTXFile
lnkBookingManifestBookingDTXFile.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifest, hub2.dwhIdHubBookingDTXFile, srcHub1.SrcSystemId from  hub.hubBookingDTXFile hub2 inner join (select hub1.dwhIdHubBookingManifest, src.SELSKAB, src.SrcSystemId, src.MFT_FILE_ID from hub.hubBookingManifest hub1 inner join (select BOOK_MFT_ID, SELSKAB, SrcSystemId, MFT_FILE_ID from StagingAreaTest.stg.MSCRUS_BookManifests where isDeleted = 0 union select BOOK_MFT_ID, SELSKAB, SrcSystemId, MFT_FILE_ID from StagingAreaTest.stg.UNITY_BookManifests where isDeleted = 0) src on hub1.bookMftId = src.BOOK_MFT_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.manifestFileId = srcHub1.MFT_FILE_ID and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingManifestBookingDTXFile.satLnk.CountRows =  select count (*) c from sat.satLnkBookingManifestBookingDTXFile
lnkBookingManifestBookingDTXFile.error.CountRows = select count(*) c from (select packageName, srcTablename, ErrorDate, description, BOOK_MFT_ID, SELSKAB  from DataVaultTest.etl.errLogLnkDataVault where packageName like '%lnkBookingManifestBookingDTXFile%')q

lnkBookingManifestCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingManifestCompany
lnkBookingManifestCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifest, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingManifest, src.SELSKAB, src.SrcSystemId, src.MFT_FILE_ID from hub.hubBookingManifest hub1 inner join (select BOOK_MFT_ID, SELSKAB, SrcSystemId, MFT_FILE_ID from StagingAreaTest.stg.MSCRUS_BookManifests where isDeleted = 0 union select BOOK_MFT_ID, SELSKAB, SrcSystemId, MFT_FILE_ID from StagingAreaTest.stg.UNITY_BookManifests where isDeleted = 0) src on hub1.bookMftId = src.BOOK_MFT_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkBookingDTXFileCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingDTXFileCompany
lnkBookingDTXFileCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingDTXFile, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingDTXFile, src.SELSKAB, src.SrcSystemId, src.MFT_FILE_ID from hub.hubBookingDTXFile hub1 inner join (select MFT_FILE_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookMftFile where isDeleted = 0 union select MFT_FILE_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookMftFile where isDeleted = 0) src on hub1.manifestFileId = src.MFT_FILE_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkBookingEMCRemarksBookingManifest.lnk.CountRows =  select count (*) c from lin.lnkBookingEMCRemarksBookingManifest
lnkBookingEMCRemarksBookingManifest.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingEMCRemarks, hub2.dwhIdHubBookingManifest, srcHub1.SrcSystemId from hub.hubBookingManifest hub2 inner join (select hub1.dwhIdHubBookingEMCRemarks, src.SELSKAB, src.SrcSystemId, src.BOOK_MFT_ID from hub.hubBookingEMCRemarks hub1 inner join (select BOOK_MFT_ID, SEQ, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookMftRemarks where isDeleted = 0 union select BOOK_MFT_ID, SEQ, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookMftRemarks where isDeleted = 0) src on hub1.manifestFileId = src.BOOK_MFT_ID and hub1.remarkId = src.SEQ and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookMftId = srcHub1.BOOK_MFT_ID and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingEMCRemarksBookingManifest.satLnk.CountRows =  select count (*) c from sat.satLnkBookingEMCRemarksBookingManifest

lnkBookingEMCRemarksCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingEMCRemarksCompany
lnkBookingEMCRemarksCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingEMCRemarks, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingEMCRemarks, src.SELSKAB, src.SrcSystemId  from hub.hubBookingEMCRemarks hub1 inner join (select BOOK_MFT_ID, SEQ, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookMftRemarks where isDeleted = 0 union select BOOK_MFT_ID, SEQ, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookMftRemarks where isDeleted = 0) src on hub1.manifestFileId = src.BOOK_MFT_ID and hub1.remarkId = src.SEQ and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkBookingBookingOceanVessel.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingOceanVessel
lnkBookingBookingOceanVessel.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingOceanVessel, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingOceanVessel, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingOceanVessel hub1 inner join (select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookVessel where isDeleted = 0 union select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookVessel where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.bookVesselId = src.BOOK_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingOceanVessel.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingOceanVessel

lnkBookingOceanVesselExportVessels.lnk.CountRows =  select count (*) c from lin.lnkBookingOceanVesselExportVessels
lnkBookingOceanVesselExportVessels.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubExportVessels, srcHub1.dwhIdHubBookingOceanVessel, srcHub1.SrcSystemId from  hub.hubExportVessels hub2 inner join (select hub1.dwhIdHubBookingOceanVessel, src.EXP_VESSEL_ID, src.SELSKAB, src.SrcSystemId from hub.hubBookingOceanVessel hub1 inner join (select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId, EXP_VESSEL_ID from StagingAreaTest.stg.MSCRUS_BookVessel where isDeleted = 0 and EXP_VESSEL_ID is not null union select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId, EXP_VESSEL_ID from StagingAreaTest.stg.UNITY_BookVessel where isDeleted = 0 and EXP_VESSEL_ID is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.bookVesselId = src.BOOK_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.expVesselId = srcHub1.EXP_VESSEL_ID and hub2.srcSystemId = srcHub1.SrcSystemId )q
lnkBookingOceanVesselExportVessels.satLnk.CountRows =  select count (*) c from sat.satLnkBookingOceanVesselExportVessels

lnkBookingOceanVesselOceanVesselStatus.lnk.CountRows =  select count (*) c from lin.lnkBookingOceanVesselOceanVesselStatus
lnkBookingOceanVesselOceanVesselStatus.condition.CountRows =select count (*) c from (select distinct hub2.dwhIdHubOceanVesselStatus, srcHub1.dwhIdHubBookingOceanVessel, srcHub1.SrcSystemId from  hub.hubOceanVesselStatus hub2 inner join (select hub1.dwhIdHubBookingOceanVessel, src.STATUS, src.SELSKAB, src.SrcSystemId from hub.hubBookingOceanVessel hub1 inner join (select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId, STATUS from StagingAreaTest.stg.MSCRUS_BookVessel where isDeleted = 0 and STATUS is not null union select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId, STATUS from StagingAreaTest.stg.UNITY_BookVessel where isDeleted = 0 and STATUS is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.bookVesselId  = src.BOOK_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.statusCode = srcHub1.STATUS and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubOceanVesselStatus, srcHub1.dwhIdHubBookingOceanVessel, srcHub1.SrcSystemId from  hub.hubOceanVesselStatus hub2 inner join (select hub1.dwhIdHubBookingOceanVessel, src.STATUS, src.SELSKAB, src.SrcSystemId from hub.hubBookingOceanVessel hub1 inner join (select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId, STATUS from StagingAreaTest.stg.MSCRUS_BookVessel where isDeleted = 0 and STATUS is  null union select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId, STATUS from StagingAreaTest.stg.UNITY_BookVessel where isDeleted = 0 and STATUS is  null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.bookVesselId  = src.BOOK_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and  hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubOceanVesselStatus = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingOceanVesselOceanVesselStatus.satLnk.CountRows =  select count (*) c from sat.satLnkBookingOceanVesselOceanVesselStatus

lnkBookingOceanVesselCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingOceanVesselCompany
lnkBookingOceanVesselCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingOceanVessel, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingOceanVessel, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingOceanVessel hub1 inner join (select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookVessel where isDeleted = 0 union select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookVessel where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.bookVesselId = src.BOOK_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkWeekendsHolidaysCompany.lnk.CountRows =  select count (*) c from lin.lnkWeekendsHolidaysCompany
lnkWeekendsHolidaysCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubWeekendsHolidays, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubWeekendsHolidays, src.SELSKAB, src.SrcSystemId from hub.hubWeekendsHolidays hub1 inner join (select AFDELING, DATO, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_ContHolliday where isDeleted = 0 union select AFDELING, DATO, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_ContHolliday where isDeleted = 0) src on hub1.serviceCode = src.AFDELING and hub1.date = src.DATO and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkContainerMovesBooking.lnk.CountRows =  select count (*) c from lin.lnkContainerMovesBooking
lnkContainerMovesBooking.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerMoves, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubContainerMoves, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubContainerMoves hub1 inner join (select LOBE_NR, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.MSCRUS_ContRep where isDeleted = 0 and BOOK_NR is not null union select LOBE_NR, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.UNITY_ContRep where isDeleted = 0 and BOOK_NR is not null) src on hub1.moveId = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkContainerMovesBooking.satLnk.CountRows =  select count (*) c from sat.satLnkContainerMovesBooking

lnkContainerMovesContainerLocation.lnk.CountRows =  select count (*) c from lin.lnkContainerMovesContainerLocation
lnkContainerMovesContainerLocation.condition.CountRows =select count (*) c from (select distinct srcHub1.dwhIdHubContainerMoves, hub2.dwhIdHubContainerLocation, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubContainerMoves, src.SELSKAB, src.SrcSystemId, src.LOC from hub.hubContainerMoves hub1 inner join (select LOBE_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.MSCRUS_ContRep where isDeleted = 0 and LOC is not null union select LOBE_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.UNITY_ContRep where isDeleted = 0 and LOC is not null) src on hub1.moveId = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.containerLocationCode = srcHub1.LOC and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubContainerMoves, hub2.dwhIdHubContainerLocation, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubContainerMoves, src.SELSKAB, src.SrcSystemId, src.LOC from hub.hubContainerMoves hub1 inner join (select LOBE_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.MSCRUS_ContRep where isDeleted = 0 and LOC is null union select LOBE_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.UNITY_ContRep where isDeleted = 0 and LOC is null) src on hub1.moveId = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on  hub2.dwhIdHubContainerLocation = -1 and  hub2.accessCompanyId =  -1 and  hub2.srcSystemId = 0)q
lnkContainerMovesContainerLocation.satLnk.CountRows =  select count (*) c from sat.satLnkContainerMovesContainerLocation

lnkContainerMovesCompany.lnk.CountRows =  select count (*) c from lin.lnkContainerMovesCompany
lnkContainerMovesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerMoves, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubContainerMoves, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubContainerMoves hub1 inner join (select LOBE_NR, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.MSCRUS_ContRep where isDeleted = 0 union select LOBE_NR, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.UNITY_ContRep where isDeleted = 0) src on hub1.moveId = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q


lnkControllingOfficeLocations.lnk.CountRows =  select count (*) c from lin.lnkControllingOfficeLocations
lnkControllingOfficeLocations.condition.CountRows = select count (*) c from(select distinct dwhIdHubLocations, dwhIdHubControllingOffice from (select distinct hubL.dwhIdHubLocations, hubCO1.dwhIdHubControllingOffice from hub.hubLocations hubL inner join (select  hubCO.dwhIdHubControllingOffice, src.COMPANY_ID, src.OFFICE_ID, src.Location_Code from hub.hubControllingOffice hubCO inner join (select distinct q.COMPANY_ID, q.OFFICE_ID, q.Location_Code from (select distinct COMPANY_ID, ISNULL (OFFICE_ID, -1) as OFFICE_ID, Location_Code from StagingAreaTest.stg.EXCEL_ControllingOfficeLocationCode where Office_ID is null union select distinct COMPANY_ID,  OFFICE_ID, Location_Code from StagingAreaTest.stg.EXCEL_ControllingOfficeLocationCode where Office_ID is not null)q) src on src.COMPANY_ID = hubCO.companyId and src.OFFICE_ID = hubCO.officeId and src.Location_Code is not null) hubCO1 on hubCO1.LOCATION_CODE = hubL.locationCode and hubCO1.COMPANY_ID = hubL.accessCompanyId union select distinct hubL.dwhIdHubLocations, hubCO1.dwhIdHubControllingOffice from hub.hubLocations hubL inner join (select  hubCO.dwhIdHubControllingOffice, src.COMPANY_ID, src.OFFICE_ID, src.Location_Code from hub.hubControllingOffice hubCO inner join (select distinct q.COMPANY_ID, q.OFFICE_ID, q.Location_Code from (select distinct COMPANY_ID, ISNULL (OFFICE_ID, -1) as OFFICE_ID, Location_Code from StagingAreaTest.stg.EXCEL_ControllingOfficeLocationCode where Office_ID is null union select distinct COMPANY_ID,  OFFICE_ID, Location_Code from StagingAreaTest.stg.EXCEL_ControllingOfficeLocationCode where Office_ID is not null)q) src on src.COMPANY_ID = hubCO.companyId and src.OFFICE_ID = hubCO.officeId and src.Location_Code is null) hubCO1 on hubCO1.COMPANY_ID = hubL.accessCompanyId and hubL.dwhIdHubLocations = -1)un)q
lnkControllingOfficeLocations.satLnk.CountRows =  select count (*) c from sat.satLnkControllingOfficeLocations

lnkContainerTypeContainerTypeSpecEquip.lnk.CountRows =  select count (*) c from lin.lnkContainerTypeContainerTypeSpecEquip
lnkContainerTypeContainerTypeSpecEquip.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubContainerTypeSpecEquip, srcHub1.SrcSystemId from  hub.hubContainerTypeSpecEquip hub2 inner join (select hub1.dwhIdHubContainerType, src.SELSKAB, src.SrcSystemId, src.CONT_FEET, src.CONT_SIZE, src.CONT_TYPE, src.TEKST from hub.hubContainerType hub1 inner join (select KODE, SELSKAB, SrcSystemId, CONT_FEET, CONT_SIZE, CONT_TYPE, TEKST from StagingAreaTest.stg.MSCRUS_ContType where isDeleted = 0 union select KODE, SELSKAB, SrcSystemId, CONT_FEET, CONT_SIZE, CONT_TYPE, TEKST from StagingAreaTest.stg.UNITY_ContType where isDeleted = 0) src on hub1.containerTypeCode = src.KODE and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.contFeet = srcHub1.CONT_FEET and hub2.contSize = srcHub1.CONT_SIZE and hub2.contType = srcHub1.CONT_TYPE and hub2.contTypeName = srcHub1.TEKST )q
lnkContainerTypeContainerTypeSpecEquip.satLnk.CountRows =  select count (*) c from sat.satLnkContainerTypeContainerTypeSpecEquip

lnkContainerTypeIsoCode.lnk.CountRows =  select count (*) c from lin.lnkContainerTypeIsoCode
lnkContainerTypeIsoCode.isoCode4_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubIsoCode, hub2.isoCodeRole from hub.hubIsoCode hub2 inner join (select hub1.dwhIdHubContainerType, src.ISO_KODE4, src.SELSKAB, src.SrcSystemId from hub.hubContainerType hub1 inner join (SELECT distinct ISO_KODE4, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE4 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE4, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE4 IS NOT NULL and IsDeleted = 0) src on hub1.containerTypeCode =  src.KODE and hub1.accessCompanyId =  src.SELSKAB and hub1.srcSystemId =  src.SrcSystemId) srcHub1 on hub2.isoCode = srcHub1.ISO_KODE4 and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId and hub2.isoCodeRole ='ISO_KODE4')q
lnkContainerTypeIsoCode.isoCode6_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubIsoCode, hub2.isoCodeRole from hub.hubIsoCode hub2 inner join (select hub1.dwhIdHubContainerType, src.ISO_KODE6, src.SELSKAB, src.SrcSystemId from hub.hubContainerType hub1 inner join (SELECT distinct ISO_KODE6, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6 IS NOT NULL and IsDeleted = 0) src on hub1.containerTypeCode =  src.KODE and hub1.accessCompanyId =  src.SELSKAB and hub1.srcSystemId =  src.SrcSystemId) srcHub1 on hub2.isoCode = srcHub1.ISO_KODE6 and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId and hub2.isoCodeRole ='ISO_KODE6')q
lnkContainerTypeIsoCode.isoCode6_2_condition.CountRows =  select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubIsoCode, hub2.isoCodeRole from hub.hubIsoCode hub2 inner join (select hub1.dwhIdHubContainerType, src.ISO_KODE6_2, src.SELSKAB, src.SrcSystemId from hub.hubContainerType hub1 inner join (SELECT distinct ISO_KODE6_2, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_2 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_2, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_2 IS NOT NULL and IsDeleted = 0) src on hub1.containerTypeCode =  src.KODE and hub1.accessCompanyId =  src.SELSKAB and hub1.srcSystemId =  src.SrcSystemId) srcHub1 on hub2.isoCode = srcHub1.ISO_KODE6_2 and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId and hub2.isoCodeRole ='ISO_KODE6_2')q
lnkContainerTypeIsoCode.isoCode6_3_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubIsoCode, hub2.isoCodeRole from hub.hubIsoCode hub2 inner join (select hub1.dwhIdHubContainerType, src.ISO_KODE6_3, src.SELSKAB, src.SrcSystemId from hub.hubContainerType hub1 inner join (SELECT distinct ISO_KODE6_3, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_3 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_3, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_3 IS NOT NULL and IsDeleted = 0) src on hub1.containerTypeCode =  src.KODE and hub1.accessCompanyId =  src.SELSKAB and hub1.srcSystemId =  src.SrcSystemId) srcHub1 on hub2.isoCode = srcHub1.ISO_KODE6_3 and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId and hub2.isoCodeRole ='ISO_KODE6_3')q
lnkContainerTypeIsoCode.isoCode6_4_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubIsoCode, hub2.isoCodeRole from hub.hubIsoCode hub2 inner join (select hub1.dwhIdHubContainerType, src.ISO_KODE6_4, src.SELSKAB, src.SrcSystemId from hub.hubContainerType hub1 inner join (SELECT distinct ISO_KODE6_4, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_4 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_4, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_4 IS NOT NULL and IsDeleted = 0) src on hub1.containerTypeCode =  src.KODE and hub1.accessCompanyId =  src.SELSKAB and hub1.srcSystemId =  src.SrcSystemId) srcHub1 on hub2.isoCode = srcHub1.ISO_KODE6_4 and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId and hub2.isoCodeRole ='ISO_KODE6_4')q
lnkContainerTypeIsoCode.isoCode6_5_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubIsoCode, hub2.isoCodeRole from hub.hubIsoCode hub2 inner join (select hub1.dwhIdHubContainerType, src.ISO_KODE6_5, src.SELSKAB, src.SrcSystemId from hub.hubContainerType hub1 inner join (SELECT distinct ISO_KODE6_5, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_5 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_5, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_5 IS NOT NULL and IsDeleted = 0) src on hub1.containerTypeCode =  src.KODE and hub1.accessCompanyId =  src.SELSKAB and hub1.srcSystemId =  src.SrcSystemId) srcHub1 on hub2.isoCode = srcHub1.ISO_KODE6_5 and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId and hub2.isoCodeRole ='ISO_KODE6_5')q
lnkContainerTypeIsoCode.satLnk.CountRows =  select count (*) c from sat.satLnkContainerTypeIsoCode

lnkIsoCodeCompany.lnk.CountRows =  select count (*) c from lin.lnkIsoCodeCompany
lnkIsoCodeCompany.isoCode4_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubIsoCode, hub2.dwhIdHubCompany, srcHub1.isoCodeRole from hub.hubCompany hub2 inner join (select  hub1.dwhIdHubIsoCode, hub1.isoCodeRole, src.SELSKAB, src.srcSystemId, src.ISO_KODE4 from hub.hubIsoCode hub1 inner join (SELECT distinct ISO_KODE4, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE4 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE4, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE4 IS NOT NULL and IsDeleted = 0 ) src on hub1.isoCode = src.ISO_KODE4 and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.SrcSystemId and hub1.isoCodeRole ='ISO_KODE4') srcHub1 on hub2.CompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkIsoCodeCompany.isoCode6_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubIsoCode, hub2.dwhIdHubCompany, srcHub1.isoCodeRole from hub.hubCompany hub2 inner join (select  hub1.dwhIdHubIsoCode, hub1.isoCodeRole, src.SELSKAB, src.srcSystemId, src.ISO_KODE6 from hub.hubIsoCode hub1 inner join (SELECT distinct ISO_KODE6, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6 IS NOT NULL and IsDeleted = 0 ) src on hub1.isoCode = src.ISO_KODE6 and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.SrcSystemId and hub1.isoCodeRole ='ISO_KODE6') srcHub1 on hub2.CompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkIsoCodeCompany.isoCode6_2_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubIsoCode, hub2.dwhIdHubCompany, srcHub1.isoCodeRole from hub.hubCompany hub2 inner join (select  hub1.dwhIdHubIsoCode, hub1.isoCodeRole, src.SELSKAB, src.srcSystemId, src.ISO_KODE6_2 from hub.hubIsoCode hub1 inner join (SELECT distinct ISO_KODE6_2, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_2 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_2, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_2 IS NOT NULL and IsDeleted = 0 ) src on hub1.isoCode = src.ISO_KODE6_2 and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.SrcSystemId and hub1.isoCodeRole ='ISO_KODE6_2') srcHub1 on hub2.CompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkIsoCodeCompany.isoCode6_3_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubIsoCode, hub2.dwhIdHubCompany, srcHub1.isoCodeRole from hub.hubCompany hub2 inner join (select  hub1.dwhIdHubIsoCode, hub1.isoCodeRole, src.SELSKAB, src.srcSystemId, src.ISO_KODE6_3 from hub.hubIsoCode hub1 inner join (SELECT distinct ISO_KODE6_3, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_3 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_3, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_3 IS NOT NULL and IsDeleted = 0 ) src on hub1.isoCode = src.ISO_KODE6_3 and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.SrcSystemId and hub1.isoCodeRole ='ISO_KODE6_3') srcHub1 on hub2.CompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkIsoCodeCompany.isoCode6_4_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubIsoCode, hub2.dwhIdHubCompany, srcHub1.isoCodeRole from hub.hubCompany hub2 inner join (select  hub1.dwhIdHubIsoCode, hub1.isoCodeRole, src.SELSKAB, src.srcSystemId, src.ISO_KODE6_4 from hub.hubIsoCode hub1 inner join (SELECT distinct ISO_KODE6_4, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_4 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_4, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_4 IS NOT NULL and IsDeleted = 0 ) src on hub1.isoCode = src.ISO_KODE6_4 and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.SrcSystemId and hub1.isoCodeRole ='ISO_KODE6_4') srcHub1 on hub2.CompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkIsoCodeCompany.isoCode6_5_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubIsoCode, hub2.dwhIdHubCompany, srcHub1.isoCodeRole from hub.hubCompany hub2 inner join (select  hub1.dwhIdHubIsoCode, hub1.isoCodeRole, src.SELSKAB, src.srcSystemId, src.ISO_KODE6_5 from hub.hubIsoCode hub1 inner join (SELECT distinct ISO_KODE6_5, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_5 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_5, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_5 IS NOT NULL and IsDeleted = 0 ) src on hub1.isoCode = src.ISO_KODE6_5 and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.SrcSystemId and hub1.isoCodeRole ='ISO_KODE6_5') srcHub1 on hub2.CompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId)q

lnkContainerTypeCompany.lnk.CountRows =  select count (*) c from lin.lnkContainerTypeCompany
lnkContainerTypeCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubContainerType, src.SELSKAB, src.SrcSystemId from hub.hubContainerType hub1 inner join (select KODE, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_ContType where isDeleted = 0 union select KODE, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_ContType where isDeleted = 0) src on hub1.containerTypeCode = src.KODE and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkOceanVesselServiceCompany.lnk.CountRows =  select count (*) c from lin.lnkOceanVesselServiceCompany
lnkOceanVesselServiceCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubOceanVesselService, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubOceanVesselService, src.SELSKAB, src.SrcSystemId from hub.hubOceanVesselService hub1 inner join (select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_EdiKonv where isDeleted = 0 union select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_EdiKonv where isDeleted = 0) src on hub1.carrierCode = src.AGENT and hub1.serviceCode = src.FELT and hub1.shortName = src.FRA and hub1.fullName = src.TIL and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkImsChargeLinesCompany.lnk.CountRows =  select count (*) c from lin.lnkImsChargeLinesCompany
lnkImsChargeLinesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubImsChargeLines, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubImsChargeLines, src.SELSKAB, src.SrcSystemId from hub.hubImsChargeLines hub1 inner join (select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_EdiKonv where isDeleted = 0 union  select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_EdiKonv where isDeleted = 0) src on hub1.carrierCode = src.AGENT and hub1.imsCode = src.FELT and hub1.xmlTag  = src.FRA and hub1.chargeLineNr = src.TIL and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkSpecialContractTypesCompany.lnk.CountRows =  select count (*) c from lin.lnkSpecialContractTypesCompany
lnkSpecialContractTypesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubSpecialContractTypes, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubSpecialContractTypes, src.SELSKAB, src.SrcSystemId from hub.hubSpecialContractTypes hub1 inner join (select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_EdiKonv where isDeleted = 0 union select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_EdiKonv where isDeleted = 0) src on hub1.carrierCode = src.AGENT and hub1.dtxCode = src.FELT and hub1.segmentCode   = src.FRA and hub1.contractTypeCode = src.TIL and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkSublocationCompany.lnk.CountRows =  select count (*) c from lin.lnkSublocationCompany
lnkSublocationCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubSublocation, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubSublocation, src.SELSKAB, src.SrcSystemId from hub.hubSublocation hub1 inner join (select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_EdiKonv where isDeleted = 0 union  select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_EdiKonv where isDeleted = 0) src on hub1.carrierCode = src.AGENT and hub1.dtxCode = src.FELT and hub1.segmentCode   = src.FRA and hub1.sublocationCode = src.TIL and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkTransportModeCompany.lnk.CountRows =  select count (*) c from lin.lnkTransportModeCompany
lnkTransportModeCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubTransportMode, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubTransportMode, src.SELSKAB, src.SrcSystemId from hub.hubTransportMode hub1 inner join (select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_EdiKonv where isDeleted = 0 union  select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_EdiKonv where isDeleted = 0) src on hub1.carrierCode = src.AGENT and hub1.dtxCode = src.FELT and hub1.segmentCode   = src.FRA and hub1.transportModeCode = src.TIL and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkCorrectorRemarkTypesCompany.lnk.CountRows =  select count (*) c from lin.lnkCorrectorRemarkTypesCompany
lnkCorrectorRemarkTypesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubCorrectorRemarkTypes, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubCorrectorRemarkTypes, src.SELSKAB, src.SrcSystemId from hub.hubCorrectorRemarkTypes hub1 inner join (select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_EdiKonv where isDeleted = 0 union select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_EdiKonv where isDeleted = 0) src on hub1.carrierCode = src.AGENT and hub1.dtxCode = src.FELT and hub1.segmentCode   = src.FRA and hub1.remarkCode = src.TIL and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkExportVesselsLocations.lnk.CountRows =  select count (*) c from lin.lnkExportVesselsLocations
lnkExportVesselsLocations.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubExportVessels, hub2.dwhIdHubLocations, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubExportVessels, src.SELSKAB, src.SrcSystemId, src.TS_PORT from hub.hubExportVessels hub1 inner join (select EXP_VESSEL_ID, SELSKAB, SrcSystemId, TS_PORT from StagingAreaTest.stg.MSCRUS_ExpVessels where isDeleted = 0 and TS_PORT is not null union select EXP_VESSEL_ID, SELSKAB, SrcSystemId, TS_PORT from StagingAreaTest.stg.UNITY_ExpVessels where isDeleted = 0 and TS_PORT is not null) src on  hub1.expVesselId = src.EXP_VESSEL_ID and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.TS_PORT and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubExportVessels, hub2.dwhIdHubLocations, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubExportVessels, src.SELSKAB, src.SrcSystemId, src.TS_PORT from hub.hubExportVessels hub1 inner join (select EXP_VESSEL_ID, SELSKAB, SrcSystemId, TS_PORT from StagingAreaTest.stg.MSCRUS_ExpVessels where isDeleted = 0 and TS_PORT is null union select EXP_VESSEL_ID, SELSKAB, SrcSystemId, TS_PORT from StagingAreaTest.stg.UNITY_ExpVessels where isDeleted = 0 and TS_PORT is null) src on  hub1.expVesselId = src.EXP_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and  hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkExportVesselsLocations.satLnk.CountRows = select count (*) c from sat.satLnkExportVesselsLocations

lnkExportVesselsOceanVesselService.lnk.CountRows =  select count (*) c from lin.lnkExportVesselsOceanVesselService
lnkExportVesselsOceanVesselService.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubExportVessels, hub2.dwhIdHubOceanVesselService, srcHub1.SrcSystemId from  hub.hubOceanVesselService hub2 inner join (select hub1.dwhIdHubExportVessels, src.SELSKAB, src.SrcSystemId, src.SERV_DIR from hub.hubExportVessels hub1 inner join (select EXP_VESSEL_ID, SELSKAB, SrcSystemId, SERV_DIR from StagingAreaTest.stg.MSCRUS_ExpVessels where isDeleted = 0 and SERV_DIR is not null union select EXP_VESSEL_ID, SELSKAB, SrcSystemId, SERV_DIR from StagingAreaTest.stg.UNITY_ExpVessels where isDeleted = 0 and SERV_DIR is not null) src on  hub1.expVesselId = src.EXP_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.shortName = srcHub1.SERV_DIR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubExportVessels, hub2.dwhIdHubOceanVesselService, srcHub1.SrcSystemId from  hub.hubOceanVesselService hub2 inner join (select hub1.dwhIdHubExportVessels, src.SELSKAB, src.SrcSystemId, src.SERV_DIR from hub.hubExportVessels hub1 inner join (select EXP_VESSEL_ID, SELSKAB, SrcSystemId, SERV_DIR from StagingAreaTest.stg.MSCRUS_ExpVessels where isDeleted = 0 and SERV_DIR is null union select EXP_VESSEL_ID, SELSKAB, SrcSystemId, SERV_DIR from StagingAreaTest.stg.UNITY_ExpVessels where isDeleted = 0 and SERV_DIR is null) src on hub1.expVesselId = src.EXP_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubOceanVesselService = -1 and  hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkExportVesselsOceanVesselService.satLnk.CountRows = select count (*) c from sat.satLnkExportVesselsOceanVesselService

lnkExportVesselsVesselRegistry.lnk.CountRows =  select count (*) c from lin.lnkExportVesselsVesselRegistry
lnkExportVesselsVesselRegistry.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubExportVessels, hub2.dwhIdHubVesselRegistry, srcHub1.SrcSystemId from  hub.hubVesselRegistry hub2 inner join (select hub1.dwhIdHubExportVessels, src.SELSKAB, src.SrcSystemId, src.VESSEL_CODE from hub.hubExportVessels hub1 inner join (select EXP_VESSEL_ID, SELSKAB, SrcSystemId, VESSEL_CODE from StagingAreaTest.stg.MSCRUS_ExpVessels where isDeleted = 0 and VESSEL_CODE is not null union select EXP_VESSEL_ID, SELSKAB, SrcSystemId, VESSEL_CODE from StagingAreaTest.stg.UNITY_ExpVessels where isDeleted = 0 and VESSEL_CODE is not null) src on hub1.expVesselId = src.EXP_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.feederCode = srcHub1.VESSEL_CODE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct sat2hub1.dwhIdHubExportVessels, hub2.dwhIdHubVesselRegistry, sat2hub1.SrcSystemId from  hub.hubVesselRegistry hub2 inner join (select sat2.dwhIdhubVesselRegistry, srcHub1.dwhIdHubExportVessels, srcHub1.SELSKAB, srcHub1.SrcSystemId from sat.satVesselRegistry sat2 inner join (select hub1.dwhIdHubExportVessels, src.SELSKAB, src.SrcSystemId, src.VESSEL_NAME from hub.hubExportVessels hub1 inner join (select EXP_VESSEL_ID, SELSKAB, SrcSystemId, VESSEL_NAME from StagingAreaTest.stg.MSCRUS_ExpVessels where isDeleted = 0 and VESSEL_CODE is null union select EXP_VESSEL_ID, SELSKAB, SrcSystemId, VESSEL_NAME from StagingAreaTest.stg.UNITY_ExpVessels where isDeleted = 0 and VESSEL_CODE is null) src on hub1.expVesselId = src.EXP_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on srcHub1.VESSEL_NAME = sat2.vesselName and srcHub1.SrcSystemId = sat2.srcSystemId)sat2hub1 on sat2hub1.dwhIdHubVesselRegistry = hub2.dwhIdHubVesselRegistry and sat2hub1.SELSKAB = hub2.accessCompanyId and sat2hub1.srcSystemId = hub2.srcSystemId)q
lnkExportVesselsVesselRegistry.satLnk.CountRows = select count (*) c from sat.satLnkExportVesselsVesselRegistry

lnkExportVesselsCompany.lnk.CountRows =  select count (*) c from lin.lnkExportVesselsCompany
lnkExportVesselsCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubExportVessels, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubExportVessels, src.SELSKAB, src.SrcSystemId from hub.hubExportVessels hub1 inner join (select EXP_VESSEL_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_ExpVessels where isDeleted = 0  union select EXP_VESSEL_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_ExpVessels where isDeleted = 0) src on  hub1.expVesselId = src.EXP_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkInvoicePostingAccountingTransaction.lnk.CountRows =  select count (*) c from lin.lnkInvoicePostingAccountingTransaction
lnkInvoicePostingAccountingTransaction.condition.CountRows = select count (*) c from (select satAT.dwhIdhubAccountingTransaction, hubAt1.dwhIdhubInvoicePosting from sat.satAccountingTransaction satAT inner join (select hubAT.dwhIdhubAccountingTransaction, hubIP1.dwhIdhubInvoicePosting, hubIP1.DAGBOG, hubIP1.SELSKAB, hubIP1.SrcSystemId  from hub.hubAccountingTransaction hubAT inner join (select hubIP.dwhIdhubInvoicePosting, src.BILAGSNR, src.DAGBOG, src.SELSKAB, src.SrcSystemId from hub.hubInvoicePosting hubIP inner join (select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId, BILAGSNR, DAGBOG from  StagingAreaTest.stg.MSCRUS_FaktPost  where isDeleted = 0 union select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId, BILAGSNR, DAGBOG from  StagingAreaTest.stg.UNITY_FaktPost  where isDeleted = 0) src on hubIP.invoiceType = src.F_TYPE and hubIP.invoiceNr = src.FAKTURANR and hubIP.debitCredit = src.K_TYPE and hubIP.customerCode = src.KUNDE and hubIP.accessCompanyId = src.SELSKAB and hubIP.srcSystemId = src.srcSystemId) hubIP1 on hubAT.itemNr = hubIP1.BILAGSNR and hubAT.accessCompanyId = hubIP1.SELSKAB and hubAT.srcSystemId = hubIP1.srcSystemId) hubAt1 on satAT.diaryNum = hubAt1.DAGBOG and satAT.dwhIdhubAccountingTransaction = hubAt1.dwhIdhubAccountingTransaction and satAT.srcSystemId = hubAt1.srcSystemId)q
lnkInvoicePostingAccountingTransaction.satLnk.CountRows = select count (*) c from sat.satLnkInvoicePostingAccountingTransaction

lnkInvoicePostingCurrency.lnk.CountRows =  select count (*) c from lin.lnkInvoicePostingCurrency
lnkInvoicePostingCurrency.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubInvoicePosting, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hubIP.dwhIdhubInvoicePosting, src.SELSKAB, src.SrcSystemId, src.VALUTA from hub.hubInvoicePosting hubIP inner join (select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId, VALUTA from  StagingAreaTest.stg.MSCRUS_FaktPost  where isDeleted = 0 and VALUTA is not null union select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId, VALUTA from  StagingAreaTest.stg.UNITY_FaktPost  where isDeleted = 0 and VALUTA is not null) src on hubIP.invoiceType = src.F_TYPE and hubIP.invoiceNr = src.FAKTURANR and hubIP.debitCredit = src.K_TYPE and hubIP.customerCode = src.KUNDE and hubIP.accessCompanyId = src.SELSKAB and hubIP.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.VALUTA and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubInvoicePosting, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hubIP.dwhIdhubInvoicePosting, src.SrcSystemId from hub.hubInvoicePosting hubIP inner join (select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId, VALUTA from  StagingAreaTest.stg.MSCRUS_FaktPost  where isDeleted = 0 and VALUTA is null union select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId, VALUTA from  StagingAreaTest.stg.UNITY_FaktPost  where isDeleted = 0 and VALUTA is null) src on hubIP.invoiceType = src.F_TYPE and hubIP.invoiceNr = src.FAKTURANR and hubIP.debitCredit = src.K_TYPE and hubIP.customerCode = src.KUNDE and hubIP.accessCompanyId = src.SELSKAB and hubIP.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCurrency = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkInvoicePostingCurrency.satLnk.CountRows = select count (*) c from sat.satLnkInvoicePostingCurrency

lnkInvoicePostingCompany.lnk.CountRows =  select count (*) c from lin.lnkInvoicePostingCompany
lnkInvoicePostingCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubInvoicePosting, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hubIP.dwhIdhubInvoicePosting, src.SELSKAB, src.SrcSystemId from hub.hubInvoicePosting hubIP inner join (select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId from  StagingAreaTest.stg.MSCRUS_FaktPost  where isDeleted = 0 union select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId from  StagingAreaTest.stg.UNITY_FaktPost  where isDeleted = 0) src on hubIP.invoiceType = src.F_TYPE and hubIP.invoiceNr = src.FAKTURANR and hubIP.debitCredit = src.K_TYPE and hubIP.customerCode = src.KUNDE and hubIP.accessCompanyId = src.SELSKAB and hubIP.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkLocationsCountry.lnk.CountRows =  select count (*) c from lin.lnkLocationsCountry
lnkLocationsCountry.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubLocations, hub2.dwhIdHubCountry, srcHub1.SrcSystemId from  hub.hubCountry hub2 inner join (select hub1.dwhIdHubLocations, src.SELSKAB, src.SrcSystemId, src.MONT_ENHED from hub.hubLocations hub1 inner join (select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.MSCRUS_Henvis where isDeleted = 0 and ART= 'LO' and LOBE_NR= '1' union select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.UNITY_Henvis where isDeleted = 0 and ART= 'LO' and LOBE_NR= '1') src on hub1.dictionaryType = src.ART and hub1.locationCode = src.KODE and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.countryCode = srcHub1.MONT_ENHED and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkLocationsCountry.satLnk.CountRows = select count (*) c from sat.satLnkLocationsCountry

lnkLocationsLocationsPortsOverview.lnk.CountRows =  select count (*) c from lin.lnkLocationsLocationsPortsOverview
lnkLocationsLocationsPortsOverview.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubLocations, hub2.dwhIdHubLocationsPortsOverview, srcHub1.SrcSystemId from  hub.hubLocationsPortsOverview hub2 inner join (select hub1.dwhIdHubLocations, src.SELSKAB, src.SrcSystemId, src.KODE from hub.hubLocations hub1 inner join (select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Henvis where isDeleted = 0 and ART= 'LO' and LOBE_NR= '1' union select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Henvis where isDeleted = 0 and ART= 'LO' and LOBE_NR= '1') src on hub1.dictionaryType = src.ART and hub1.locationCode = src.KODE and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.KODE)q
lnkLocationsLocationsPortsOverview.satLnk.CountRows = select count (*) c from sat.satLnkLocationsLocationsPortsOverview
lnkLocationsLocationsPortsOverview.error.CountRows =  select count (*) c from (select packageName, srcTablename, ErrorDate, description, SELSKAB from DataVaultTest.etl.errLogLnkDataVault where packageName like '%lnkLocationsLocationsPortsOverview%')q

lnkCountryCompany.lnk.CountRows =  select count (*) c from lin.lnkCountryCompany
lnkCountryCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubCountry, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubCountry, src.SELSKAB, src.SrcSystemId, src.KODE from hub.hubCountry hub1 inner join (select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Henvis where isDeleted = 0 and ART= 'LA' and LOBE_NR= '1' union select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Henvis where isDeleted = 0 and ART= 'LA' and LOBE_NR= '1') src on hub1.dictionaryType = src.ART and hub1.countryCode = src.KODE and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkLocationsCompany.lnk.CountRows =  select count (*) c from lin.lnkLocationsCompany
lnkLocationsCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubLocations, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubLocations, src.SELSKAB, src.SrcSystemId, src.KODE from hub.hubLocations hub1 inner join (select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Henvis where isDeleted = 0 and ART= 'LO' and LOBE_NR= '1' union select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Henvis where isDeleted = 0 and ART= 'LO' and LOBE_NR= '1') src on hub1.dictionaryType = src.ART and hub1.locationCode = src.KODE and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkContainerLocationCompany.lnk.CountRows =  select count (*) c from lin.lnkContainerLocationCompany
lnkContainerLocationCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerLocation, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubContainerLocation, src.SELSKAB, src.SrcSystemId, src.KODE from hub.hubContainerLocation hub1 inner join (select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Henvis where isDeleted = 0 and ART= 'CL' and LOBE_NR= '1' union select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Henvis where isDeleted = 0 and ART= 'CL' and LOBE_NR= '1') src on hub1.dictionaryType = src.ART and hub1.containerLocationCode = src.KODE and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkVesselRegistryCompany.lnk.CountRows =  select count (*) c from lin.lnkVesselRegistryCompany
lnkVesselRegistryCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubVesselRegistry, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubVesselRegistry, src.SELSKAB, src.SrcSystemId, src.KODE from hub.hubVesselRegistry hub1 inner join (select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Henvis where isDeleted = 0 and ART= 'FE' and LOBE_NR= '1' union select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Henvis where isDeleted = 0 and ART= 'FE' and LOBE_NR= '1') src on hub1.dictionaryType = src.ART and hub1.feederCode = src.KODE and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkCurrencyCompany.lnk.CountRows =  select count (*) c from lin.lnkCurrencyCompany
lnkCurrencyCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubCurrency, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubCurrency, src.SELSKAB, src.SrcSystemId, src.KODE from hub.hubCurrency hub1 inner join (select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Henvis where isDeleted = 0 and ART= 'VA' and LOBE_NR= '1' union select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Henvis where isDeleted = 0 and ART= 'VA' and LOBE_NR= '1') src on hub1.dictionaryType = src.ART and hub1.currencyCode = src.KODE and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkCustomersLocations.lnk.CountRows =  select count (*) c from lin.lnkCustomersLocations
lnkCustomersLocations.satLnk.CountRows = select count (*) c from sat.satLnkCustomersLocations
lnkCustomersLocations_Kunde.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubCustomers, src.CITY_CODE, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hub1 inner join (select distinct KUNDENR, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.MSCRUS_Kunde where isDeleted = 0 and CITY_CODE is not null union select distinct KUNDENR, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.UNITY_Kunde where isDeleted = 0 and CITY_CODE is not null) src on hub1.customerNr =  src.KUNDENR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.CITY_CODE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubCustomers, src.CITY_CODE, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hub1 inner join (select distinct KUNDENR, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.MSCRUS_Kunde where isDeleted = 0 and CITY_CODE is  null union select distinct KUNDENR, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.UNITY_Kunde where isDeleted = 0 and CITY_CODE is  null) src on hub1.customerNr =  src.KUNDENR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkCustomersLocations_Adresse.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubCustomers, src.CITY_CODE, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hub1 inner join (select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.MSCRUS_Adresse where isDeleted = 0 and CITY_CODE is not null union select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.UNITY_Adresse where isDeleted = 0 and CITY_CODE is not null) src on hub1.number =  src.NR and hub1.bookingNumber =  src.REF_NR and hub1.refType = src.REF_TYPE and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId) srcHub1 on hub2.locationCode = srcHub1.CITY_CODE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubCustomers, src.CITY_CODE, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hub1 inner join (select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.MSCRUS_Adresse where isDeleted = 0 and CITY_CODE is  null union select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.UNITY_Adresse where isDeleted = 0 and CITY_CODE is  null ) src on hub1.number =  src.NR and hub1.bookingNumber =  src.REF_NR and hub1.refType = src.REF_TYPE and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q

lnkInvoiceBooking.lnk.CountRows =  select count (*) c from lin.lnkInvoiceBooking
lnkInvoiceBooking.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.REG_NR from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId, REG_NR from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 and REG_NR is not null union select ORDRE_NR, SELSKAB, SrcSystemId, REG_NR from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0 and REG_NR is not null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.REG_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId) union (select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.REG_NR from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId, REG_NR from StagingAreaTest.stg.MSCRUS_Ordre where REG_NR is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select ORDRE_NR, SELSKAB, SrcSystemId, REG_NR from StagingAreaTest.stg.UNITY_Ordre where REG_NR is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.REG_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q
lnkInvoiceBooking.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceBooking

lnkInvoiceBookingCharges.lnk.CountRows = select count (*) c from lin.lnkInvoiceBookingCharges
lnkInvoiceBookingCharges.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCharges, hub2.dwhIdhubInvoice, srcHub1.SrcSystemId from  sat.satInvoice sat2 inner join (select hub1.dwhIdHubBookingCharges, src.SELSKAB, src.SrcSystemId, src.BOOK_NR, src.FRG_BT_NR from hub.hubBookingCharges hub1 inner join (select BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookFak where isDeleted = 0 and BOOK_NR is not null and FRG_BT_NR is not null union select BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookFak where isDeleted = 0 and BOOK_NR is not null and FRG_BT_NR is not null) src on hub1.bookingNr = src.BOOK_NR and hub1.positionNr = src.FRG_BT_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on sat2.bookingNr = srcHub1.BOOK_NR and sat2.positionNr = srcHub1.FRG_BT_NR and sat2.srcSystemId = srcHub1.SrcSystemId inner join hub.hubInvoice hub2 on hub2.dwhIdhubInvoice = sat2.dwhIdhubInvoice and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkInvoiceBookingCharges.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceBookingCharges

lnkInvoiceCurrency.lnk.CountRows =  select count (*) c from lin.lnkInvoiceCurrency
lnkInvoiceCurrency.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.VALUTAKODE from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 and VALUTAKODE is not null union select ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0 and VALUTAKODE is not null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.VALUTAKODE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.VALUTAKODE from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 and VALUTAKODE is null union select ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0 and VALUTAKODE is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCurrency = -1 and  hub2.accessCompanyId =  -1 and  hub2.srcSystemId = 0) union (select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.VALUTAKODE from hub.hubInvoice hub1 inner join (select  ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.MSCRUS_Ordre where VALUTAKODE is not null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.UNITY_Ordre where  VALUTAKODE is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.VALUTAKODE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.VALUTAKODE from hub.hubInvoice hub1 inner join (select  ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.MSCRUS_Ordre where VALUTAKODE is null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.UNITY_Ordre where  VALUTAKODE is null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCurrency = -1 and  hub2.accessCompanyId =  -1 and  hub2.srcSystemId = 0))q
lnkInvoiceCurrency.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceCurrency

lnkInvoiceCustomers.lnk.CountRows =  select count (*) c from lin.lnkInvoiceCustomers
lnkInvoiceCustomers.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCustomers hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.KUNDE from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 and KUNDE is not null union select ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0 and KUNDE is not null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.customerNr = srcHub1.KUNDE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCustomers hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.KUNDE from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 and KUNDE is null union select ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0 and KUNDE is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCustomers = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0) union (select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCustomers hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.KUNDE from hub.hubInvoice hub1 inner join (select  ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.MSCRUS_Ordre where KUNDE is not null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.UNITY_Ordre where KUNDE is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.customerNr = srcHub1.KUNDE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCustomers hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.KUNDE from hub.hubInvoice hub1 inner join (select  ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.MSCRUS_Ordre where KUNDE is null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.UNITY_Ordre where KUNDE is null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCustomers = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0))q
lnkInvoiceCustomers.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceCustomers

lnkInvoiceInvoice.lnk.CountRows =  select count (*) c from lin.lnkInvoiceInvoice
lnkInvoiceInvoice.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubInvoice as dwhIdHubInvoice1, hub2.dwhIdHubInvoice as dwhIdHubInvoice2, srcHub1.SrcSystemId from  hub.hubInvoice hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.REL_TO_ORDRE_NR from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId, REL_TO_ORDRE_NR from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 union select ORDRE_NR, SELSKAB, SrcSystemId, REL_TO_ORDRE_NR from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.orderNr = srcHub1.REL_TO_ORDRE_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId) union (select distinct srcHub1.dwhIdHubInvoice as dwhIdHubInvoice1, hub2.dwhIdHubInvoice as dwhIdHubInvoice2, srcHub1.SrcSystemId from  hub.hubInvoice hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.REL_TO_ORDRE_NR from hub.hubInvoice hub1 inner join (select  ORDRE_NR, SELSKAB, SrcSystemId, REL_TO_ORDRE_NR from StagingAreaTest.stg.MSCRUS_Ordre where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  ORDRE_NR, SELSKAB, SrcSystemId, REL_TO_ORDRE_NR from StagingAreaTest.stg.UNITY_Ordre where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.orderNr = srcHub1.REL_TO_ORDRE_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q
lnkInvoiceInvoice.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceInvoice

lnkInvoiceInvoiceLines.lnk.CountRows =  select count (*) c from lin.lnkInvoiceInvoiceLines
lnkInvoiceInvoiceLines.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubInvoiceLines, srcHub1.SrcSystemId from  hub.hubInvoiceLines hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.ORDRE_NR from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 union select ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.orderNr = srcHub1.ORDRE_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)union (select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubInvoiceLines, srcHub1.SrcSystemId from  hub.hubInvoiceLines hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.ORDRE_NR from hub.hubInvoice hub1 inner join (select  ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Ordre where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Ordre where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.orderNr = srcHub1.ORDRE_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q
lnkInvoiceInvoiceLines.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceInvoiceLines
lnkInvoiceInvoiceLines.error.CountRows = select count (*) c from (select packageName, srcTablename, ErrorDate, description, ORDRE_NR, SELSKAB from DataVaultTest.etl.errLogLnkDataVault where packageName like '%lnkInvoiceInvoiceLines%')q

lnkInvoiceInvoicePosting.lnk.CountRows = select count (*) c from lin.lnkInvoiceInvoicePosting
lnkInvoiceInvoicePosting.condition.CountRows = select COUNT (*) c from (select hub2.dwhIdhubInvoice, hub1sat1.dwhIdhubInvoicePosting from hub.hubInvoice hub2 inner join (select sat.dwhIdHubInvoice, hub1sat.dwhIdHubInvoicePosting, hub1sat.BILAGSNR, hub1sat.SELSKAB, hub1sat.srcSystemId from sat.satInvoice sat inner join (select hub1.dwhIdHubInvoicePosting, src.BILAGSNR, src.SELSKAB, src.srcSystemId from hub.hubInvoicePosting hub1 inner join (select F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, srcSystemId, BILAGSNR from StagingAreaTest.stg.UNITY_FaktPost where isDeleted=0 and BILAGSNR is not null union select F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, srcSystemId, BILAGSNR from StagingAreaTest.stg.MSCRUS_FaktPost where isDeleted=0 and BILAGSNR is not null) src on hub1.invoiceType = src.F_TYPE and hub1.invoiceNr = src.FAKTURANR and hub1.debitCredit = src.K_TYPE and hub1.customerCode = src.KUNDE and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId) hub1sat on sat.invoiceNr = hub1sat.BILAGSNR and sat.srcSystemId = hub1sat.SrcSystemId) hub1sat1 on hub2.dwhIdhubInvoice = hub1sat1.dwhIdHubInvoice and hub2.accessCompanyId = hub1sat1.SELSKAB and hub2.srcSystemId = hub1sat1.SrcSystemId)q
lnkInvoiceInvoicePosting.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceInvoicePosting

lnkInvoiceCompany.lnk.CountRows =  select count (*) c from lin.lnkInvoiceCompany
lnkInvoiceCompany.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 union select ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)union (select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId from hub.hubInvoice hub1 inner join (select  ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Ordre where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Ordre where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q


lnkInvoiceLinesCurrency.lnk.CountRows =  select count (*) c from lin.lnkInvoiceLinesCurrency
lnkInvoiceLinesCurrency.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubInvoiceLines, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubInvoiceLines, src.SELSKAB, src.SrcSystemId, src.OMR_VALUTA from hub.hubInvoiceLines hub1 inner join (select LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId, OMR_VALUTA from StagingAreaTest.stg.MSCRUS_OrdreLin where isDeleted = 0 and OMR_VALUTA is not null union select LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId, OMR_VALUTA from StagingAreaTest.stg.UNITY_OrdreLin where isDeleted = 0 and OMR_VALUTA is not null) src on hub1.invoiceLineNr = src.LINIE_NR and hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.OMR_VALUTA and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkInvoiceLinesCurrency.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceLinesCurrency

lnkInvoiceLinesCompany.lnk.CountRows =  select count (*) c from lin.lnkInvoiceLinesCompany
lnkInvoiceLinesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubInvoiceLines, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubInvoiceLines, src.SELSKAB, src.SrcSystemId from hub.hubInvoiceLines hub1 inner join (select LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_OrdreLin where isDeleted = 0 union select LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_OrdreLin where isDeleted = 0) src on hub1.invoiceLineNr = src.LINIE_NR and hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkFileLinerFileROE.lnk.CountRows =  select count (*) c from lin.lnkFileLinerFileROE
lnkFileLinerFileROE.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubFileLiner, hub2.dwhIdHubFileROE, srcHub1.SrcSystemId from  hub.hubFileROE hub2 inner join (select hub1.dwhIdHubFileLiner, src.SELSKAB, src.SrcSystemId, src.AFDELING, src.SAGSNR from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Sag where isDeleted = 0 union select AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Sag where isDeleted = 0) src on hub1.serviceCode = src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.serviceCode = srcHub1.AFDELING and hub2.fileLinerNr = srcHub1.SAGSNR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId) union (select distinct srcHub1.dwhIdHubFileLiner, hub2.dwhIdHubFileROE, srcHub1.SrcSystemId from  hub.hubFileROE hub2 inner join (select hub1.dwhIdHubFileLiner, src.SELSKAB, src.SrcSystemId, src.AFDELING, src.SAGSNR from hub.hubFileLiner hub1 inner join (select  AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Sag where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Sag where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.serviceCode = src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.serviceCode = srcHub1.AFDELING and hub2.fileLinerNr = srcHub1.SAGSNR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q
lnkFileLinerFileROE.satLnk.CountRows = select count (*) c from sat.satLnkFileLinerFileROE

lnkFileLinerLocations.lnk.CountRows =  select count (*) c from lin.lnkFileLinerLocations
lnkFileLinerLocations_EXP.condition.CountRows = select count (*) c from ((select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.IMP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId, IMP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where isDeleted = 0 and IMP_AFG_ZONE is not null and EXP_AFG_ZONE is null union  select AFDELING, SAGSNR, SELSKAB, SrcSystemId, IMP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where isDeleted = 0 and IMP_AFG_ZONE is not null and EXP_AFG_ZONE is null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.IMP_AFG_ZONE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.IMP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId, IMP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where isDeleted = 0 and IMP_AFG_ZONE is null and EXP_AFG_ZONE is not null union select AFDELING, SAGSNR, SELSKAB, SrcSystemId, IMP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where isDeleted = 0 and IMP_AFG_ZONE is null and EXP_AFG_ZONE is not null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on  hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0) union (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.IMP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select distinct AFDELING, SAGSNR, SELSKAB, SrcSystemId, IMP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where IMP_AFG_ZONE is not null and EXP_AFG_ZONE is null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union  select distinct AFDELING, SAGSNR, SELSKAB, SrcSystemId,IMP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where IMP_AFG_ZONE is not null and EXP_AFG_ZONE is null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.IMP_AFG_ZONE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.IMP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select distinct AFDELING, SAGSNR, SELSKAB, SrcSystemId, IMP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where IMP_AFG_ZONE is null and EXP_AFG_ZONE is not null  and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select distinct AFDELING, SAGSNR, SELSKAB, SrcSystemId,IMP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where IMP_AFG_ZONE is null and EXP_AFG_ZONE is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on  hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0))q
lnkFileLinerLocations_IMP.condition.CountRows = select count (*) c from ((select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.EXP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where isDeleted = 0 and EXP_AFG_ZONE is not null  and IMP_AFG_ZONE is null union select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where isDeleted = 0 and EXP_AFG_ZONE is not null and IMP_AFG_ZONE is null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.EXP_AFG_ZONE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.EXP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where isDeleted = 0 and EXP_AFG_ZONE is null and IMP_AFG_ZONE is not null union select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where isDeleted = 0 and EXP_AFG_ZONE is null and IMP_AFG_ZONE is not null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0) union (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.EXP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where EXP_AFG_ZONE is not null  and IMP_AFG_ZONE is null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where  EXP_AFG_ZONE is not null and IMP_AFG_ZONE is null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.EXP_AFG_ZONE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.EXP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select  AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE  from StagingAreaTest.stg.MSCRUS_Sag where EXP_AFG_ZONE is null and IMP_AFG_ZONE is not null  and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where EXP_AFG_ZONE is null and IMP_AFG_ZONE is not null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0))q
lnkFileLinerLocations_bothNull.condition.CountRows = select count (*) c from ((select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.EXP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where isDeleted = 0 and EXP_AFG_ZONE is null and IMP_AFG_ZONE is  null union select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where isDeleted = 0 and EXP_AFG_ZONE is null and IMP_AFG_ZONE is  null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0) union (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.EXP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where EXP_AFG_ZONE is null and IMP_AFG_ZONE is  null  and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where EXP_AFG_ZONE is null and IMP_AFG_ZONE is  null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0))q
lnkFileLinerLocations.satLnk.CountRows = select count (*) c from sat.satLnkFileLinerLocations

lnkFileLinerCompany.lnk.CountRows =  select count (*) c from lin.lnkFileLinerCompany
lnkFileLinerCompany.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubFileLiner, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubFileLiner, src.SELSKAB, src.SrcSystemId, src.AFDELING, src.SAGSNR from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Sag where isDeleted = 0 union select AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Sag where isDeleted = 0) src on hub1.serviceCode = src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId) union (select distinct srcHub1.dwhIdHubFileLiner, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubFileLiner, src.SELSKAB, src.SrcSystemId, src.AFDELING, src.SAGSNR from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Sag where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select distinct AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Sag where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.serviceCode = src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q

lnkFileROECompany.lnk.CountRows =  select count (*) c from lin.lnkFileROECompany
lnkFileROECompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubFileROE, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubFileROE, src.SELSKAB, src.SrcSystemId, src.AFDELING, src.SAGSNR from hub.hubFileROE hub1 inner join (select AFDELING, SAGSNR, VALUTA, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_SagKurs where isDeleted = 0  union select AFDELING, SAGSNR, VALUTA, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_SagKurs where isDeleted = 0) src on hub1.serviceCode = src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.currencyCode = src.VALUTA and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkDailyRoeCompany.lnk.CountRows =  select count (*) c from lin.lnkDailyRoeCompany
lnkDailyRoeCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubDailyRoe, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubDailyRoe, src.SELSKAB, src.SrcSystemId from hub.hubDailyRoe hub1 inner join (select DATO, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_ShipKurs where isDeleted = 0  union select DATO, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_ShipKurs where isDeleted = 0) src on hub1.roeDate = src.DATO and hub1.sequenceNr = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

bookingCargoCharges.fct.CountRows = select count (*) c from fct.fctBookingCargoCharges
bookingCargoCharges.fctCondition_InitialLoad.CountRows = select count (*) c from (select  hubComp.dwhIdHubCompany, hubComp1.dwhIdHubBookingCargo, hubComp1.dwhIdHubCurrency, hubComp1.cdcTimestamp, hubComp1.A_PRIS, hubComp1.ANTAL, hubComp1.DISTINCT_BET_KODE, hubComp1.ENHED, hubComp1.FRG_BT_NR, hubComp1.OMR_KURS, hubComp1.TOTAL_BEL, hubComp1.GRUPPE from hub.hubCompany hubComp inner join(select  srcWithHubBC.dwhIdHubBookingCargo , hubCur.dwhIdHubCurrency, srcWithHubBC.SELSKAB, srcWithHubBC.srcSystemId, srcWithHubBC.cdcTimestamp, srcWithHubBC.A_PRIS, srcWithHubBC.ANTAL, srcWithHubBC.DISTINCT_BET_KODE, srcWithHubBC.ENHED, srcWithHubBC.FRG_BT_NR, srcWithHubBC.OMR_KURS, srcWithHubBC.TOTAL_BEL, srcWithHubBC.GRUPPE from hub.hubCurrency hubCur inner join (select hubBC.dwhIdHubBookingCargo as dwhIdHubBookingCargo, src.OMR_VALUTA, src.SELSKAB, src.srcSystemId, src.cdcTimestamp, src.A_PRIS, src.ANTAL, src.DISTINCT_BET_KODE, src.ENHED, src.FRG_BT_NR, src.OMR_KURS, src.TOTAL_BEL, src.GRUPPE from hub.hubBookingCargo hubBC inner join (select  BOOK_NR, VAREPOST_NR, OMR_VALUTA, SELSKAB, srcSystemId, cdcTimestamp,A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, OMR_KURS, TOTAL_BEL, GRUPPE from StagingAreaTest.stg.MSCRUS_getCharges where OMR_VALUTA is not null and cdcTimestamp is null union select  BOOK_NR, VAREPOST_NR, OMR_VALUTA, SELSKAB, srcSystemId, cdcTimestamp,A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, OMR_KURS, TOTAL_BEL, GRUPPE from StagingAreaTest.stg.UNITY_getCharges where OMR_VALUTA is not null and cdcTimestamp is null ) src on hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubCur.currencyCode = srcWithHubBC.OMR_VALUTA and hubCur.accessCompanyId = srcWithHubBC.SELSKAB and hubCur.srcSystemId =srcWithHubBC.srcSystemId) hubComp1 on hubComp1.SELSKAB = hubComp.companyId and hubComp1.srcSystemId = hubComp.srcSystemId union select s.dwhIdHubCompany, s.dwhIdHubBookingCargo, hubCur.dwhIdHubCurrency, s.cdcTimestamp, s.A_PRIS, s.ANTAL, s.DISTINCT_BET_KODE, s.ENHED, s.FRG_BT_NR, s.OMR_KURS, s.TOTAL_BEL, s.GRUPPE from hub.hubCurrency hubCur inner join (select  hubCurCode.dwhIdHubBookingCargo,  hubCurCode.dwhIdHubCompany, hubCurCode.srcSystemId, hubCurCode.companyId, satC.homeCurrencyCode as OMR_VALUTA, hubCurCode.cdcTimestamp, hubCurCode.A_PRIS, hubCurCode.ANTAL, hubCurCode.DISTINCT_BET_KODE, hubCurCode.ENHED, hubCurCode.FRG_BT_NR, hubCurCode.OMR_KURS, hubCurCode.TOTAL_BEL, hubCurCode.GRUPPE from sat.satCompany satC inner join (select  srcWithHubBC.dwhIdHubBookingCargo, hubC.dwhIdHubCompany, hubC.srcSystemId, hubC.companyId, srcWithHubBC.OMR_VALUTA,  srcWithHubBC.cdcTimestamp, srcWithHubBC.A_PRIS, srcWithHubBC.ANTAL, srcWithHubBC.DISTINCT_BET_KODE, srcWithHubBC.ENHED, srcWithHubBC.FRG_BT_NR, srcWithHubBC.OMR_KURS, srcWithHubBC.TOTAL_BEL, srcWithHubBC.GRUPPE from hub.hubCompany hubC inner join (select hubBC.dwhIdHubBookingCargo, src.SELSKAB, src.OMR_VALUTA, src.srcSystemId, src.cdcTimestamp, src.A_PRIS, src.ANTAL, src.DISTINCT_BET_KODE, src.ENHED, src.FRG_BT_NR, src.OMR_KURS, src.TOTAL_BEL, src.GRUPPE from hub.hubBookingCargo hubBC inner join (select  BOOK_NR, VAREPOST_NR, SELSKAB, OMR_VALUTA, srcSystemId, cdcTimestamp, A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, OMR_KURS, TOTAL_BEL, GRUPPE from StagingAreaTest.stg.MSCRUS_getCharges where OMR_VALUTA is null and cdcTimestamp is null union select  BOOK_NR, VAREPOST_NR, SELSKAB, OMR_VALUTA, srcSystemId, cdcTimestamp, A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, OMR_KURS, TOTAL_BEL, GRUPPE from StagingAreaTest.stg.UNITY_getCharges where OMR_VALUTA is null and cdcTimestamp is null) src on  hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubC.companyId = srcWithHubBC.SELSKAB and hubC.srcSystemId = srcWithHubBC.srcSystemId) hubCurCode on satC.dwhIdHubCompany= hubCurCode.dwhIdHubCompany) s on hubCur.currencyCode = s.OMR_VALUTA and hubCur.srcSystemId = s.srcSystemId and hubCur.accessCompanyId =  s.companyId)x
bookingCargoCharges.lnkCondition_Union.CountRows = select count (*) c from(select  distinct srcWithHubBC.dwhIdHubBookingCargo , hubCur.dwhIdHubCurrency, srcWithHubBC.srcSystemId from hub.hubCurrency hubCur inner join (select hubBC.dwhIdHubBookingCargo as dwhIdHubBookingCargo, src.OMR_VALUTA, src.SELSKAB, src.srcSystemId from hub.hubBookingCargo hubBC inner join (select distinct BOOK_NR, VAREPOST_NR, OMR_VALUTA, SELSKAB, srcSystemId from StagingAreaTest.stg.v_getCharges where OMR_VALUTA is not null) src on hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubCur.currencyCode = srcWithHubBC.OMR_VALUTA COLLATE SQL_Latin1_General_CP1_CS_AS and hubCur.accessCompanyId = srcWithHubBC.SELSKAB and hubCur.srcSystemId =srcWithHubBC.srcSystemId union select distinct s.dwhIdHubBookingCargo, hubCur.dwhIdHubCurrency, s.srcSystemId from hub.hubCurrency hubCur inner join (select  hubCurCode.dwhIdHubBookingCargo, satC.homeCurrencyCode, hubCurCode.srcSystemId, hubCurCode.companyId from sat.satCompany satC inner join (select  srcWithHubBC.dwhIdHubBookingCargo, hubC.dwhIdHubCompany as dwhIdHubCompany, hubC.srcSystemId as srcSystemId, hubC.companyId as companyId from hub.hubCompany hubC inner join (select distinct hubBC.dwhIdHubBookingCargo as dwhIdHubBookingCargo, src.SELSKAB, src.srcSystemId from hub.hubBookingCargo hubBC inner join (select distinct BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.v_getCharges where OMR_VALUTA is null) src on hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubC.companyId = srcWithHubBC.SELSKAB and hubC.srcSystemId = srcWithHubBC.srcSystemId) hubCurCode on satC.dwhIdHubCompany= hubCurCode.dwhIdHubCompany) s on hubCur.currencyCode = s.homeCurrencyCode and hubCur.srcSystemId = s.srcSystemId and hubCur.accessCompanyId = s.companyId)x
bookingCargoCharges.satLnk.CountRows = select count (*) c from sat.satLnkBookingCargoCharges
bookingCargoCharges.sat.CountRows = select count (*) c from sat.satBookingCargoCharges
bookingCargoCharges.satCondition_ValutaIsNull.CountRows = select count (*) c from (select s.dwhIdHubBookingCargo, hubCur.dwhIdHubCurrency, s.srcSystemId from hub.hubCurrency hubCur inner join (select  hubCurCode.dwhIdHubBookingCargo, satC.homeCurrencyCode, hubCurCode.srcSystemId, hubCurCode.companyId, hubCurCode.A_PRIS, hubCurCode.ANTAL, hubCurCode.DISTINCT_BET_KODE, hubCurCode.ENHED, hubCurCode.FRG_BT_NR, hubCurCode.GRUPPE, hubCurCode.OMR_KURS, hubCurCode.TOTAL_BEL from sat.satCompany satC inner join (select  srcWithHubBC.dwhIdHubBookingCargo, hubC.dwhIdHubCompany as dwhIdHubCompany, hubC.srcSystemId as srcSystemId, hubC.companyId as companyId, srcWithHubBC.A_PRIS, srcWithHubBC.ANTAL, srcWithHubBC.DISTINCT_BET_KODE, srcWithHubBC.ENHED, srcWithHubBC.FRG_BT_NR, srcWithHubBC.GRUPPE, srcWithHubBC.OMR_KURS, srcWithHubBC.TOTAL_BEL from hub.hubCompany hubC inner join (select hubBC.dwhIdHubBookingCargo as dwhIdHubBookingCargo, src.SELSKAB, src.srcSystemId, src.A_PRIS, src.ANTAL, src.DISTINCT_BET_KODE, src.ENHED, src.FRG_BT_NR, src.GRUPPE, src.OMR_KURS, src.TOTAL_BEL from hub.hubBookingCargo hubBC inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, GRUPPE, OMR_KURS, TOTAL_BEL from StagingAreaTest.stg.v_getCharges where OMR_VALUTA is null) src on hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubC.companyId = srcWithHubBC.SELSKAB and hubC.srcSystemId = srcWithHubBC.srcSystemId) hubCurCode on satC.dwhIdHubCompany= hubCurCode.dwhIdHubCompany) s on hubCur.currencyCode = s.homeCurrencyCode and hubCur.srcSystemId = s.srcSystemId and hubCur.accessCompanyId = s.companyId)n
bookingCargoCharges.satCondition_ValutaIsNotNull.CountRows = select count (*) c from (select  srcWithHubBC.dwhIdHubBookingCargo , hubCur.dwhIdHubCurrency, srcWithHubBC.srcSystemId from hub.hubCurrency hubCur inner join (select  hubBC.dwhIdHubBookingCargo as dwhIdHubBookingCargo, src.OMR_VALUTA, src.SELSKAB, src.srcSystemId, src.A_PRIS, src.ANTAL, src.DISTINCT_BET_KODE, src.ENHED, src.FRG_BT_NR, src.GRUPPE, src.OMR_KURS, src.TOTAL_BEL from hub.hubBookingCargo hubBC inner join (select  BOOK_NR, VAREPOST_NR, OMR_VALUTA, SELSKAB, srcSystemId, A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, GRUPPE, OMR_KURS, TOTAL_BEL from StagingAreaTest.stg.v_getCharges where OMR_VALUTA is not null) src on hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubCur.currencyCode = srcWithHubBC.OMR_VALUTA and hubCur.accessCompanyId = srcWithHubBC.SELSKAB and hubCur.srcSystemId =srcWithHubBC.srcSystemId )q
bookingCargoCharges.satCondition_Union.CountRows = select count (*) c from (select s.dwhIdHubBookingCargo, hubCur.dwhIdHubCurrency, s.srcSystemId from hub.hubCurrency hubCur inner join (select  hubCurCode.dwhIdHubBookingCargo, satC.homeCurrencyCode, hubCurCode.srcSystemId, hubCurCode.companyId, hubCurCode.A_PRIS, hubCurCode.ANTAL, hubCurCode.DISTINCT_BET_KODE, hubCurCode.ENHED, hubCurCode.FRG_BT_NR, hubCurCode.GRUPPE, hubCurCode.OMR_KURS, hubCurCode.TOTAL_BEL from sat.satCompany satC inner join (select  srcWithHubBC.dwhIdHubBookingCargo, hubC.dwhIdHubCompany as dwhIdHubCompany, hubC.srcSystemId as srcSystemId, hubC.companyId as companyId, srcWithHubBC.A_PRIS, srcWithHubBC.ANTAL, srcWithHubBC.DISTINCT_BET_KODE, srcWithHubBC.ENHED, srcWithHubBC.FRG_BT_NR, srcWithHubBC.GRUPPE, srcWithHubBC.OMR_KURS, srcWithHubBC.TOTAL_BEL from hub.hubCompany hubC inner join (select hubBC.dwhIdHubBookingCargo as dwhIdHubBookingCargo, src.SELSKAB, src.srcSystemId, src.A_PRIS, src.ANTAL, src.DISTINCT_BET_KODE, src.ENHED, src.FRG_BT_NR, src.GRUPPE, src.OMR_KURS, src.TOTAL_BEL from hub.hubBookingCargo hubBC inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, GRUPPE, OMR_KURS, TOTAL_BEL from StagingAreaTest.stg.v_getCharges where OMR_VALUTA is null) src on hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubC.companyId = srcWithHubBC.SELSKAB and hubC.srcSystemId = srcWithHubBC.srcSystemId) hubCurCode on satC.dwhIdHubCompany= hubCurCode.dwhIdHubCompany) s on hubCur.currencyCode = s.homeCurrencyCode and hubCur.srcSystemId = s.srcSystemId and hubCur.accessCompanyId = s.companyId union select  srcWithHubBC.dwhIdHubBookingCargo , hubCur.dwhIdHubCurrency, srcWithHubBC.srcSystemId from hub.hubCurrency hubCur inner join (select distinct hubBC.dwhIdHubBookingCargo as dwhIdHubBookingCargo, src.OMR_VALUTA, src.SELSKAB, src.srcSystemId, src.A_PRIS, src.ANTAL, src.DISTINCT_BET_KODE, src.ENHED, src.FRG_BT_NR, src.GRUPPE, src.OMR_KURS, src.TOTAL_BEL from hub.hubBookingCargo hubBC inner join (select  BOOK_NR, VAREPOST_NR, OMR_VALUTA, SELSKAB, srcSystemId, A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, GRUPPE, OMR_KURS, TOTAL_BEL from StagingAreaTest.stg.v_getCharges where OMR_VALUTA is not null) src on hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubCur.currencyCode = srcWithHubBC.OMR_VALUTA and hubCur.accessCompanyId = srcWithHubBC.SELSKAB and hubCur.srcSystemId =srcWithHubBC.srcSystemId)n

lnkShipItConstantsCompany.lnk.CountRows =  select count (*) c from lin.lnkShipItConstantsCompany
lnkShipItConstantsCompany.satCondition.CountRows= select count (*) c from (select distinct srcHub1.dwhIdHubShipItConstants, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubShipItConstants, src.SrcSystemId from hub.hubShipItConstants hub1 inner join (select C_NAME, SrcSystemId from StagingAreaTest.stg.MSCRUS_UtsConstants where isDeleted = 0  union select C_NAME, SrcSystemId from StagingAreaTest.stg.UNITY_UtsConstants where isDeleted = 0) src on hub1.cName = 'CPH_SELSKAB' and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkBookingInternalRemarksCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingInternalRemarksCompany
lnkBookingInternalRemarksCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingInternalRemarks, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingInternalRemarks, src.SELSKAB, src.SrcSystemId from hub.hubBookingInternalRemarks hub1 inner join (select BOOK_NR, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookBemInternal where isDeleted = 0 union select BOOK_NR, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookBemInternal where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.sequenceNr = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkBranchCompany.lnk.CountRows =  select count (*) c from lin.lnkBranchCompany
lnkBranchCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBranch, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBranch, src.SELSKAB, src.SrcSystemId from hub.hubBranch hub1 inner join (select NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Kontor where isDeleted = 0 union select NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Kontor where isDeleted = 0) src on hub1.branchNumber = src.NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkCommodityHsCodesCompany.lnk.CountRows =  select count (*) c from lin.lnkCommodityHsCodesCompany
lnkCommodityHsCodesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubCommodityHsCodes, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubCommodityHsCodes, src.SELSKAB, src.SrcSystemId from hub.hubCommodityHsCodes hub1 inner join (select AFDELING, ITEM_NO,  SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Commodity where isDeleted = 0 union select  AFDELING, ITEM_NO,  SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Commodity where isDeleted = 0) src on hub1.serviceCode = src.AFDELING and hub1.agencyHarmonizedCode = src.ITEM_NO and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkContainerMoveTypesCompany.lnk.CountRows =  select count (*) c from lin.lnkContainerMoveTypesCompany
lnkContainerMoveTypesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerMoveTypes, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubContainerMoveTypes, src.SELSKAB, src.SrcSystemId from hub.hubContainerMoveTypes hub1 inner join (select BEV_TYPE, KODE, LINIE, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_ContBev where isDeleted = 0 union select BEV_TYPE, KODE, LINIE, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_ContBev where isDeleted = 0) src on hub1.moveType = src.BEV_TYPE and hub1.moveTypeCode = src.KODE and hub1.line = src.LINIE and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkContainerStatusEventsGVACompany.lnk.CountRows =  select count (*) c from lin.lnkContainerStatusEventsGVACompany
lnkContainerStatusEventsGVACompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerStatusEventsGVA, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubContainerStatusEventsGVA, src.SELSKAB, src.SrcSystemId from hub.hubContainerStatusEventsGVA hub1 inner join (select REP_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_CtsContEvent where isDeleted = 0 union select REP_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_CtsContEvent where isDeleted = 0) src on hub1.moveId = src.REP_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkContainerStatusEventsGVAFullEmpty.lnk.CountRows =  select count (*) c from lin.lnkContainerStatusEventsGVAFullEmpty
lnkContainerStatusEventsGVAFullEmpty.condition.CountRows =select count (*) c from (select distinct hub2.dwhIdHubFullEmpty, srcHub1.dwhIdHubContainerStatusEventsGVA, srcHub1.SrcSystemId from  hub.hubFullEmpty hub2 inner join (select hub1.dwhIdHubContainerStatusEventsGVA, src.SELSKAB, src.SrcSystemId, src.FULL_EMPTY from hub.hubContainerStatusEventsGVA hub1 inner join (select REP_ID, SELSKAB, SrcSystemId, FULL_EMPTY from StagingAreaTest.stg.MSCRUS_CtsContEvent where isDeleted = 0 and FULL_EMPTY is not null union select REP_ID, SELSKAB, SrcSystemId, FULL_EMPTY from StagingAreaTest.stg.UNITY_CtsContEvent where isDeleted = 0 and FULL_EMPTY is not null) src on hub1.moveId = src.REP_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.fillingStatus = srcHub1.FULL_EMPTY union select distinct hub2.dwhIdHubFullEmpty, srcHub1.dwhIdHubContainerStatusEventsGVA, srcHub1.SrcSystemId from  hub.hubFullEmpty hub2 inner join (select hub1.dwhIdHubContainerStatusEventsGVA, src.SELSKAB, src.SrcSystemId, src.FULL_EMPTY from hub.hubContainerStatusEventsGVA hub1 inner join (select REP_ID, SELSKAB, SrcSystemId, FULL_EMPTY from StagingAreaTest.stg.MSCRUS_CtsContEvent where isDeleted = 0 and FULL_EMPTY is null union select REP_ID, SELSKAB, SrcSystemId, FULL_EMPTY from StagingAreaTest.stg.UNITY_CtsContEvent where isDeleted = 0 and FULL_EMPTY is null) src on hub1.moveId = src.REP_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubFullEmpty = -1)q
lnkContainerStatusEventsGVAFullEmpty.satLnk.CountRows =  select count (*) c from sat.satLnkContainerStatusEventsGVAFullEmpty


lnkContainerStatusEventsGVALocations.lnk.CountRows =  select count (*) c from lin.lnkContainerStatusEventsGVALocations
lnkContainerStatusEventsGVALocations.DEST.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubContainerStatusEventsGVA, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubContainerStatusEventsGVA, src.SELSKAB, src.SrcSystemId, src.DEST from hub.hubContainerStatusEventsGVA hub1 inner join (select REP_ID, SELSKAB, SrcSystemId, DEST from StagingAreaTest.stg.MSCRUS_CtsContEvent where isDeleted = 0 and DEST is not null union select REP_ID, SELSKAB, SrcSystemId, DEST from StagingAreaTest.stg.UNITY_CtsContEvent where isDeleted = 0 and DEST is not null) src on hub1.moveId = src.REP_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.DEST and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubContainerStatusEventsGVA, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubContainerStatusEventsGVA, src.SELSKAB, src.SrcSystemId, src.DEST from hub.hubContainerStatusEventsGVA hub1 inner join (select REP_ID, SELSKAB, SrcSystemId, DEST from StagingAreaTest.stg.MSCRUS_CtsContEvent where isDeleted = 0 and DEST is null union select REP_ID, SELSKAB, SrcSystemId, DEST from StagingAreaTest.stg.UNITY_CtsContEvent where isDeleted = 0 and DEST is null) src on hub1.moveId = src.REP_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1)q
lnkContainerStatusEventsGVALocations.EVENT_LOC.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubContainerStatusEventsGVA, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubContainerStatusEventsGVA, src.SELSKAB, src.SrcSystemId, src.EVENT_LOC from hub.hubContainerStatusEventsGVA hub1 inner join (select REP_ID, SELSKAB, SrcSystemId, EVENT_LOC from StagingAreaTest.stg.MSCRUS_CtsContEvent where isDeleted = 0 and EVENT_LOC is not null union select REP_ID, SELSKAB, SrcSystemId, EVENT_LOC from StagingAreaTest.stg.UNITY_CtsContEvent where isDeleted = 0 and EVENT_LOC is not null) src on hub1.moveId = src.REP_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.EVENT_LOC and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubContainerStatusEventsGVA, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubContainerStatusEventsGVA, src.SELSKAB, src.SrcSystemId, src.EVENT_LOC from hub.hubContainerStatusEventsGVA hub1 inner join (select REP_ID, SELSKAB, SrcSystemId, EVENT_LOC from StagingAreaTest.stg.MSCRUS_CtsContEvent where isDeleted = 0 and EVENT_LOC is null union select REP_ID, SELSKAB, SrcSystemId, EVENT_LOC from StagingAreaTest.stg.UNITY_CtsContEvent where isDeleted = 0 and EVENT_LOC is null) src on hub1.moveId = src.REP_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1)q
lnkContainerStatusEventsGVALocations.PORT_DISC.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubContainerStatusEventsGVA, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubContainerStatusEventsGVA, src.SELSKAB, src.SrcSystemId, src.PORT_DISC from hub.hubContainerStatusEventsGVA hub1 inner join (select REP_ID, SELSKAB, SrcSystemId, PORT_DISC from StagingAreaTest.stg.MSCRUS_CtsContEvent where isDeleted = 0 and PORT_DISC is not null union select REP_ID, SELSKAB, SrcSystemId, PORT_DISC from StagingAreaTest.stg.UNITY_CtsContEvent where isDeleted = 0 and PORT_DISC is not null) src on hub1.moveId = src.REP_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.PORT_DISC and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubContainerStatusEventsGVA, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubContainerStatusEventsGVA, src.SELSKAB, src.SrcSystemId, src.PORT_DISC from hub.hubContainerStatusEventsGVA hub1 inner join (select REP_ID, SELSKAB, SrcSystemId, PORT_DISC from StagingAreaTest.stg.MSCRUS_CtsContEvent where isDeleted = 0 and PORT_DISC is null union select REP_ID, SELSKAB, SrcSystemId, PORT_DISC from StagingAreaTest.stg.UNITY_CtsContEvent where isDeleted = 0 and PORT_DISC is null) src on hub1.moveId = src.REP_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1)q
lnkContainerStatusEventsGVALocations.PORT_LOAD.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubContainerStatusEventsGVA, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubContainerStatusEventsGVA, src.SELSKAB, src.SrcSystemId, src.PORT_LOAD from hub.hubContainerStatusEventsGVA hub1 inner join (select REP_ID, SELSKAB, SrcSystemId, PORT_LOAD from StagingAreaTest.stg.MSCRUS_CtsContEvent where isDeleted = 0 and PORT_LOAD is not null union select REP_ID, SELSKAB, SrcSystemId, PORT_LOAD from StagingAreaTest.stg.UNITY_CtsContEvent where isDeleted = 0 and PORT_LOAD is not null) src on hub1.moveId = src.REP_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.PORT_LOAD and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubContainerStatusEventsGVA, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubContainerStatusEventsGVA, src.SELSKAB, src.SrcSystemId, src.PORT_LOAD from hub.hubContainerStatusEventsGVA hub1 inner join (select REP_ID, SELSKAB, SrcSystemId, PORT_LOAD from StagingAreaTest.stg.MSCRUS_CtsContEvent where isDeleted = 0 and PORT_LOAD is null union select REP_ID, SELSKAB, SrcSystemId, PORT_LOAD from StagingAreaTest.stg.UNITY_CtsContEvent where isDeleted = 0 and PORT_LOAD is null) src on hub1.moveId = src.REP_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1)q
lnkContainerStatusEventsGVALocations.PORT_TRANS.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubContainerStatusEventsGVA, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubContainerStatusEventsGVA, src.SELSKAB, src.SrcSystemId, src.PORT_TRANS from hub.hubContainerStatusEventsGVA hub1 inner join (select REP_ID, SELSKAB, SrcSystemId, PORT_TRANS from StagingAreaTest.stg.MSCRUS_CtsContEvent where isDeleted = 0 and PORT_TRANS is not null union select REP_ID, SELSKAB, SrcSystemId, PORT_TRANS from StagingAreaTest.stg.UNITY_CtsContEvent where isDeleted = 0 and PORT_TRANS is not null) src on hub1.moveId = src.REP_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.PORT_TRANS and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubContainerStatusEventsGVA, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubContainerStatusEventsGVA, src.SELSKAB, src.SrcSystemId, src.PORT_TRANS from hub.hubContainerStatusEventsGVA hub1 inner join (select REP_ID, SELSKAB, SrcSystemId, PORT_TRANS from StagingAreaTest.stg.MSCRUS_CtsContEvent where isDeleted = 0 and PORT_TRANS is null union select REP_ID, SELSKAB, SrcSystemId, PORT_TRANS from StagingAreaTest.stg.UNITY_CtsContEvent where isDeleted = 0 and PORT_TRANS is null) src on hub1.moveId = src.REP_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1)q
lnkContainerStatusEventsGVALocations.satLnk.CountRows =  select count (*) c from sat.satLnkContainerStatusEventsGVALocations

lnkContainerDemurrageRulesCompany.lnk.CountRows =  select count (*) c from lin.lnkContainerDemurrageRulesCompany
lnkContainerDemurrageRulesCompany.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubContainerDemurrageRules, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubContainerDemurrageRules, src.SELSKAB, src.SrcSystemId from hub.hubContainerDemurrageRules hub1 inner join (select SEQ_NO, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_ContRules where isDeleted = 0 union select SEQ_NO, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_ContRules where isDeleted = 0) src on hub1.sequenceNumber = src.SEQ_NO and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId) union (select distinct srcHub1.dwhIdHubContainerDemurrageRules, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubContainerDemurrageRules, src.SELSKAB, src.SrcSystemId from hub.hubContainerDemurrageRules hub1 inner join (select SEQ_NO, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_ContRules where SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or til_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)) or fra_dato > CONVERT(datetime, ('31.12.9999'), 104) and ReasonDeleted not in (2,3) union select SEQ_NO, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_ContRules where SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or til_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)) or fra_dato > CONVERT(datetime, ('31.12.9999'), 104) and ReasonDeleted not in (2,3)) src on hub1.sequenceNumber = src.SEQ_NO and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q

lnkContainerVgmCompany.lnk.CountRows =  select count (*) c from lin.lnkContainerVgmCompany
lnkContainerVgmCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerVgm, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubContainerVgm, src.SELSKAB, src.SrcSystemId from hub.hubContainerVgm hub1 inner join (select ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Vgm where isDeleted = 0 union select ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Vgm where isDeleted = 0) src on hub1.vgmId = src.ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkContainerVgmVgmCode.lnk.CountRows =  select count (*) c from lin.lnkContainerVgmVgmCode
lnkContainerVgmVgmCode.SOURCE_TYPE.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubVgmCode, srcHub1.dwhIdHubContainerVgm, srcHub1.SrcSystemId from  hub.hubVgmCode hub2 inner join (select hub1.dwhIdHubContainerVgm, src.SELSKAB, src.SrcSystemId, src.VGM_SOURCE from hub.hubContainerVgm hub1 inner join (select ID, SELSKAB, SrcSystemId, VGM_SOURCE from StagingAreaTest.stg.MSCRUS_Vgm where isDeleted = 0 and VGM_SOURCE is not null union select ID, SELSKAB, SrcSystemId, VGM_SOURCE from StagingAreaTest.stg.UNITY_Vgm where isDeleted = 0 and VGM_SOURCE is not null) src on hub1.vgmId = src.ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.codeId = srcHub1.VGM_SOURCE and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkContainerVgmVgmCode.GEN_STATUS.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubVgmCode, srcHub1.dwhIdHubContainerVgm, srcHub1.SrcSystemId from  hub.hubVgmCode hub2 inner join (select hub1.dwhIdHubContainerVgm, src.SELSKAB, src.SrcSystemId, src.VGM_STATUS from hub.hubContainerVgm hub1 inner join (select ID, SELSKAB, SrcSystemId, VGM_STATUS from StagingAreaTest.stg.MSCRUS_Vgm where isDeleted = 0 and VGM_STATUS is not null union select ID, SELSKAB, SrcSystemId, VGM_STATUS from StagingAreaTest.stg.UNITY_Vgm where isDeleted = 0 and VGM_STATUS is not null) src on hub1.vgmId = src.ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.codeId = srcHub1.VGM_STATUS and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkContainerVgmVgmCode.satLnk.CountRows =  select count (*) c from sat.satLnkContainerVgmVgmCode

lnkDemurrageStorageCompany.lnk.CountRows =  select count (*) c from lin.lnkDemurrageStorageCompany
lnkDemurrageStorageCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubDemurrageStorage, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubDemurrageStorage, src.COMPANY, src.SrcSystemId from hub.hubDemurrageStorage hub1 inner join (select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId from StagingAreaTest.stg.MSCRUS_Demurrage where isDeleted = 0 union select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId from StagingAreaTest.stg.UNITY_Demurrage where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NO and hub1.demurrageStorageCode = src.CODE and hub1.accessCompanyId = src.COMPANY and hub1.containerNr = src.CONT_NO and hub1.demurrageId = src.DEM_ID and hub1.demurrageStorageStatus = src.STATUS and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.COMPANY and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkDemurrageStorageContainerDemurrageRules.lnk.CountRows =  select count (*) c from lin.lnkDemurrageStorageContainerDemurrageRules
lnkDemurrageStorageContainerDemurrageRules.STD_RULE.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubContainerDemurrageRules, srcHub1.dwhIdHubDemurrageStorage, srcHub1.SrcSystemId from  hub.hubContainerDemurrageRules hub2 inner join (select hub1.dwhIdHubDemurrageStorage, src.COMPANY, src.SrcSystemId, src. STD_RULE_ID from hub.hubDemurrageStorage hub1 inner join (select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, STD_RULE_ID from StagingAreaTest.stg.MSCRUS_Demurrage where isDeleted = 0 and STD_RULE_ID is not null union select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, STD_RULE_ID from StagingAreaTest.stg.UNITY_Demurrage where isDeleted = 0 and STD_RULE_ID is not null) src on hub1.bookingNumber = src.BOOK_NO and hub1.demurrageStorageCode = src.CODE and hub1.accessCompanyId = src.COMPANY and hub1.containerNr = src.CONT_NO and hub1.demurrageId = src.DEM_ID and hub1.demurrageStorageStatus = src.STATUS and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.sequenceNumber = srcHub1.STD_RULE_ID and hub2.accessCompanyId= srcHub1.COMPANY and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkDemurrageStorageContainerDemurrageRules.FACT_RULE.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubContainerDemurrageRules, srcHub1.dwhIdHubDemurrageStorage, srcHub1.SrcSystemId from  hub.hubContainerDemurrageRules hub2 inner join (select hub1.dwhIdHubDemurrageStorage, src.COMPANY, src.SrcSystemId, src. RULE_ID from hub.hubDemurrageStorage hub1 inner join (select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, RULE_ID from StagingAreaTest.stg.MSCRUS_Demurrage where isDeleted = 0 and RULE_ID is not null union select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, RULE_ID from StagingAreaTest.stg.UNITY_Demurrage where isDeleted = 0 and RULE_ID is not null) src on hub1.bookingNumber = src.BOOK_NO and hub1.demurrageStorageCode = src.CODE and hub1.accessCompanyId = src.COMPANY and hub1.containerNr = src.CONT_NO and hub1.demurrageId = src.DEM_ID and hub1.demurrageStorageStatus = src.STATUS and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.sequenceNumber = srcHub1.RULE_ID and hub2.accessCompanyId= srcHub1.COMPANY and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkDemurrageStorageContainerDemurrageRules.satLnk.CountRows =  select count (*) c from sat.satLnkDemurrageStorageContainerDemurrageRules
lnkDemurrageStorageContainerDemurrageRules.error.CountRows = select count (*) c from (select packageName, srcTablename, ErrorDate, description,SELSKAB, BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS from etl.errLogLnkDataVault where packageName like '%lnkDemurrageStorageContainerDemurrageRules%')q

lnkDemurrageStorageContainerMoveTypes.lnk.CountRows =  select count (*) c from lin.lnkDemurrageStorageContainerMoveTypes
lnkDemurrageStorageContainerMoveTypes.START_MOVE.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubContainerMoveTypes, srcHub1.dwhIdHubDemurrageStorage, srcHub1.SrcSystemId from  hub.hubContainerMoveTypes hub2 inner join (select hub1.dwhIdHubDemurrageStorage, src.COMPANY, src.SrcSystemId, src. START_MOVE from hub.hubDemurrageStorage hub1 inner join (select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, START_MOVE from StagingAreaTest.stg.MSCRUS_Demurrage where isDeleted = 0 and START_MOVE is not null union select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, START_MOVE from StagingAreaTest.stg.UNITY_Demurrage where isDeleted = 0 and START_MOVE is not null) src on hub1.bookingNumber = src.BOOK_NO and hub1.demurrageStorageCode = src.CODE and hub1.accessCompanyId = src.COMPANY and hub1.containerNr = src.CONT_NO and hub1.demurrageId = src.DEM_ID and hub1.demurrageStorageStatus = src.STATUS and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.moveTypeCode = srcHub1.START_MOVE and hub2.accessCompanyId= srcHub1.COMPANY and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkDemurrageStorageContainerMoveTypes.END_MOVE.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubContainerMoveTypes, srcHub1.dwhIdHubDemurrageStorage, srcHub1.SrcSystemId from  hub.hubContainerMoveTypes hub2 inner join (select hub1.dwhIdHubDemurrageStorage, src.COMPANY, src.SrcSystemId, src. END_MOVE from hub.hubDemurrageStorage hub1 inner join (select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, END_MOVE from StagingAreaTest.stg.MSCRUS_Demurrage where isDeleted = 0 and START_MOVE is not null union select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, END_MOVE from StagingAreaTest.stg.UNITY_Demurrage where isDeleted = 0 and START_MOVE is not null) src on hub1.bookingNumber = src.BOOK_NO and hub1.demurrageStorageCode = src.CODE and hub1.accessCompanyId = src.COMPANY and hub1.containerNr = src.CONT_NO and hub1.demurrageId = src.DEM_ID and hub1.demurrageStorageStatus = src.STATUS and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.moveTypeCode = srcHub1.END_MOVE and hub2.accessCompanyId= srcHub1.COMPANY and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkDemurrageStorageContainerMoveTypes.satLnk.CountRows =  select count (*) c from sat.satLnkDemurrageStorageContainerMoveTypes
lnkDemurrageStorageContainerMoveTypes.error.CountRows = select count (*) c from (select packageName, srcTablename, ErrorDate, description,SELSKAB, BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS from etl.errLogLnkDataVault where packageName like '%lnkDemurrageStorageContainerMoveTypes%')q


lnkDemurrageStorageInvoice.lnk.CountRows =  select count (*) c from lin.lnkDemurrageStorageInvoice
lnkDemurrageStorageInvoice.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubInvoice, srcHub1.dwhIdHubDemurrageStorage, srcHub1.SrcSystemId from  hub.hubInvoice hub2 inner join (select hub1.dwhIdHubDemurrageStorage, src.COMPANY, src.SrcSystemId, src. ORDRE_NO from hub.hubDemurrageStorage hub1 inner join (select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, ORDRE_NO from StagingAreaTest.stg.MSCRUS_Demurrage where isDeleted = 0 and ORDRE_NO is not null and ORDRE_NO != 0 union select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, ORDRE_NO from StagingAreaTest.stg.UNITY_Demurrage where isDeleted = 0 and ORDRE_NO is not null and ORDRE_NO != 0) src on hub1.bookingNumber = src.BOOK_NO and hub1.demurrageStorageCode = src.CODE and hub1.accessCompanyId = src.COMPANY and hub1.containerNr = src.CONT_NO and hub1.demurrageId = src.DEM_ID and hub1.demurrageStorageStatus = src.STATUS and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.orderNr = srcHub1.ORDRE_NO and hub2.accessCompanyId= srcHub1.COMPANY and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkDemurrageStorageInvoice.satLnk.CountRows = select count (*) c from sat.satLnkDemurrageStorageInvoice
lnkDemurrageStorageInvoice.error.CountRows = select count (*) c  from  [err].[errLnkDemurrage] where packageCreator like '%lnkDemurrageStorageInvoice%' 

lnkDemurrageStorageCurrency.lnk.CountRows =  select count (*) c from lin.lnkDemurrageStorageCurrency
lnkDemurrageStorageCurrency.CLIENT_CURRENCY.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubCurrency, srcHub1.dwhIdHubDemurrageStorage, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubDemurrageStorage, src.COMPANY, src.SrcSystemId, src. CLIENT_CURR from hub.hubDemurrageStorage hub1 inner join (select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, CLIENT_CURR from StagingAreaTest.stg.MSCRUS_Demurrage where isDeleted = 0 and CLIENT_CURR is not null union select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, CLIENT_CURR from StagingAreaTest.stg.UNITY_Demurrage where isDeleted = 0 and CLIENT_CURR is not null) src on hub1.bookingNumber = src.BOOK_NO and hub1.demurrageStorageCode = src.CODE and hub1.accessCompanyId = src.COMPANY and hub1.containerNr = src.CONT_NO and hub1.demurrageId = src.DEM_ID and hub1.demurrageStorageStatus = src.STATUS and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.CLIENT_CURR and hub2.accessCompanyId= srcHub1.COMPANY and hub2.srcSystemId =  srcHub1.SrcSystemId union select distinct hub2.dwhIdHubCurrency, srcHub1.dwhIdHubDemurrageStorage, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubDemurrageStorage, src.COMPANY, src.SrcSystemId, src. CLIENT_CURR from hub.hubDemurrageStorage hub1 inner join (select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, CLIENT_CURR from StagingAreaTest.stg.MSCRUS_Demurrage where isDeleted = 0 and CLIENT_CURR is null union select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, CLIENT_CURR from StagingAreaTest.stg.UNITY_Demurrage where isDeleted = 0 and CLIENT_CURR is  null) src on hub1.bookingNumber = src.BOOK_NO and hub1.demurrageStorageCode = src.CODE and hub1.accessCompanyId = src.COMPANY and hub1.containerNr = src.CONT_NO and hub1.demurrageId = src.DEM_ID and hub1.demurrageStorageStatus = src.STATUS and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCurrency = -1)q
lnkDemurrageStorageCurrency.DEMURRAGE_CURRENCY.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubCurrency, srcHub1.dwhIdHubDemurrageStorage, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubDemurrageStorage, src.COMPANY, src.SrcSystemId, src. CURRENCY from hub.hubDemurrageStorage hub1 inner join (select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, CURRENCY from StagingAreaTest.stg.MSCRUS_Demurrage where isDeleted = 0 and CURRENCY is not null union select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, CURRENCY from StagingAreaTest.stg.UNITY_Demurrage where isDeleted = 0 and CURRENCY is not null) src on hub1.bookingNumber = src.BOOK_NO and hub1.demurrageStorageCode = src.CODE and hub1.accessCompanyId = src.COMPANY and hub1.containerNr = src.CONT_NO and hub1.demurrageId = src.DEM_ID and hub1.demurrageStorageStatus = src.STATUS and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.CURRENCY and hub2.accessCompanyId= srcHub1.COMPANY and hub2.srcSystemId =  srcHub1.SrcSystemId union select distinct hub2.dwhIdHubCurrency, srcHub1.dwhIdHubDemurrageStorage, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubDemurrageStorage, src.COMPANY, src.SrcSystemId, src. CURRENCY from hub.hubDemurrageStorage hub1 inner join (select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, CURRENCY from StagingAreaTest.stg.MSCRUS_Demurrage where isDeleted = 0 and CURRENCY is null union select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, CURRENCY from StagingAreaTest.stg.UNITY_Demurrage where isDeleted = 0 and CURRENCY is  null) src on hub1.bookingNumber = src.BOOK_NO and hub1.demurrageStorageCode = src.CODE and hub1.accessCompanyId = src.COMPANY and hub1.containerNr = src.CONT_NO and hub1.demurrageId = src.DEM_ID and hub1.demurrageStorageStatus = src.STATUS and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCurrency = -1)q
lnkDemurrageStorageCurrency.STD_CURRENCY.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubCurrency, srcHub1.dwhIdHubDemurrageStorage, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubDemurrageStorage, src.COMPANY, src.SrcSystemId, src. STD_CURRENCY from hub.hubDemurrageStorage hub1 inner join (select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, STD_CURRENCY from StagingAreaTest.stg.MSCRUS_Demurrage where isDeleted = 0 and STD_CURRENCY is not null union select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, STD_CURRENCY from StagingAreaTest.stg.UNITY_Demurrage where isDeleted = 0 and STD_CURRENCY is not null) src on hub1.bookingNumber = src.BOOK_NO and hub1.demurrageStorageCode = src.CODE and hub1.accessCompanyId = src.COMPANY and hub1.containerNr = src.CONT_NO and hub1.demurrageId = src.DEM_ID and hub1.demurrageStorageStatus = src.STATUS and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.STD_CURRENCY and hub2.accessCompanyId= srcHub1.COMPANY and hub2.srcSystemId =  srcHub1.SrcSystemId union select distinct hub2.dwhIdHubCurrency, srcHub1.dwhIdHubDemurrageStorage, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubDemurrageStorage, src.COMPANY, src.SrcSystemId, src. STD_CURRENCY from hub.hubDemurrageStorage hub1 inner join (select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, STD_CURRENCY from StagingAreaTest.stg.MSCRUS_Demurrage where isDeleted = 0 and STD_CURRENCY is null union select BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, STD_CURRENCY from StagingAreaTest.stg.UNITY_Demurrage where isDeleted = 0 and STD_CURRENCY is  null) src on hub1.bookingNumber = src.BOOK_NO and hub1.demurrageStorageCode = src.CODE and hub1.accessCompanyId = src.COMPANY and hub1.containerNr = src.CONT_NO and hub1.demurrageId = src.DEM_ID and hub1.demurrageStorageStatus = src.STATUS and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCurrency = -1)q
lnkDemurrageStorageCurrency.satLnk.CountRows =  select count (*) c from sat.satLnkDemurrageStorageCurrency

lnkServiceCompany.lnk.CountRows =  select count (*) c from lin.lnkServiceCompany
lnkServiceCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubService, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubService, src.SELSKAB, src.SrcSystemId from hub.hubService hub1 inner join (select AFDELING, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Service where isDeleted = 0 union select AFDELING, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Service where isDeleted = 0) src on hub1.serviceCode = src.AFDELING  and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkSourceSystemUsersCompany.lnk.CountRows =  select count (*) c from lin.lnkSourceSystemUsersCompany
lnkSourceSystemUsersCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubSourceSystemUsers, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubSourceSystemUsers, src.SELSKAB, src.SrcSystemId from hub.hubSourceSystemUsers hub1 inner join (select ART, KODE, LOBE_NR, SELSKAB,SrcSystemId from StagingAreaTest.stg.MSCRUS_Henvis where isDeleted = 0 and ART='VO' and LOBE_NR='1' union select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_Henvis where isDeleted = 0 and ART='VO' and LOBE_NR='1') src on hub1.dictionaryType = src.ART and hub1.userCode = src.KODE and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkTerminalsCompany.lnk.CountRows =  select count (*) c from lin.lnkTerminalsCompany
lnkTerminalsCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubTerminals, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (	select hub1.dwhIdHubTerminals, src.SELSKAB, src.SrcSystemId from hub.hubTerminals hub1 inner join (select AGENT, FELT, FRA, TIL, SELSKAB,SrcSystemId from StagingAreaTest.stg.MSCRUS_EdiKonv where isDeleted = 0 and FELT='TERM' and AGENT='MSC' union 	select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_EdiKonv where isDeleted = 0 and FELT='TERM' and AGENT='MSC') src on hub1.carrierCode = src.AGENT and hub1.termCode = src.FELT and hub1.terminalCode  = src.FRA and hub1.terminalName  = src.TIL and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkServiceNamesCompany.lnk.CountRows =  select count (*) c from lin.lnkServiceNamesCompany
lnkServiceNamesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubServiceNames, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubServiceNames, src.SELSKAB, src.SrcSystemId from hub.hubServiceNames hub1 inner join (select ART, NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_StedBar where isDeleted = 0 union select  ART, NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_StedBar where isDeleted = 0) src on hub1.dictionaryType = src.ART and hub1.serviceCode = src.NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q

lnkIboxDataCompany.lnk.CountRows =  select count (*) c from lin.lnkIboxDataCompany
lnkIboxDataCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubIboxData, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubIboxData, hub1.accessCompanyId, src.SrcSystemId from hub.hubIboxData hub1 inner join (select BL_NUMBER, SrcSystemId from StagingAreaTest.stg.EXCEL_Ibox where IsDeleted = 0) src on hub1.blNumber = src.BL_NUMBER and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.accessCompanyId)q

lnkBookingCargoContMaster.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoContMaster
lnkBookingCargoContMaster.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCargo, hub2.dwhIdHubContMaster, srcHub1.srcSystemId from  hub.hubContMaster hub2 inner join (select hub1.dwhIdHubBookingCargo, src.SELSKAB, src.srcSystemId, src.CONT_NR from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, CONT_NR from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 union select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, CONT_NR  from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.containerNr = srcHub1.CONT_NR and hub2.srcSystemId = srcHub1.srcSystemId)q
lnkBookingCargoContMaster.satLnk.CountRows = select count (*) c from sat.satLnkBookingCargoContMaster
lnkBookingCargoContMaster.error.CountRows = select  count (*) c  from [err].[errLnkBookGods] where packageCreator like '%lnkBookingCargoContMaster%'


lnkBookingCargoContainerMoves.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoContainerMoves
lnkBookingCargoContainerMoves.condition.CountRows = select count (*) c from (select distinct hub1sat2.dwhIdHubBookingCargo, hub2.dwhIdHubContainerMoves, hub1sat2.srcSystemId from  hub.hubContainerMoves hub2 inner join (select srcHub1.dwhIdHubBookingCargo, srcHub1.SELSKAB, srcHub1.srcSystemId, sat.dwhIdHubContainerMoves from sat.satContainerMoves sat inner join (select hub1.dwhIdHubBookingCargo, src.SELSKAB, src.srcSystemId, src.BOOK_NR, src.CONT_NR from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, CONT_NR from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and CONT_NR is not null union select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, CONT_NR  from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and CONT_NR is not null) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on sat.containerNr = srcHub1.CONT_NR and sat.bookingNr = srcHub1.BOOK_NR and sat.srcSystemId = srcHub1.srcSystemId) hub1sat2 on hub1sat2.dwhIdHubContainerMoves = hub2.dwhIdHubContainerMoves and hub1sat2.SELSKAB = hub2.accessCompanyId)q
lnkBookingCargoContainerMoves.satLnk.CountRows = select count (*) c from sat.satLnkBookingCargoContainerMoves
lnkBookingCargoContainerMoves.error.CountRows = select  count (*) c  from [err].[errLnkBookGods] where packageCreator like '%lnkBookingCargoContainerMoves%'

lnkBookingCargoContainerStatusEventsGVA.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoContainerStatusEventsGVA
lnkBookingCargoContainerStatusEventsGVA.condition.CountRows = select count (*) c from (select distinct hub1sat2.dwhIdHubBookingCargo, hub2.dwhIdHubContainerStatusEventsGVA, hub1sat2.srcSystemId from  hub.hubContainerStatusEventsGVA hub2 inner join (select srcHub1.dwhIdHubBookingCargo, srcHub1.SELSKAB, srcHub1.srcSystemId, sat.dwhIdHubContainerStatusEventsGVA from sat.satContainerStatusEventsGVA sat inner join (select hub1.dwhIdHubBookingCargo, src.SELSKAB, src.srcSystemId, src.BOOK_NR, src.CONT_NR from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, CONT_NR from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and CONT_NR is not null union select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, CONT_NR  from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and CONT_NR is not null) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on sat.containerNr = srcHub1.CONT_NR and sat.bookingNumber = cast(srcHub1.BOOK_NR as nvarchar) and sat.srcSystemId = srcHub1.srcSystemId) hub1sat2 on hub1sat2.dwhIdHubContainerStatusEventsGVA = hub2.dwhIdHubContainerStatusEventsGVA and hub1sat2.SELSKAB = hub2.accessCompanyId)q
lnkBookingCargoContainerStatusEventsGVA.satLnk.CountRows = select count (*) c from sat.satLnkBookingCargoContainerStatusEventsGVA
lnkBookingCargoContainerStatusEventsGVA.error.CountRows = select  count (*) c  from [err].[errLnkBookGods] where packageCreator like '%lnkBookingCargoContainerStatusEventsGVA%'

lnkBookingCargoContainerVgm.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoContainerVgm
lnkBookingCargoContainerVgm.condition.CountRows = select count (*) c from (select distinct hub1sat2.dwhIdHubBookingCargo, hub2.dwhIdHubContainerVgm, hub1sat2.srcSystemId from  hub.hubContainerVgm hub2 inner join (select srcHub1.dwhIdHubBookingCargo, srcHub1.SELSKAB, srcHub1.srcSystemId, sat.dwhIdHubContainerVgm from sat.satContainerVgm sat inner join (select hub1.dwhIdHubBookingCargo, src.SELSKAB, src.srcSystemId, src.BOOK_NR, src.CONT_NR from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, CONT_NR from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and CONT_NR is not null union select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, CONT_NR  from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and CONT_NR is not null) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on sat.containerNr = srcHub1.CONT_NR and sat.bookingNumber = srcHub1.BOOK_NR and sat.srcSystemId = srcHub1.srcSystemId) hub1sat2 on hub1sat2.dwhIdHubContainerVgm = hub2.dwhIdHubContainerVgm and hub1sat2.SELSKAB = hub2.accessCompanyId)q
lnkBookingCargoContainerVgm.satLnk.CountRows = select count (*) c from sat.satLnkBookingCargoContainerVgm
lnkBookingCargoContainerVgm.error.CountRows = select  count (*) c  from [err].[errLnkBookGods] where packageCreator like '%lnkBookingCargoContainerVgm%'

lnkBookingCargoDemurrageStorage.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoDemurrageStorage
lnkBookingCargoDemurrageStorage.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCargo, hub2.dwhIdHubDemurrageStorage, srcHub1.srcSystemId from  hub.hubDemurrageStorage hub2 inner join (select hub1.dwhIdHubBookingCargo, src.SELSKAB, src.srcSystemId, src.BOOK_NR, src.CONT_NR from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, CONT_NR from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and CONT_NR is not null union select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, CONT_NR  from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and CONT_NR is not null) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.containerNr = srcHub1.CONT_NR and hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.srcSystemId)q
lnkBookingCargoDemurrageStorage.satLnk.CountRows = select count (*) c from sat.satLnkBookingCargoDemurrageStorage
lnkBookingCargoDemurrageStorage.error.CountRows = select  count (*) c  from [err].[errLnkBookGods] where packageCreator like '%lnkBookingCargoDemurrageStorage%'

lnkBookingCargoCommodityHsCodes.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoCommodityHsCodes
lnkBookingCargoCommodityHsCodes.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCargo, hub2.dwhIdHubCommodityHsCodes, srcHub1.srcSystemId from  hub.hubCommodityHsCodes hub2 inner join (select hub1.dwhIdHubBookingCargo, src.SELSKAB, src.srcSystemId, src.AGENCY_CCC from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, AGENCY_CCC from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and AGENCY_CCC is not null union select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, AGENCY_CCC  from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and AGENCY_CCC is not null) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.agencyHarmonizedCode = srcHub1.AGENCY_CCC and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.srcSystemId union select distinct srcHub1.dwhIdHubBookingCargo, hub2.dwhIdHubCommodityHsCodes, srcHub1.srcSystemId from  hub.hubCommodityHsCodes hub2 inner join (select hub1.dwhIdHubBookingCargo, src.SELSKAB, src.srcSystemId, src.BOOK_NR, src.AGENCY_CCC from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, AGENCY_CCC from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and AGENCY_CCC is  null union select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, AGENCY_CCC  from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and AGENCY_CCC is  null) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCommodityHsCodes = -1)q
lnkBookingCargoCommodityHsCodes.satLnk.CountRows = select count (*) c from sat.satLnkBookingCargoCommodityHsCodes

lnkContainerMovesContainerMoveTypes.lnk.CountRows =  select count (*) c from lin.lnkContainerMovesContainerMoveTypes
lnkContainerMovesContainerMoveTypes.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubContainerMoveTypes, srcHub1.dwhIdHubContainerMoves, srcHub1.SrcSystemId from  hub.hubContainerMoveTypes hub2 inner join (select hub1.dwhIdHubContainerMoves, src.SELSKAB, src.SrcSystemId, src.BEV_TYPE from hub.hubContainerMoves hub1 inner join (select LOBE_NR, SELSKAB, SrcSystemId, BEV_TYPE from StagingAreaTest.stg.MSCRUS_ContRep where isDeleted = 0 and BEV_TYPE is not null union select LOBE_NR, SELSKAB, SrcSystemId, BEV_TYPE from StagingAreaTest.stg.UNITY_ContRep where isDeleted = 0 and BEV_TYPE is not null) src on hub1.moveId = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.moveTypeCode = srcHub1.BEV_TYPE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkContainerMovesContainerMoveTypes.satLnk.CountRows = select count (*) c from sat.satLnkContainerMovesContainerMoveTypes

lnkCustomersSourceSystemUsers.lnk.CountRows =  select count (*) c from lin.lnkCustomersSourceSystemUsers
lnkCustomersSourceSystemUsers.KAM.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubSourceSystemUsers, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubSourceSystemUsers hub2 inner join (select hub1.dwhIdHubCustomers, src.SELSKAB, src.SrcSystemId, src.KAM from hub.hubCustomers hub1 inner join (select KUNDENR, SELSKAB, SrcSystemId, KAM from StagingAreaTest.stg.MSCRUS_Kunde where isDeleted = 0 and KAM is not null union select KUNDENR, SELSKAB, SrcSystemId, KAM from StagingAreaTest.stg.UNITY_Kunde where isDeleted = 0 and KAM is not null) src on hub1.customerNr = src.KUNDENR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.userCode = srcHub1.KAM and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId union select distinct hub2.dwhIdHubSourceSystemUsers, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubSourceSystemUsers hub2 inner join (select hub1.dwhIdHubCustomers, src.SELSKAB, src.SrcSystemId, src.KAM from hub.hubCustomers hub1 inner join (select KUNDENR, SELSKAB, SrcSystemId, KAM from StagingAreaTest.stg.MSCRUS_Kunde where isDeleted = 0 and KAM is  null union select KUNDENR, SELSKAB, SrcSystemId, KAM from StagingAreaTest.stg.UNITY_Kunde where isDeleted = 0 and KAM is  null) src on hub1.customerNr = src.KUNDENR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubSourceSystemUsers = -1)q
lnkCustomersSourceSystemUsers.KAM2.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubSourceSystemUsers, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubSourceSystemUsers hub2 inner join (select hub1.dwhIdHubCustomers, src.SELSKAB, src.SrcSystemId, src.KAM2 from hub.hubCustomers hub1 inner join (select KUNDENR, SELSKAB, SrcSystemId, KAM2 from StagingAreaTest.stg.MSCRUS_Kunde where isDeleted = 0 and KAM2 is not null union select KUNDENR, SELSKAB, SrcSystemId, KAM2 from StagingAreaTest.stg.UNITY_Kunde where isDeleted = 0 and KAM2 is not null) src on hub1.customerNr = src.KUNDENR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.userCode = srcHub1.KAM2 and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId union select distinct hub2.dwhIdHubSourceSystemUsers, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubSourceSystemUsers hub2 inner join (select hub1.dwhIdHubCustomers, src.SELSKAB, src.SrcSystemId, src.KAM2 from hub.hubCustomers hub1 inner join (select KUNDENR, SELSKAB, SrcSystemId, KAM2 from StagingAreaTest.stg.MSCRUS_Kunde where isDeleted = 0 and KAM2 is  null union select KUNDENR, SELSKAB, SrcSystemId, KAM2 from StagingAreaTest.stg.UNITY_Kunde where isDeleted = 0 and KAM2 is  null) src on hub1.customerNr = src.KUNDENR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubSourceSystemUsers = -1)q
lnkCustomersSourceSystemUsers.satLnk.CountRows =  select count (*) c from sat.satLnkCustomersSourceSystemUsers


lnkFileLinerService.lnk.CountRows =  select count (*) c from lin.lnkFileLinerService
lnkFileLinerService.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubService, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubService hub2 inner join (select hub1.dwhIdHubFileLiner, src.SELSKAB, src.SrcSystemId, src.AFDELING from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Sag where isDeleted = 0  union select AFDELING, SAGSNR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Sag where isDeleted = 0 ) src on hub1.serviceCode = src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.serviceCode = srcHub1.AFDELING and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkFileLinerService.satLnk.CountRows = select count (*) c from sat.satLnkFileLinerService

lnkFeederCostsLocations.lnk.CountRows =  select count (*) c from lin.lnkFeederCostsLocations
lnkFeederCostsLocations.POL.condition.CountRows = select count (*) c from ((select srcHub12.dwhIdHubFeederCosts, srcHub12.dwhIdHubLocations, hub3.dwhIdHubLocationRole from hub.hubLocationRole hub3 inner join (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFeederCosts from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFeederCosts, src.PortCode from hub.hubFeederCosts hub1 inner join (select  PortCode, SourceSheet from StagingAreaTest.stg.EXCEL_TrpCosts where IsDeleted = 0 and SOURCESHEET = 'NWC' and PortCode is not null) src on hub1.podCode = src.PortCode and hub1.dataSource = src.SourceSheet)srcHub1 on hub2.locationCode = srcHub1.PortCode ) srcHub12 on hub3.locationRoleName ='POL') union (select srcHub12.dwhIdHubFeederCosts, srcHub12.dwhIdHubLocations, hub3.dwhIdHubLocationRole from hub.hubLocationRole hub3 inner join (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFeederCosts from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFeederCosts, src.PortCode from hub.hubFeederCosts hub1 inner join (select  PortCode, SourceSheet from StagingAreaTest.stg.EXCEL_TrpCosts where IsDeleted = 0 and SOURCESHEET = 'NWC' and PortCode is  null) src on hub1.podCode = src.PortCode and hub1.dataSource = src.SourceSheet)srcHub1 on hub2.dwhIdHubLocations=-1) srcHub12 on hub3.locationRoleName ='POL'))q
lnkFeederCostsLocations.POD.condition.CountRows = select count (*) c from ((select srcHub12.dwhIdHubFeederCosts, srcHub12.dwhIdHubLocations, hub3.dwhIdHubLocationRole from hub.hubLocationRole hub3 inner join (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFeederCosts from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFeederCosts, src.PortCode from hub.hubFeederCosts hub1 inner join (select  PortCode, SourceSheet from StagingAreaTest.stg.EXCEL_TrpCosts where IsDeleted = 0 and SOURCESHEET = 'GULF' and PortCode is not null) src on hub1.podCode = src.PortCode and hub1.dataSource = src.SourceSheet)srcHub1 on hub2.locationCode = srcHub1.PortCode) srcHub12 on hub3.locationRoleName ='POD') union (select srcHub12.dwhIdHubFeederCosts, srcHub12.dwhIdHubLocations, hub3.dwhIdHubLocationRole from hub.hubLocationRole hub3 inner join (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFeederCosts from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFeederCosts, src.PortCode from hub.hubFeederCosts hub1 inner join (select  PortCode, SourceSheet from StagingAreaTest.stg.EXCEL_TrpCosts where IsDeleted = 0 and SOURCESHEET = 'GULF' and PortCode is  null) src on hub1.podCode = src.PortCode and hub1.dataSource = src.SourceSheet)srcHub1 on hub2.dwhIdHubLocations=-1) srcHub12 on hub3.locationRoleName ='POD'))q
lnkFeederCostsLocations.satLnk.CountRows =  select count (*) c from sat.satLnkFeederCostsLocations

lnkFemeFeederCostsLocations.lnk.CountRows =  select count (*) c from lin.lnkFemeFeederCostsLocations
lnkFemeFeederCostsLocations.POL.condition.CountRows = select count (*) c from ((select srcHub12.dwhIdHubFemeFeederCosts, srcHub12.dwhIdHubLocations, hub3.dwhIdHubLocationRole from hub.hubLocationRole hub3 inner join (select distinct hub2.dwhIdHubLocations, srcHub2.dwhIdHubFemeFeederCosts from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFemeFeederCosts, src.PortCode from hub.hubFemeFeederCosts hub1 inner join (select  PortCode, TS_CODE, SourceSheet from StagingAreaTest.stg.EXCEL_FemeTrpCosts where IsDeleted = 0 and SOURCESHEET = 'NWC' and PortCode is not null) src on hub1.portCode = src.PortCode and hub1.tsPortCode = src.TS_CODE and hub1.dataSource = src.SourceSheet)srcHub2 on hub2.locationCode = srcHub2.PortCode ) srcHub12 on hub3.locationRoleName ='POL') union (select srcHub12.dwhIdHubFemeFeederCosts, srcHub12.dwhIdHubLocations, hub3.dwhIdHubLocationRole from hub.hubLocationRole hub3 inner join (select distinct hub2.dwhIdHubLocations, srcHub2.dwhIdHubFemeFeederCosts from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFemeFeederCosts, src.PortCode from hub.hubFemeFeederCosts hub1 inner join (select  PortCode, TS_CODE, SourceSheet from StagingAreaTest.stg.EXCEL_FemeTrpCosts where IsDeleted = 0 and SOURCESHEET = 'NWC' and PortCode is  null) src on hub1.portCode = src.PortCode and hub1.tsPortCode = src.TS_CODE and hub1.dataSource = src.SourceSheet)srcHub2 on hub2.dwhIdHubLocations=-1) srcHub12 on hub3.locationRoleName ='POL'))q
lnkFemeFeederCostsLocations.POD.condition.CountRows = select count (*) c from ((select srcHub12.dwhIdHubFemeFeederCosts, srcHub12.dwhIdHubLocations, hub3.dwhIdHubLocationRole from hub.hubLocationRole hub3 inner join (select distinct hub2.dwhIdHubLocations, srcHub2.dwhIdHubFemeFeederCosts from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFemeFeederCosts, src.PortCode from hub.hubFemeFeederCosts hub1 inner join (select  PortCode, TS_CODE, SourceSheet from StagingAreaTest.stg.EXCEL_FemeTrpCosts where IsDeleted = 0 and SOURCESHEET = 'GULF' and PortCode is not null) src on hub1.portCode = src.PortCode and hub1.tsPortCode = src.TS_CODE and hub1.dataSource = src.SourceSheet)srcHub2 on hub2.locationCode = srcHub2.PortCode ) srcHub12 on hub3.locationRoleName ='POD') union (select srcHub12.dwhIdHubFemeFeederCosts, srcHub12.dwhIdHubLocations, hub3.dwhIdHubLocationRole from hub.hubLocationRole hub3 inner join (select distinct hub2.dwhIdHubLocations, srcHub2.dwhIdHubFemeFeederCosts from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFemeFeederCosts, src.PortCode from hub.hubFemeFeederCosts hub1 inner join (select  PortCode, TS_CODE, SourceSheet from StagingAreaTest.stg.EXCEL_FemeTrpCosts where IsDeleted = 0 and SOURCESHEET = 'GULF' and PortCode is  null) src on hub1.portCode = src.PortCode and hub1.tsPortCode = src.TS_CODE and hub1.dataSource = src.SourceSheet)srcHub2 on hub2.dwhIdHubLocations=-1) srcHub12 on hub3.locationRoleName ='POD'))q
lnkFemeFeederCostsLocations.satLnk.CountRows =  select count (*) c from sat.satLnkFemeFeederCostsLocations

lnkDemurrageStorageCustomer.lnk.CountRows =  select count (*) c from lin.lnkDemurrageStorageCustomer
lnkDemurrageStorageCustomer.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubDemurrageStorage, hub2.dwhIdHubCustomers, srcHub1.srcSystemId from  hub.hubCustomers hub2 inner join (select hub1.dwhIdhubDemurrageStorage, src.BOOK_NO, src.COMPANY, src.srcSystemId, src.S_CLIENT from hub.hubDemurrageStorage hub1 inner join (select distinct BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, S_CLIENT from StagingAreaTest.stg.MSCRUS_Demurrage where IsDeleted = 0 and S_CLIENT is not null union select distinct BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS,  SrcSystemId, S_CLIENT from StagingAreaTest.stg.UNITY_Demurrage where IsDeleted = 0 and S_CLIENT is not null) src on hub1.bookingNumber = src.BOOK_NO and hub1.demurrageStorageCode = src.CODE and hub1.accessCompanyId = src.COMPANY and hub1.containerNr = src.CONT_NO and hub1.demurrageId = src.DEM_ID and hub1.demurrageStorageStatus = src.STATUS and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.number = srcHub1.S_CLIENT and hub2.bookingNumber = srcHub1.BOOK_NO and hub2.accessCompanyId = srcHub1.COMPANY and hub2.srcSystemId = srcHub1.srcSystemId and hub2.refType='B' and hub2.customerType='A' union select distinct srcHub1.dwhIdHubDemurrageStorage, hub2.dwhIdHubCustomers, srcHub1.srcSystemId from  hub.hubCustomers hub2 inner join (select hub1.dwhIdhubDemurrageStorage, src.BOOK_NO, src.COMPANY, src.srcSystemId, src.CLIENT from hub.hubDemurrageStorage hub1 inner join (select distinct BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId, CLIENT from StagingAreaTest.stg.MSCRUS_Demurrage where IsDeleted = 0 and S_CLIENT is null union select distinct BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS,  SrcSystemId, CLIENT from StagingAreaTest.stg.UNITY_Demurrage where IsDeleted = 0 and S_CLIENT is null) src on hub1.bookingNumber = src.BOOK_NO and hub1.demurrageStorageCode = src.CODE and hub1.accessCompanyId = src.COMPANY and hub1.containerNr = src.CONT_NO and hub1.demurrageId = src.DEM_ID and hub1.demurrageStorageStatus = src.STATUS and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.customerNr = srcHub1.CLIENT and hub2.accessCompanyId = srcHub1.COMPANY and hub2.srcSystemId = srcHub1.srcSystemId and hub2.customerType='K' union select distinct srcHub1.dwhIdHubDemurrageStorage, hub2.dwhIdHubCustomers, srcHub1.srcSystemId from  hub.hubCustomers hub2 inner join (select hub1.dwhIdhubDemurrageStorage, src.BOOK_NO, src.COMPANY, src.srcSystemId from hub.hubDemurrageStorage hub1 inner join (select distinct BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS, SrcSystemId from StagingAreaTest.stg.MSCRUS_Demurrage where IsDeleted = 0 and S_CLIENT is null and CLIENT is null union select distinct BOOK_NO, CODE, COMPANY, CONT_NO, DEM_ID, STATUS,  SrcSystemId from StagingAreaTest.stg.UNITY_Demurrage where IsDeleted = 0 and S_CLIENT is null and CLIENT is null) src on hub1.bookingNumber = src.BOOK_NO and hub1.demurrageStorageCode = src.CODE and hub1.accessCompanyId = src.COMPANY and hub1.containerNr = src.CONT_NO and hub1.demurrageId = src.DEM_ID and hub1.demurrageStorageStatus = src.STATUS and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCustomers = -1)q
lnkDemurrageStorageCustomer.satLnk.CountRows = select count (*) c from sat.satLnkDemurrageStorageCustomer

lnkLoopSearch.lnk.CountRows =  select count (*) c from lin.lnkLoopSearch
lnkLoopSearch.condition.CountRows = select count (*) c from (select  distinct LiveScheduleName, LoopLeg, SerialPortNumber, PortCode, PortName, TS_Port from stg.EXCEL_LoopSearch where IsDeleted = 0)q
lnkLoopSearch.satLnk.CountRows = select count (*) c from sat.satnkLoopSearch
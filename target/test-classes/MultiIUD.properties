abPost.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_AbPost where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
abPost.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.F_TYPE, src.FAKTURANR, src.K_TYPE, src.KUNDE, src.LOBE_NR, src.SELSKAB,src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_AbPost src inner join (select  cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_AbPost where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.F_TYPE =srcInMoment.F_TYPE and src.FAKTURANR =srcInMoment.FAKTURANR and src.K_TYPE =srcInMoment.K_TYPE and src.KUNDE =srcInMoment.KUNDE and src.LOBE_NR =srcInMoment.LOBE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
abPost.MSCRUS.InDWithHub.counts = select count (*) c from (select src.F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_AbPost src inner join (select * from DataVaultTest.hub.hubPayments) hub on hub.invoiceType = src.F_TYPE and hub.invoiceNr = src.FAKTURANR and hub.debitCredit = src.K_TYPE and hub.customerCode = src.KUNDE and hub.sequenceNr = src.LOBE_NR and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
abPost.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_AbPost where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
abPost.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_AbPost where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
abPost.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.F_TYPE, src.FAKTURANR, src.K_TYPE, src.KUNDE, src.LOBE_NR, src.SELSKAB,src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_AbPost src inner join (select  cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_AbPost where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.F_TYPE =srcInMoment.F_TYPE and src.FAKTURANR =srcInMoment.FAKTURANR and src.K_TYPE =srcInMoment.K_TYPE and src.KUNDE =srcInMoment.KUNDE and src.LOBE_NR =srcInMoment.LOBE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
abPost.UNITY.InDWithHub.counts = select count (*) c from (select src.F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_AbPost src inner join (select * from DataVaultTest.hub.hubPayments) hub on hub.invoiceType = src.F_TYPE and hub.invoiceNr = src.FAKTURANR and hub.debitCredit = src.K_TYPE and hub.customerCode = src.KUNDE and hub.sequenceNr = src.LOBE_NR and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
abPost.UNITY.delete.count = select count (*) c from stg.UNITY_AbPost where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

book.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_Book where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
book.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_Book src inner join (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_Book where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
book.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_Book src inner join (select * from DataVaultTest.hub.hubBooking) hub on src.BOOK_NR =  hub.bookingNumber and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
book.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_Book where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
book.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_Book where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
book.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_Book src inner join (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_Book where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
book.UNITY.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_Book src inner join (select * from DataVaultTest.hub.hubBooking) hub on src.BOOK_NR =  hub.bookingNumber and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
book.UNITY.delete.count = select count (*) c from stg.UNITY_Book where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

bookDryPort.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookDryPort where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookDryPort.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_BookDryPort src inner join (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookDryPort where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookDryPort.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDryPort src inner join (select * from DataVaultTest.hub.hubBooking) hub on src.BOOK_NR =  hub.bookingNumber and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookDryPort.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_BookDryPort where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
bookDryPort.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookDryPort where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookDryPort.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_BookDryPort src inner join (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookDryPort where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookDryPort.UNITY.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_BookDryPort src inner join (select * from DataVaultTest.hub.hubBooking) hub on src.BOOK_NR =  hub.bookingNumber and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookDryPort.UNITY.delete.count = select count (*) c from stg.UNITY_BookDryPort where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

bookManifest.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookManifests where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookManifest.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_MFT_ID, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_BookManifests src inner join (select  cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookManifests where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_MFT_ID =srcInMoment.BOOK_MFT_ID and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookManifest.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.BOOK_MFT_ID, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_BookManifests src inner join (select * from DataVaultTest.hub.hubBookingManifest) hub on src.BOOK_MFT_ID =  hub.bookMftId and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookManifest.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_BookManifests where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
bookManifest.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookManifests where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookManifest.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_MFT_ID, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_BookManifests src inner join (select  cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookManifests where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_MFT_ID =srcInMoment.BOOK_MFT_ID and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookManifest.UNITY.InDWithHub.counts = select count (*) c  from (select src.BOOK_MFT_ID, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_BookManifests src inner join (select * from DataVaultTest.hub.hubBookingManifest) hub on src.BOOK_MFT_ID =  hub.bookMftId and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookManifest.UNITY.delete.count = select count (*) c from stg.UNITY_BookManifests where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

adresse.MSCRUS.countMutiMoments.counts = select count (*) c from (select  cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_Adresse where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q 
adresse.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.NR, src.REF_NR, src.REF_TYPE, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted from StagingAreaTest.stg.MSCRUS_Adresse src inner join (select  cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_Adresse where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.NR = srcInMoment.NR and src.REF_NR = srcInMoment.REF_NR and src.REF_TYPE = srcInMoment.REF_TYPE and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
adresse.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.NR, REF_NR, REF_TYPE, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_Adresse src inner join (select * from DataVaultTest.hub.hubCustomers) hub on src.NR =  hub.number and src.REF_NR =  hub.bookingNumber and src.REF_TYPE =  hub.refType and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
adresse.MSCRUS.InDAll.counts = select count (*) c  from (select src.NR, REF_NR, REF_TYPE, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_Adresse src where src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
adresse.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_Adresse where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
adresse.UNITY.countMutiMoments.counts = select count (*) c from (select  cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_Adresse where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q 
adresse.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.NR, src.REF_NR, src.REF_TYPE, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted from StagingAreaTest.stg.UNITY_Adresse src inner join (select  cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_Adresse where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.NR = srcInMoment.NR and src.REF_NR = srcInMoment.REF_NR and src.REF_TYPE = srcInMoment.REF_TYPE and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
adresse.UNITY.InDWithHub.counts = select count (*) c  from (select src.NR, REF_NR, REF_TYPE, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_Adresse src inner join (select * from DataVaultTest.hub.hubCustomers) hub on src.NR =  hub.number and src.REF_NR =  hub.bookingNumber and src.REF_TYPE =  hub.refType and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
adresse.UNITY.InDAll.counts = select count (*) c  from (select src.NR, REF_NR, REF_TYPE, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_Adresse src where src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
adresse.UNITY.delete.count = select count (*) c from stg.UNITY_Adresse where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

bookDetails.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookDetails where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookDetails.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR, src.SEGMENT_CODE, src.SEQ_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_BookDetails src inner join (select  cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDetails where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.SEGMENT_CODE = srcInMoment.SEGMENT_CODE and src.SEQ_NR =srcInMoment.SEQ_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookDetails.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, SEGMENT_CODE, SEQ_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDetails src inner join (select * from DataVaultTest.hub.hubBookingManifestAdditionals) hub on src.BOOK_NR =  hub.bookingNumber and src.SEGMENT_CODE =  hub.segmentCode and src.SEQ_NR =  hub.sequenceNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookDetails.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_BookDetails where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
bookDetails.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookDetails where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookDetails.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR, src.SEGMENT_CODE, src.SEQ_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_BookDetails src inner join (select  cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookDetails where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.SEGMENT_CODE = srcInMoment.SEGMENT_CODE and src.SEQ_NR =srcInMoment.SEQ_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookDetails.UNITY.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, SEGMENT_CODE, SEQ_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_BookDetails src inner join (select * from DataVaultTest.hub.hubBookingManifestAdditionals) hub on src.BOOK_NR =  hub.bookingNumber and src.SEGMENT_CODE =  hub.segmentCode and src.SEQ_NR =  hub.sequenceNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookDetails.UNITY.delete.count = select count (*) c from stg.UNITY_BookDetails where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

bookEvent.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, SEQ, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookEvent where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, SEQ, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookEvent.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.SEQ, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_BookEvent src inner join (select  cdcTimestamp, SEQ, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookEvent where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, SEQ, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.SEQ =srcInMoment.SEQ and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookEvent.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.SEQ, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_BookEvent src inner join (select * from DataVaultTest.hub.hubBookingEvents) hub on src.SEQ =  hub.bookingEventId and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookEvent.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_BookEvent where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
bookEvent.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, SEQ, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookEvent where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, SEQ, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookEvent.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.SEQ, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_BookEvent src inner join (select  cdcTimestamp, SEQ, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookEvent where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, SEQ, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.SEQ =srcInMoment.SEQ and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookEvent.UNITY.InDWithHub.counts = select count (*) c  from (select src.SEQ, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_BookEvent src inner join (select * from DataVaultTest.hub.hubBookingEvents) hub on src.SEQ =  hub.bookingEventId and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookEvent.UNITY.delete.count = select count (*) c from stg.UNITY_BookEvent where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

bookMftFile.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, MFT_FILE_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookMftFile where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, MFT_FILE_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookMftFile.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.MFT_FILE_ID, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_BookMftFile src inner join (select  cdcTimestamp, MFT_FILE_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookMftFile where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, MFT_FILE_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.MFT_FILE_ID =srcInMoment.MFT_FILE_ID and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookMftFile.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.MFT_FILE_ID, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_BookMftFile src inner join (select * from DataVaultTest.hub.hubBookingDTXFile) hub on src.MFT_FILE_ID =  hub.manifestFileId and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookMftFile.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_BookMftFile where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
bookMftFile.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, MFT_FILE_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookMftFile where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, MFT_FILE_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookMftFile.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.MFT_FILE_ID, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_BookMftFile src inner join (select  cdcTimestamp, MFT_FILE_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookMftFile where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, MFT_FILE_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.MFT_FILE_ID =srcInMoment.MFT_FILE_ID and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookMftFile.UNITY.InDWithHub.counts = select count (*) c  from (select src.MFT_FILE_ID, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_BookMftFile src inner join (select * from DataVaultTest.hub.hubBookingDTXFile) hub on src.MFT_FILE_ID =  hub.manifestFileId and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookMftFile.UNITY.delete.count = select count (*) c from stg.UNITY_BookMftFile where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

bogfTrans.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BogfTrans where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bogfTrans.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BILAGSNR, src.LOBE_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_BogfTrans src inner join ( select  cdcTimestamp, BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BogfTrans where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on  src.BILAGSNR=srcInMoment.BILAGSNR and src.LOBE_NR =srcInMoment.LOBE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
bogfTrans.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.BILAGSNR, LOBE_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_BogfTrans src inner join (select * from DataVaultTest.hub.hubAccountingTransaction) hub on src.BILAGSNR =  hub.itemNr and src.LOBE_NR =  hub.sequenceNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bogfTrans.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_BogfTrans where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
bogfTrans.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BogfTrans where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bogfTrans.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BILAGSNR, src.LOBE_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_BogfTrans src inner join ( select  cdcTimestamp, BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BogfTrans where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on  src.BILAGSNR=srcInMoment.BILAGSNR and src.LOBE_NR =srcInMoment.LOBE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
bogfTrans.UNITY.InDWithHub.counts = select count (*) c  from (select src.BILAGSNR, LOBE_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_BogfTrans src inner join (select * from DataVaultTest.hub.hubAccountingTransaction) hub on src.BILAGSNR =  hub.itemNr and src.LOBE_NR =  hub.sequenceNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bogfTrans.UNITY.delete.count = select count (*) c from stg.UNITY_BogfTrans where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

bookDetailsMof.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookDetailsMof where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookDetailsMof.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR,src.SEQ_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_BookDetailsMof src inner join (select  cdcTimestamp, BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDetailsMof where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.SEQ_NR =srcInMoment.SEQ_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId = srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookDetailsMof.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, SEQ_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDetailsMof src inner join (select * from DataVaultTest.hub.hubBookingManifestedHaulage) hub on src.BOOK_NR =  hub.bookingNumber and src.SEQ_NR = hub.sequenceNumber and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookDetailsMof.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_BookDetailsMof where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
bookDetailsMof.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookDetailsMof where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookDetailsMof.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR,src.SEQ_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_BookDetailsMof src inner join (select  cdcTimestamp, BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookDetailsMof where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.SEQ_NR =srcInMoment.SEQ_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId = srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookDetailsMof.UNITY.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, SEQ_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_BookDetailsMof src inner join (select * from DataVaultTest.hub.hubBookingManifestedHaulage) hub on src.BOOK_NR =  hub.bookingNumber and src.SEQ_NR = hub.sequenceNumber and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookDetailsMof.UNITY.delete.count = select count (*) c from stg.UNITY_BookDetailsMof where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

bookFak.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookFak where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookFak.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR,src.FRG_BT_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_BookFak src inner join (select  cdcTimestamp, BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookFak where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.FRG_BT_NR =srcInMoment.FRG_BT_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId = srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookFak.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, FRG_BT_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_BookFak src inner join (select * from DataVaultTest.hub.hubBookingCharges) hub on src.BOOK_NR =  hub.bookingNr and src.FRG_BT_NR = hub.positionNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookFak.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_BookFak where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
bookFak.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookFak where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookFak.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR,src.FRG_BT_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_BookFak src inner join (select  cdcTimestamp, BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookFak where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.FRG_BT_NR =srcInMoment.FRG_BT_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId = srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookFak.UNITY.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, FRG_BT_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_BookFak src inner join (select * from DataVaultTest.hub.hubBookingCharges) hub on src.BOOK_NR =  hub.bookingNr and src.FRG_BT_NR = hub.positionNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookFak.UNITY.delete.count = select count (*) c from stg.UNITY_BookFak where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

bookLin.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookLin where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookLin.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR, src.FRG_BT_NR, src.LINIE_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_BookLin src inner join (select  cdcTimestamp, BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookLin where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.FRG_BT_NR = srcInMoment.FRG_BT_NR and  src.LINIE_NR =srcInMoment.LINIE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and  src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookLin.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, FRG_BT_NR, LINIE_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_BookLin src inner join (select * from DataVaultTest.hub.hubBookingChargeLines) hub on src.BOOK_NR =  hub.bookingNumber and src.FRG_BT_NR =  hub.positionNr and  src.LINIE_NR =  hub.lineNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D '  and src.ReasonDeleted not in (1,2))q
bookLin.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_BookLin where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
bookLin.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookLin where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookLin.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR, src.FRG_BT_NR, src.LINIE_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_BookLin src inner join (select  cdcTimestamp, BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookLin where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.FRG_BT_NR = srcInMoment.FRG_BT_NR and  src.LINIE_NR =srcInMoment.LINIE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and  src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookLin.UNITY.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, FRG_BT_NR, LINIE_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_BookLin src inner join (select * from DataVaultTest.hub.hubBookingChargeLines) hub on src.BOOK_NR =  hub.bookingNumber and src.FRG_BT_NR =  hub.positionNr and  src.LINIE_NR =  hub.lineNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D '  and src.ReasonDeleted not in (1,2))q
bookLin.UNITY.delete.count = select count (*) c from stg.UNITY_BookLin where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

bookVessel.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookVessel where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookVessel.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR,src.BOOK_VESSEL_ID, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted from StagingAreaTest.stg.MSCRUS_BookVessel src inner join (select  cdcTimestamp, BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookVessel where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.BOOK_VESSEL_ID =srcInMoment.BOOK_VESSEL_ID and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId = srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookVessel.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, BOOK_VESSEL_ID, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_BookVessel src inner join (select * from DataVaultTest.hub.hubBookingOceanVessel) hub on src.BOOK_NR =  hub.bookingNumber and src.BOOK_VESSEL_ID = hub.bookVesselId and  src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookVessel.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_BookVessel where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
bookVessel.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookVessel where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookVessel.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR,src.BOOK_VESSEL_ID, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted from StagingAreaTest.stg.UNITY_BookVessel src inner join (select  cdcTimestamp, BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookVessel where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.BOOK_VESSEL_ID =srcInMoment.BOOK_VESSEL_ID and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId = srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookVessel.UNITY.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, BOOK_VESSEL_ID, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_BookVessel src inner join (select * from DataVaultTest.hub.hubBookingOceanVessel) hub on src.BOOK_NR =  hub.bookingNumber and src.BOOK_VESSEL_ID = hub.bookVesselId and  src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookVessel.UNITY.delete.count = select count (*) c from stg.UNITY_BookVessel where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

contRep.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_ContRep where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
contRep.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.LOBE_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_ContRep src inner join (select  cdcTimestamp, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_ContRep where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on  src.LOBE_NR =srcInMoment.LOBE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
contRep.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.LOBE_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_ContRep src inner join (select * from DataVaultTest.hub.hubContainerMoves) hub on src.LOBE_NR =  hub.moveId and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
contRep.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_ContRep where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
contRep.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_ContRep where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
contRep.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.LOBE_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_ContRep src inner join (select  cdcTimestamp, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_ContRep where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on  src.LOBE_NR =srcInMoment.LOBE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
contRep.UNITY.InDWithHub.counts = select count (*) c  from (select src.LOBE_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_ContRep src inner join (select * from DataVaultTest.hub.hubContainerMoves) hub on src.LOBE_NR =  hub.moveId and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
contRep.UNITY.delete.count = select count (*) c from stg.UNITY_ContRep where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

expVessels.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, EXP_VESSEL_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_ExpVessels where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, EXP_VESSEL_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
expVessels.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.EXP_VESSEL_ID, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_ExpVessels src inner join (select  cdcTimestamp, EXP_VESSEL_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_ExpVessels where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, EXP_VESSEL_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on  src.EXP_VESSEL_ID =srcInMoment.EXP_VESSEL_ID and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
expVessels.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.EXP_VESSEL_ID, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_ExpVessels src inner join (select * from DataVaultTest.hub.hubExportVessels) hub on src.EXP_VESSEL_ID =  hub.expVesselId and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
expVessels.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_ExpVessels where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
expVessels.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, EXP_VESSEL_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_ExpVessels where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, EXP_VESSEL_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
expVessels.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.EXP_VESSEL_ID, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_ExpVessels src inner join (select  cdcTimestamp, EXP_VESSEL_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_ExpVessels where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, EXP_VESSEL_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on  src.EXP_VESSEL_ID =srcInMoment.EXP_VESSEL_ID and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
expVessels.UNITY.InDWithHub.counts = select count (*) c  from (select src.EXP_VESSEL_ID, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_ExpVessels src inner join (select * from DataVaultTest.hub.hubExportVessels) hub on src.EXP_VESSEL_ID =  hub.expVesselId and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
expVessels.UNITY.delete.count = select count (*) c from stg.UNITY_ExpVessels where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

faktPost.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_FaktPost where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
faktPost.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.F_TYPE, src.FAKTURANR, src.K_TYPE, src.KUNDE, src.SELSKAB,src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_FaktPost src inner join (select  cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_FaktPost where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.F_TYPE =srcInMoment.F_TYPE and src.FAKTURANR =srcInMoment.FAKTURANR and src.K_TYPE =srcInMoment.K_TYPE and src.KUNDE =srcInMoment.KUNDE  and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId = srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
faktPost.MSCRUS.InDWithHub.counts = select count (*) c from (select src.F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_FaktPost src inner join (select * from DataVaultTest.hub.hubInvoicePosting) hub on hub.invoiceType = src.F_TYPE and hub.invoiceNr = src.FAKTURANR and hub.debitCredit = src.K_TYPE and hub.customerCode = src.KUNDE and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
faktPost.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_FaktPost where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
faktPost.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_FaktPost where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
faktPost.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.F_TYPE, src.FAKTURANR, src.K_TYPE, src.KUNDE, src.SELSKAB,src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_FaktPost src inner join (select  cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_FaktPost where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.F_TYPE =srcInMoment.F_TYPE and src.FAKTURANR =srcInMoment.FAKTURANR and src.K_TYPE =srcInMoment.K_TYPE and src.KUNDE =srcInMoment.KUNDE  and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId = srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
faktPost.UNITY.InDWithHub.counts = select count (*) c from (select src.F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_FaktPost src inner join (select * from DataVaultTest.hub.hubInvoicePosting) hub on hub.invoiceType = src.F_TYPE and hub.invoiceNr = src.FAKTURANR and hub.debitCredit = src.K_TYPE and hub.customerCode = src.KUNDE and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
faktPost.UNITY.delete.count = select count (*) c from stg.UNITY_FaktPost where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

kunde.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, KUNDENR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_Kunde where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, KUNDENR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
kunde.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.KUNDENR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_Kunde src inner join (select  cdcTimestamp, KUNDENR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_Kunde where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, KUNDENR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.KUNDENR =srcInMoment.KUNDENR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
kunde.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.KUNDENR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_Kunde src inner join (select * from DataVaultTest.hub.hubCustomers) hub on src.KUNDENR =  hub.customerNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
kunde.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_Kunde where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
kunde.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, KUNDENR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_Kunde where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, KUNDENR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
kunde.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.KUNDENR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_Kunde src inner join (select  cdcTimestamp, KUNDENR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_Kunde where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, KUNDENR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.KUNDENR =srcInMoment.KUNDENR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
kunde.UNITY.InDWithHub.counts = select count (*) c  from (select src.KUNDENR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_Kunde src inner join (select * from DataVaultTest.hub.hubCustomers) hub on src.KUNDENR =  hub.customerNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
kunde.UNITY.delete.count = select count (*) c from stg.UNITY_Kunde where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

ordre.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, ORDRE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_Ordre where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, ORDRE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
ordre.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.ORDRE_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_Ordre src inner join (select  cdcTimestamp, ORDRE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_Ordre where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, ORDRE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.ORDRE_NR =srcInMoment.ORDRE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
ordre.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.ORDRE_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_Ordre src inner join (select * from DataVaultTest.hub.hubInvoice) hub on src.ORDRE_NR =  hub.orderNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q 
ordre.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_Ordre where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
ordre.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, ORDRE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_Ordre where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, ORDRE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
ordre.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.ORDRE_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_Ordre src inner join (select  cdcTimestamp, ORDRE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_Ordre where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, ORDRE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.ORDRE_NR =srcInMoment.ORDRE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
ordre.UNITY.InDWithHub.counts = select count (*) c  from (select src.ORDRE_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_Ordre src inner join (select * from DataVaultTest.hub.hubInvoice) hub on src.ORDRE_NR =  hub.orderNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q 
ordre.UNITY.delete.count = select count (*) c from stg.UNITY_Ordre where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

ordreLin.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_OrdreLin where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
ordreLin.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.LINIE_NR,src.ORDRE_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted from StagingAreaTest.stg.MSCRUS_OrdreLin src inner join (select  cdcTimestamp, LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_OrdreLin where cdcOperation is not null and ReasonDeleted not in (1,2)  group by cdcTimestamp, LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.LINIE_NR =srcInMoment.LINIE_NR and src.ORDRE_NR =srcInMoment.ORDRE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId = srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
ordreLin.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.LINIE_NR, ORDRE_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_OrdreLin src inner join (select * from DataVaultTest.hub.hubInvoiceLines) hub on src.LINIE_NR =  hub.invoiceLineNr and src.ORDRE_NR = hub.orderNr and  src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
ordreLin.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_OrdreLin where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
ordreLin.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_OrdreLin where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
ordreLin.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.LINIE_NR,src.ORDRE_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted from StagingAreaTest.stg.UNITY_OrdreLin src inner join (select  cdcTimestamp, LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_OrdreLin where cdcOperation is not null and ReasonDeleted not in (1,2)  group by cdcTimestamp, LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.LINIE_NR =srcInMoment.LINIE_NR and src.ORDRE_NR =srcInMoment.ORDRE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId = srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
ordreLin.UNITY.InDWithHub.counts = select count (*) c  from (select src.LINIE_NR, ORDRE_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_OrdreLin src inner join (select * from DataVaultTest.hub.hubInvoiceLines) hub on src.LINIE_NR =  hub.invoiceLineNr and src.ORDRE_NR = hub.orderNr and  src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
ordreLin.UNITY.delete.count = select count (*) c from stg.UNITY_OrdreLin where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

sag.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, AFDELING, SAGSNR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_Sag where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, AFDELING, SAGSNR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
sag.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.AFDELING,src.SAGSNR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted from StagingAreaTest.stg.MSCRUS_Sag src inner join (select  cdcTimestamp, AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Sag where cdcOperation is not null and ReasonDeleted not in (1,2)  group by cdcTimestamp, AFDELING, SAGSNR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.AFDELING =srcInMoment.AFDELING and src.SAGSNR =srcInMoment.SAGSNR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId = srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
sag.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.AFDELING, SAGSNR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_Sag src inner join (select * from DataVaultTest.hub.hubFileLiner) hub on src.AFDELING =  hub.serviceCode and src.SAGSNR = hub.fileLinerNr and  src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
sag.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_Sag where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
sag.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, AFDELING, SAGSNR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_Sag where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, AFDELING, SAGSNR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
sag.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.AFDELING,src.SAGSNR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted from StagingAreaTest.stg.UNITY_Sag src inner join (select  cdcTimestamp, AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Sag where cdcOperation is not null and ReasonDeleted not in (1,2)  group by cdcTimestamp, AFDELING, SAGSNR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.AFDELING =srcInMoment.AFDELING and src.SAGSNR =srcInMoment.SAGSNR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId = srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
sag.UNITY.InDWithHub.counts = select count (*) c  from (select src.AFDELING, SAGSNR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_Sag src inner join (select * from DataVaultTest.hub.hubFileLiner) hub on src.AFDELING =  hub.serviceCode and src.SAGSNR = hub.fileLinerNr and  src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
sag.UNITY.delete.count = select count (*) c from stg.UNITY_Sag where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

sagKurs.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, AFDELING, SAGSNR, VALUTA, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_SagKurs where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, AFDELING, SAGSNR, VALUTA, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
sagKurs.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.AFDELING, src.SAGSNR, src.VALUTA, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_SagKurs src inner join (select  cdcTimestamp, AFDELING, SAGSNR, VALUTA, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_SagKurs where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, AFDELING, SAGSNR, VALUTA, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.AFDELING =srcInMoment.AFDELING and src.SAGSNR = srcInMoment.SAGSNR and  src.VALUTA =srcInMoment.VALUTA and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and  src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
sagKurs.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.AFDELING, SAGSNR, VALUTA, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_SagKurs src inner join (select * from DataVaultTest.hub.hubFileROE) hub on src.AFDELING =  hub.serviceCode and src.SAGSNR =  hub.fileLinerNr and src.VALUTA =  hub.currencyCode and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D '  and src.ReasonDeleted not in (1,2))q
sagKurs.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_SagKurs where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
sagKurs.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, AFDELING, SAGSNR, VALUTA, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_SagKurs where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, AFDELING, SAGSNR, VALUTA, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
sagKurs.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.AFDELING, src.SAGSNR, src.VALUTA, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_SagKurs src inner join (select  cdcTimestamp, AFDELING, SAGSNR, VALUTA, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_SagKurs where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, AFDELING, SAGSNR, VALUTA, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.AFDELING =srcInMoment.AFDELING and src.SAGSNR = srcInMoment.SAGSNR and  src.VALUTA =srcInMoment.VALUTA and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and  src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
sagKurs.UNITY.InDWithHub.counts = select count (*) c  from (select src.AFDELING, SAGSNR, VALUTA, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_SagKurs src inner join (select * from DataVaultTest.hub.hubFileROE) hub on src.AFDELING =  hub.serviceCode and src.SAGSNR =  hub.fileLinerNr and src.VALUTA =  hub.currencyCode and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D '  and src.ReasonDeleted not in (1,2))q
sagKurs.UNITY.delete.count = select count (*) c from stg.UNITY_SagKurs where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

shipKurs.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, DATO, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_ShipKurs where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, DATO, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
shipKurs.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.DATO,src.LOBE_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted from StagingAreaTest.stg.MSCRUS_ShipKurs src inner join (select  cdcTimestamp, DATO, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_ShipKurs where cdcOperation is not null and ReasonDeleted not in (1,2)  group by cdcTimestamp, DATO, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.DATO =srcInMoment.DATO and src.LOBE_NR =srcInMoment.LOBE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId = srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
shipKurs.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.DATO, LOBE_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_ShipKurs src inner join (select * from DataVaultTest.hub.hubDailyRoe) hub on src.DATO =  hub.roeDate and src.LOBE_NR = hub.sequenceNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
shipKurs.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_ShipKurs where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
shipKurs.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, DATO, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_ShipKurs where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, DATO, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
shipKurs.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.DATO,src.LOBE_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted from StagingAreaTest.stg.UNITY_ShipKurs src inner join (select  cdcTimestamp, DATO, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_ShipKurs where cdcOperation is not null and ReasonDeleted not in (1,2)  group by cdcTimestamp, DATO, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.DATO =srcInMoment.DATO and src.LOBE_NR =srcInMoment.LOBE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId = srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
shipKurs.UNITY.InDWithHub.counts = select count (*) c  from (select src.DATO, LOBE_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_ShipKurs src inner join (select * from DataVaultTest.hub.hubDailyRoe) hub on src.DATO =  hub.roeDate and src.LOBE_NR = hub.sequenceNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
shipKurs.UNITY.delete.count = select count (*) c from stg.UNITY_ShipKurs where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
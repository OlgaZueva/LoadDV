lnkAccountingTransactionBooking.lnk.CountRows = select count (*) c from lin.lnkAccountingTransactionBooking
lnkAccountingTransactionBooking.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubAccountingTransaction, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubAccountingTransaction, src.SELSKAB, src.SrcSystemId, src.REF_NR from hub.hubAccountingTransaction hub1 inner join (select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, REF_NR from StagingAreaTest.stg.MSCRUS_BogfTrans where REF_NR is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, REF_NR from StagingAreaTest.stg.UNITY_BogfTrans where REF_NR is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.itemNr = src.BILAGSNR and hub1.sequenceNr = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.REF_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkAccountingTransactionBooking.satLnk.CountRows = select count (*) c from sat.satLnkAccountingTransactionBooking

lnkAccountingTransactionCurrency.lnk.CountRows =  select count (*) c from lin.lnkAccountingTransactionCurrency
lnkAccountingTransactionCurrency.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubAccountingTransaction, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubAccountingTransaction, src.SELSKAB, src.SrcSystemId, src.MONT_ENHED from hub.hubAccountingTransaction hub1 inner join (select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.MSCRUS_BogfTrans where isDeleted = 0 and MONT_ENHED is not null union select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.UNITY_BogfTrans where isDeleted = 0 and MONT_ENHED is not null) src on hub1.itemNr = src.BILAGSNR and hub1.sequenceNr = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.MONT_ENHED and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubAccountingTransaction, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubAccountingTransaction, src.SELSKAB, src.SrcSystemId, src.MONT_ENHED from hub.hubAccountingTransaction hub1 inner join (select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.MSCRUS_BogfTrans where isDeleted = 0 and MONT_ENHED is null union select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.UNITY_BogfTrans where isDeleted = 0 and MONT_ENHED is null) src on hub1.itemNr = src.BILAGSNR and hub1.sequenceNr = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCurrency = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkAccountingTransactionCurrency.satLnk.CountRows = select count (*) c from sat.satLnkAccountingTransactionCurrency
lnkAccountingTransactionCompany.lnk.CountRows = select count (*) c from lin.lnkAccountingTransactionCompany
lnkAccountingTransactionCompany.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubCompany, srcHub1.dwhIdHubAccountingTransaction, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubAccountingTransaction, src.SELSKAB, src.SrcSystemId from hub.hubAccountingTransaction hub1 inner join (select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BogfTrans where isDeleted = 0 union select BILAGSNR, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BogfTrans where isDeleted = 0) src on hub1.itemNr = src.BILAGSNR and hub1.sequenceNr = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkAccountingTransactionCompany.satLnk.CountRows = select count (*) c from sat.satLnkAccountingTransactionCompany

lnkPaymentsInvoicePosting.lnk.CountRows =  select count (*) c from lin.lnkPaymentsInvoicePosting
lnkPaymentsInvoicePosting.condition.CountRows =   select count (*) c from (select distinct srcHub1.dwhIdHubPayments, hub2.dwhIdHubInvoicePosting, srcHub1.SrcSystemId from  hub.hubInvoicePosting hub2 inner join (select hub1.dwhIdHubPayments, src.SELSKAB, src.SrcSystemId, src.F_TYPE, src.FAKTURANR, src.K_TYPE, src.KUNDE from hub.hubPayments hub1 inner join (select F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_AbPost where isDeleted = 0 union select F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_AbPost where isDeleted = 0) src on hub1.invoiceType = src.F_TYPE and hub1.invoiceNr = src.FAKTURANR and hub1.debitCredit = src.K_TYPE and hub1.customerCode = src.KUNDE and hub1.sequenceNr = src.LOBE_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.invoiceType = srcHub1.F_TYPE and hub2.invoiceNr = srcHub1.FAKTURANR and hub2.debitCredit = srcHub1.K_TYPE and hub2.customerCode = srcHub1.KUNDE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkPaymentsInvoicePosting.satLnk.CountRows =  select count (*) c from sat.satLnkPaymentsInvoicePosting
lnkPaymentsInvoicePosting.error.CountRows = select count (*) c from (select packageName, srcTablename, ErrorDate, description,SELSKAB, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR  from etl.errLogLnkDataVault where packageName like '%lnkPaymentsInvoicePosting%')q

lnkPaymentsCompany.lnk.CountRows = select count (*) c from lin.lnkPaymentsCompany
lnkPaymentsCompany.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubCompany, srcHub1.dwhIdHubPayments, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubPayments, src.SELSKAB, src.SrcSystemId from hub.hubPayments hub1 inner join (select F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_AbPost where isDeleted = 0 union select F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_AbPost where isDeleted = 0) src on hub1.invoiceType = src.F_TYPE and hub1.invoiceNr = src.FAKTURANR and hub1.debitCredit = src.K_TYPE and hub1.customerCode = src.KUNDE and hub1.sequenceNr = src.LOBE_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q  
lnkPaymentsCompany.satLnk.CountRows = select count (*) c from sat.satLnkPaymentsCompany

lnkCustomersCountry.lnk.CountRows =  select count (*) c from lin.lnkCustomersCountry
lnkCustomersCountry.condition.CountRows = select count (*) c from (select distinct hubCountry.dwhIdHubCountry, srcHubCust.dwhIdHubCustomers, srcHubCust.SrcSystemId from  hub.hubCountry hubCountry inner join (select hubCustomers.dwhIdHubCustomers, src.DEB_LAND, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hubCustomers inner join (select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, DEB_LAND from StagingAreaTest.stg.MSCRUS_Adresse where isDeleted = 0 and DEB_LAND is not null union select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, DEB_LAND from StagingAreaTest.stg.UNITY_Adresse where isDeleted = 0 and DEB_LAND is not null) src on hubCustomers.number =  src.NR and hubCustomers.bookingNumber = src.REF_NR and hubCustomers.refType =  src.REF_TYPE and hubCustomers.accessCompanyId = src.SELSKAB and hubCustomers.srcSystemId = src.srcSystemId)srcHubCust on hubCountry.countryCode = srcHubCust.DEB_LAND and hubCountry.accessCompanyId =  srcHubCust.SELSKAB and hubCountry.srcSystemId = srcHubCust.SrcSystemId union select distinct hubCountry.dwhIdHubCountry, srcHubCust.dwhIdHubCustomers, srcHubCust.SrcSystemId from  hub.hubCountry hubCountry inner join (select hubCustomers.dwhIdHubCustomers, src.DEB_LAND, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hubCustomers inner join (select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, DEB_LAND from StagingAreaTest.stg.MSCRUS_Adresse where isDeleted = 0 and DEB_LAND is null union select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, DEB_LAND from StagingAreaTest.stg.UNITY_Adresse where isDeleted = 0 and DEB_LAND is null) src on hubCustomers.number =  src.NR and hubCustomers.bookingNumber = src.REF_NR and hubCustomers.refType =  src.REF_TYPE and hubCustomers.accessCompanyId = src.SELSKAB and hubCustomers.srcSystemId = src.srcSystemId)srcHubCust on hubCountry.dwhIdHubCountry = -1 and hubCountry.accessCompanyId =  -1 and hubCountry.srcSystemId = 0)q
lnkCustomersCountry.satLnk.CountRows =  select count (*) c from sat.satLnkCustomersCountry

lnkCustomersCompany.lnk.CountRows =  select count (*) c from lin.lnkCustomersCompany
lnkCustomersCompany.conditionAdresse.CountRows = select count (*) c from (select distinct hub2.dwhIdHubCompany, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubCustomers, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hub1 inner join (select NR, REF_NR, REF_TYPE, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Adresse where isDeleted = 0 union select NR, REF_NR, REF_TYPE, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Adresse where isDeleted = 0) src on hub1.number = src.NR and hub1.bookingNumber = src.REF_NR and hub1.refType = src.REF_TYPE and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkCustomersCompany.conditionKunde.CountRows = select count (*) c from (select distinct hub2.dwhIdHubCompany, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubCustomers, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hub1 inner join (select KUNDENR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Kunde where isDeleted = 0 union select KUNDENR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Kunde where isDeleted = 0) src on hub1.customerNr = src.KUNDENR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkCustomersCompany.satLnk.CountRows = select count (*) c from sat.satLnkCustomersCompany

lnkBookingBooking.lnk.CountRows =  select count (*) c from lin.lnkBookingBooking
lnkBookingBooking.condition.CountRows =  select count (*) c from (select srcHub1Sat.dwhidHubBooking1, hub2.dwhidHubBooking as dwhidHubBooking2, srcHub1Sat.SrcSystemId from hub.hubBooking hub2 inner join (select srcHub1.dwhidHubBooking1, sat.dwhidHubBooking, sat.SrcSystemId, srcHub1.CONTROL_SELSKAB from sat.satBooking sat inner join (select hub1.dwhidHubBooking as dwhidHubBooking1, src.CROSS_BOOK, src.SrcSystemId, src.CONTROL_SELSKAB from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, CROSS_BOOK, CONTROL_SELSKAB, IMP_EXP, REF_NR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and SELSKAB != CONTROL_SELSKAB and CONTROL_SELSKAB is not null and IMP_EXP  in ('E') union select distinct BOOK_NR, SELSKAB, SrcSystemId, CROSS_BOOK, CONTROL_SELSKAB,  IMP_EXP, REF_NR from StagingAreaTest.stg.UNITY_Book  where isDeleted = 0 and SELSKAB != CONTROL_SELSKAB and CONTROL_SELSKAB is not null and IMP_EXP  in ('E')) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId =  SELSKAB and hub1.srcSystemId =  src.SrcSystemId)srcHub1 on sat.blNumber = srcHub1.CROSS_BOOK and sat.srcSystemId = srcHub1.SrcSystemId)srcHub1Sat on srcHub1Sat.dwhidHubBooking = hub2.dwhIdHubBooking and srcHub1Sat.CONTROL_SELSKAB =  hub2.accessCompanyId union select srcHub1Sat.dwhidHubBooking1, hub2.dwhidHubBooking as dwhidHubBooking2, srcHub1Sat.SrcSystemId from hub.hubBooking hub2 inner join (select srcHub1.dwhidHubBooking1, sat.dwhidHubBooking, sat.SrcSystemId, srcHub1.CONTROL_SELSKAB from sat.satBooking sat inner join (select hub1.dwhidHubBooking as dwhidHubBooking1, src.CROSS_BOOK, src.SrcSystemId, src.CONTROL_SELSKAB, src.REF_NR from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, CROSS_BOOK, CONTROL_SELSKAB, IMP_EXP, REF_NR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and SELSKAB != CONTROL_SELSKAB and CONTROL_SELSKAB is not null and IMP_EXP  in ('I') union select distinct BOOK_NR, SELSKAB, SrcSystemId, CROSS_BOOK, CONTROL_SELSKAB,  IMP_EXP, REF_NR from StagingAreaTest.stg.UNITY_Book  where isDeleted = 0 and SELSKAB != CONTROL_SELSKAB and CONTROL_SELSKAB is not null and IMP_EXP  in ('I')) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId =  SELSKAB and hub1.srcSystemId =  src.SrcSystemId)srcHub1 on sat.blNumber = srcHub1.REF_NR and sat.srcSystemId = srcHub1.SrcSystemId)srcHub1Sat on srcHub1Sat.dwhidHubBooking = hub2.dwhIdHubBooking and srcHub1Sat.CONTROL_SELSKAB =  hub2.accessCompanyId)q
lnkBookingBooking.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBooking
lnkBookingBooking.error.CountRows = select count (*) c from (select packageName, srcTablename, ErrorDate, description, BOOK_NR, SELSKAB from etl.errLogLnkDataVault where   packageName like '%lnkBookingBooking')q

lnkBookingBookingChargeLines.lnk.CountRows = select count (*) c from lin.lnkBookingBookingChargeLines
lnkBookingBookingChargeLines.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingChargeLines, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingChargeLines, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingChargeLines hub1 inner join (select BOOK_NR, SELSKAB, FRG_BT_NR, LINIE_NR, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookLin where isDeleted = 0 union select BOOK_NR, SELSKAB, FRG_BT_NR, LINIE_NR, SrcSystemId from StagingAreaTest.stg.UNITY_BookLin where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingChargeLines.satLnk.CountRows = select count (*) c from sat.satLnkBookingBookingChargeLines

lnkBookingBookingHaulageDetails.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingHaulageDetails
lnkBookingBookingHaulageDetails.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubBookingHaulageDetails, srcHub1.SrcSystemId from  hub.hubBookingHaulageDetails hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 union select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Book where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingHaulageDetails.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingHaulageDetails
lnkBookingBookingHaulageDetails.error.CountRows = select count (*) c from (select packageName, srcTablename, ErrorDate, description, BOOK_NR, SELSKAB from etl.errLogLnkDataVault where packageName like '%lnkBookingBookingHaulageDetails%')q

lnkBookingBookingReportingCustomer.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingReportingCustomer
lnkBookingBookingReportingCustomer.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubBookingReportingCustomer, srcHub1.SrcSystemId from  hub.hubBookingReportingCustomer hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.REF_NR from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, REF_NR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 union select BOOK_NR, SELSKAB, SrcSystemId, REF_NR from StagingAreaTest.stg.UNITY_Book where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.blNr = srcHub1.REF_NR)q
lnkBookingBookingReportingCustomer.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingReportingCustomer
lnkBookingBookingReportingCustomer.error.CountRows = select count (*) c from (select packageName, srcTablename, ErrorDate, description, BOOK_NR, SELSKAB from etl.errLogLnkDataVault where packageName like '%lnkBookingBookingReportingCustomer%')q

lnkBookingContainerLocation.lnk.CountRows =  select count (*) c from lin.lnkBookingContainerLocation
lnkBookingContainerLocation_E.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubContainerLocation, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubBooking, src.LOC, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and LOC is not null and IMP_EXP= 'E' union select BOOK_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and LOC is not null and IMP_EXP= 'E') src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.containerlocationCode = srcHub1.LOC and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubContainerLocation, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubBooking, src.LOC, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and LOC is null and IMP_EXP= 'E' union select BOOK_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and LOC is null and IMP_EXP= 'E') src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubContainerLocation = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingContainerLocation_I.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubContainerLocation, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubBooking, src.LOC2, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, LOC2 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and LOC2 is not null and IMP_EXP= 'I' union select BOOK_NR, SELSKAB, SrcSystemId, LOC2 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and LOC2 is not null and IMP_EXP= 'I') src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.containerlocationCode = srcHub1.LOC2 and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubContainerLocation, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubBooking, src.LOC2, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, LOC2 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and LOC2 is null and IMP_EXP= 'I' union select BOOK_NR, SELSKAB, SrcSystemId, LOC2 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and LOC2 is null and IMP_EXP= 'I') src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubContainerLocation = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingContainerLocation.satLnk.CountRows =  select count (*) c from sat.satLnkBookingContainerLocation

lnkBookingControllingOffice.lnk.CountRows =  select count (*) c from lin.lnkBookingControllingOffice
lnkBookingControllingOffice.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubControllingOffice, srcHub1.SrcSystemId from hub.hubControllingOffice hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.CONTROL_SELSKAB, src.CONTROL_KONTOR from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, CONTROL_SELSKAB, CONTROL_KONTOR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and CONTROL_SELSKAB is not null union select BOOK_NR, SELSKAB, SrcSystemId, CONTROL_SELSKAB, CONTROL_KONTOR from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and CONTROL_SELSKAB is not null) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on ISNULL(hub2.officeId, -1) = ISNULL (srcHub1.CONTROL_KONTOR, -1) and hub2.companyId = srcHub1.CONTROL_SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId) union (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubControllingOffice, srcHub1.SrcSystemId from hub.hubControllingOffice hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.CONTROL_SELSKAB, src.CONTROL_KONTOR from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, CONTROL_SELSKAB, CONTROL_KONTOR from StagingAreaTest.stg.MSCRUS_Book where SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select BOOK_NR, SELSKAB, SrcSystemId, CONTROL_SELSKAB, CONTROL_KONTOR from StagingAreaTest.stg.UNITY_Book where SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or creation_date  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on ISNULL(hub2.officeId, -1) = ISNULL (srcHub1.CONTROL_KONTOR, -1) and hub2.companyId = srcHub1.CONTROL_SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q
lnkBookingControllingOffice.satLnk.CountRows =  select count (*) c from sat.satLnkBookingControllingOffice


lnkBookingCountry.lnk.CountRows =  select count (*) c from lin.lnkBookingCountry
lnkBookingCountry.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubCountry, srcHub1.SrcSystemId from  hub.hubCountry hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.AFSL_LAND from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, AFSL_LAND from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 union select BOOK_NR, SELSKAB, SrcSystemId, AFSL_LAND from StagingAreaTest.stg.UNITY_Book where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.countryCode = srcHub1.AFSL_LAND and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingCountry.satLnk.CountRows =  select count (*) c from sat.satLnkBookingCountry
lnkBookingCrossBookingType.lnk.CountRows =  select count (*) c from lin.lnkBookingCrossBookingType
lnkBookingCrossBookingType.condition.CountRows = select count (*) c from (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.REF_TYPE from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 union select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.UNITY_Book where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)q
lnkBookingCrossBookingType.foundedForREF_TYPE.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubCrossBookingType, srcHub1.SrcSystemId from  hub.hubCrossBookingType hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.REF_TYPE from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and REF_TYPE is not null union select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and REF_TYPE is not null) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookTypeCode = SUBSTRING(srcHub1.REF_TYPE, 1, 2) union select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubCrossBookingType, srcHub1.SrcSystemId from  hub.hubCrossBookingType hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.REF_TYPE from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and REF_TYPE is null union select BOOK_NR, SELSKAB, SrcSystemId, REF_TYPE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and REF_TYPE is null) src on hub1.bookingNumber = src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookTypeCode = 'NA')q
lnkBookingCrossBookingType.satLnk.CountRows =  select count (*) c from sat.satLnkBookingCrossBookingType

lnkBookingCustomers.lnk.CountRows =  select count (*) c from lin.lnkBookingCustomers
lnkBookingCustomers.condition_S_NAMED_ACCOUNT_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NAMED_ACCOUNT, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NAMED_ACCOUNT, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_NAMED_ACCOUNT is not null union select distinct BOOK_NR, SELSKAB, S_NAMED_ACCOUNT, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_NAMED_ACCOUNT is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NAMED_ACCOUNT = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' and hubB1.S_NAMED_ACCOUNT is not null)q
lnkBookingCustomers.condition_S_NAMED_ACCOUNT_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NAMED_ACCOUNT, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NAMED_ACCOUNT, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_NAMED_ACCOUNT is null union select distinct BOOK_NR, SELSKAB, NAMED_ACCOUNT, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_NAMED_ACCOUNT is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NAMED_ACCOUNT = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q 
lnkBookingCustomers.condition_both_NAMED_ACCOUNT_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join  (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_NAMED_ACCOUNT is null and NAMED_ACCOUNT is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_NAMED_ACCOUNT is null and NAMED_ACCOUNT is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_BOOK_PARTY_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_BOOK_PARTY, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_BOOK_PARTY, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_BOOK_PARTY is not null union select distinct BOOK_NR, SELSKAB, S_BOOK_PARTY, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_BOOK_PARTY is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_BOOK_PARTY = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_BOOK_PARTY_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.BOOK_PARTY, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, BOOK_PARTY, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_BOOK_PARTY is null union select distinct BOOK_NR, SELSKAB, BOOK_PARTY, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_BOOK_PARTY is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.BOOK_PARTY = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_BOOK_PARTY_Null.CountRows = select  count (*) c from ( select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_BOOK_PARTY is null and BOOK_PARTY is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_BOOK_PARTY is null and BOOK_PARTY is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_CARE_OF_FWD_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_CARE_OF_FWD, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_CARE_OF_FWD, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_CARE_OF_FWD is not null union select distinct BOOK_NR, SELSKAB, S_CARE_OF_FWD, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_CARE_OF_FWD is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_CARE_OF_FWD = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_CARE_OF_FWD_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.CARE_OF_FWD, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, CARE_OF_FWD, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_CARE_OF_FWD is null union select distinct BOOK_NR, SELSKAB, CARE_OF_FWD, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_CARE_OF_FWD is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.CARE_OF_FWD = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.both_CARE_OF_FWD_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_CARE_OF_FWD is null and CARE_OF_FWD is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_CARE_OF_FWD is null and CARE_OF_FWD is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_AFSENDER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_AFSENDER is not null union select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_AFSENDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_AFSENDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_AFSENDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_AFSENDER is null union select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.AFSENDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_AFSENDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_AFSENDER is null and AFSENDER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_AFSENDER is null and AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_MODTAGER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_MODTAGER is not null union select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_MODTAGER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_MODTAGER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_MODTAGER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_MODTAGER is null union select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.MODTAGER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_MODTAGER_NotNull = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_MODTAGER is null and MODTAGER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_MODTAGER is null and MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_MODTAGER_unionAllCondition.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_MODTAGER is not null union select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_MODTAGER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_MODTAGER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_MODTAGER is null union select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.MODTAGER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_MODTAGER is null and MODTAGER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_MODTAGER is null and MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_SLUTSPED_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_SLUTSPED is not null union select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_SLUTSPED is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_SLUTSPED = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_SLUTSPED_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_SLUTSPED is null union select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.SLUTSPED = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_SLUTSPED_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_SLUTSPED is null and SLUTSPED is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_SLUTSPED is null and SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_NOTIFY2_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_NOTIFY2 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_NOTIFY2 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY2 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_NOTIFY2_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY2 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_NOTIFY2_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_NOTIFY2 is null and NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_NOTIFY2 is null and NOTIFY2 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_NOTIFY3_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_NOTIFY3 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_NOTIFY3 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY3 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_NOTIFY3_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY3 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_NOTIFY3_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_NOTIFY3 is null and NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_NOTIFY3 is null and NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_KUNDE_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_KUNDE is not null union select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_KUNDE is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_KUNDE = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_KUNDE_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_KUNDE is null union select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_KUNDE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.KUNDE = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_KUNDE_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_KUNDE is null and KUNDE is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_KUNDE is null and KUNDE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_CONTRACT_HOLDER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_CONTRACT_HOLDER is not null union select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_CONTRACT_HOLDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_CONTRACT_HOLDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_CONTRACT_HOLDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.CONTRACT_HOLDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_CONTRACT_HOLDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_CONTRACT_HOLDER is null and CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_CONTRACT_HOLDER is null and CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_IC_ELSEWHERE_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_IC_ELSEWHERE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_IC_ELSEWHERE , srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_IC_ELSEWHERE is not null union select distinct BOOK_NR, SELSKAB, S_IC_ELSEWHERE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_IC_ELSEWHERE is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_IC_ELSEWHERE = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_IC_ELSEWHERE_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.IC_ELSEWHERE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, IC_ELSEWHERE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_IC_ELSEWHERE is null union select distinct BOOK_NR, SELSKAB, IC_ELSEWHERE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_IC_ELSEWHERE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.IC_ELSEWHERE = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_IC_ELSEWHERE_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_IC_ELSEWHERE is null and IC_ELSEWHERE is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_IC_ELSEWHERE is null and IC_ELSEWHERE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_S_FREIGHT_FWD_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_FREIGHT_FWD, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_FREIGHT_FWD , srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_FREIGHT_FWD is not null union select distinct BOOK_NR, SELSKAB, S_FREIGHT_FWD, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_FREIGHT_FWD is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_FREIGHT_FWD = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_S_FREIGHT_FWD_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.FREIGHT_FWD, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, FREIGHT_FWD, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  S_FREIGHT_FWD is null union select distinct BOOK_NR, SELSKAB, FREIGHT_FWD, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  S_FREIGHT_FWD is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.FREIGHT_FWD = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_both_FREIGHT_FWD_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and S_FREIGHT_FWD is null and FREIGHT_FWD is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and S_FREIGHT_FWD is null and FREIGHT_FWD is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_StatCustomer_S_KUNDE_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'S' and S_KUNDE is not null union select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'S' and S_KUNDE is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_KUNDE = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_StatCustomer_S_KUNDE_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'S' and S_KUNDE is null union select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'S' and S_KUNDE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.KUNDE = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_StatCustomer_S_AFSENDER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'A' and S_AFSENDER is not null union select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'A' and S_AFSENDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_AFSENDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_StatCustomer_S_AFSENDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'A' and S_AFSENDER is null union select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'A' and S_AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.AFSENDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_StatCustomer_S_MODTAGER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'M' and S_MODTAGER is not null union select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'M' and S_MODTAGER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_MODTAGER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_StatCustomer_S_MODTAGER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'M' and S_MODTAGER is null union select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'M' and S_MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.MODTAGER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_StatCustomer_S_SLUTSPED_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'N' and S_SLUTSPED is not null union select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'N' and S_SLUTSPED is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_SLUTSPED = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_StatCustomer_S_SLUTSPED_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'N' and S_SLUTSPED is null union select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'N' and S_SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.SLUTSPED = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_StatCustomer_S_NOTIFY2_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = '2' and S_NOTIFY2 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '2' and S_NOTIFY2 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY2 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A')q 
lnkBookingCustomers.condition_StatCustomer_S_NOTIFY2_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = '2' and S_NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '2' and S_NOTIFY2 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY2 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_StatCustomer_S_NOTIFY3_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = '3' and S_NOTIFY3 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '3' and S_NOTIFY3 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY3 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_StatCustomer_S_NOTIFY3_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = '3' and S_NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '3' and S_NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY3 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' )q
lnkBookingCustomers.condition_StatCustomer_S_CONTRACT_HOLDER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is not null union select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_CONTRACT_HOLDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_StatCustomer_S_CONTRACT_HOLDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.CONTRACT_HOLDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_StatCustomer_Union.CountRows= select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'S' and S_KUNDE is not null union select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'S' and S_KUNDE is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_KUNDE = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'S' and S_KUNDE is null union select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'S' and S_KUNDE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.KUNDE = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  KUNDE_STAT = 'S' and S_KUNDE is null and KUNDE is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and KUNDE_STAT = 'S' and S_KUNDE is null and KUNDE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'A' and S_AFSENDER is not null union select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'A' and S_AFSENDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_AFSENDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'A' and S_AFSENDER is null union select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'A' and S_AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.AFSENDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  KUNDE_STAT = 'A' and S_AFSENDER is null and AFSENDER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and KUNDE_STAT = 'A' and S_AFSENDER is null and AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'M' and S_MODTAGER is not null union select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'M' and S_MODTAGER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_MODTAGER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'M' and S_MODTAGER is null union select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'M' and S_MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.MODTAGER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  KUNDE_STAT = 'M' and S_MODTAGER is null and MODTAGER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and KUNDE_STAT = 'M' and S_MODTAGER is null and MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'N' and S_SLUTSPED is not null union select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'N' and S_SLUTSPED is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_SLUTSPED = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = 'N' and S_SLUTSPED is null union select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'N' and S_SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.SLUTSPED = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  KUNDE_STAT = 'N' and S_SLUTSPED is null and SLUTSPED is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and KUNDE_STAT = 'N' and S_SLUTSPED is null and SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = '2' and S_NOTIFY2 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '2' and S_NOTIFY2 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY2 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   KUNDE_STAT = '2' and S_NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '2' and S_NOTIFY2 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY2 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  KUNDE_STAT = '2' and S_NOTIFY2 is null and NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and KUNDE_STAT = '2' and S_NOTIFY2 is null and NOTIFY2 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = '3' and S_NOTIFY3 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '3' and S_NOTIFY3 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY3 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = '3' and S_NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = '3' and S_NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY3 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  KUNDE_STAT = '3' and S_NOTIFY3 is null and NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and KUNDE_STAT = '3' and S_NOTIFY3 is null and NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is not null union select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_CONTRACT_HOLDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.CONTRACT_HOLDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is null and CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and KUNDE_STAT = 'C' and S_CONTRACT_HOLDER is null and CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.condition_FreightPayer_S_KUNDE_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'S' and S_KUNDE is not null union select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'S' and S_KUNDE is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_KUNDE = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_FreightPayer_S_KUNDE_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'S' and S_KUNDE is null union select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'S' and S_KUNDE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.KUNDE = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_FreightPayer_S_AFSENDER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'A' and S_AFSENDER is not null union select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'A' and S_AFSENDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_AFSENDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_FreightPayer_S_AFSENDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'A' and S_AFSENDER is null union select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'A' and S_AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.AFSENDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_FreightPayer_S_MODTAGER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'M' and S_MODTAGER is not null union select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'M' and S_MODTAGER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_MODTAGER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_FreightPayer_S_MODTAGER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'M' and S_MODTAGER is null union select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'M' and S_MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.MODTAGER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_FreightPayer_S_SLUTSPED_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'N' and S_SLUTSPED is not null union select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'N' and S_SLUTSPED is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_SLUTSPED = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_FreightPayer_S_SLUTSPED_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'N' and S_SLUTSPED is null union select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'N' and S_SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.SLUTSPED = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_FreightPayer_S_NOTIFY2_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = '2' and S_NOTIFY2 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '2' and S_NOTIFY2 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY2 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A')q 
lnkBookingCustomers.condition_FreightPayer_S_NOTIFY2_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = '2' and S_NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '2' and S_NOTIFY2 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY2 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_FreightPayer_S_NOTIFY3_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = '3' and S_NOTIFY3 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '3' and S_NOTIFY3 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY3 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_FreightPayer_S_NOTIFY3_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = '3' and S_NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '3' and S_NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY3 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' )q
lnkBookingCustomers.condition_FreightPayer_S_CONTRACT_HOLDER_NotNull.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is not null union select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_CONTRACT_HOLDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' )q
lnkBookingCustomers.condition_FreightPayer_S_CONTRACT_HOLDER_Null.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.CONTRACT_HOLDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K')q
lnkBookingCustomers.condition_FreightPayer_Union.CountRows = select  count (*) c from (select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and FREIGHT_PAY = 'S' and S_KUNDE is not null union select distinct BOOK_NR, SELSKAB, S_KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and FREIGHT_PAY = 'S' and S_KUNDE is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_KUNDE = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A'  union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join ( select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.KUNDE, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and FREIGHT_PAY = 'S' and S_KUNDE is null union select distinct BOOK_NR, SELSKAB, KUNDE, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and FREIGHT_PAY = 'S' and S_KUNDE is null) src on  hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.KUNDE = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  FREIGHT_PAY = 'S' and S_KUNDE is null and KUNDE is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and FREIGHT_PAY = 'S' and S_KUNDE is null and KUNDE is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'A' and S_AFSENDER is not null union select distinct BOOK_NR, SELSKAB, S_AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'A' and S_AFSENDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_AFSENDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.AFSENDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'A' and S_AFSENDER is null union  select distinct BOOK_NR, SELSKAB, AFSENDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'A' and S_AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.AFSENDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  FREIGHT_PAY = 'A' and S_AFSENDER is null and AFSENDER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and FREIGHT_PAY = 'A' and S_AFSENDER is null and AFSENDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union  select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'M' and S_MODTAGER is not null union select distinct BOOK_NR, SELSKAB, S_MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'M' and S_MODTAGER is not null) src on  hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_MODTAGER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.MODTAGER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'M' and S_MODTAGER is null union select distinct BOOK_NR, SELSKAB, MODTAGER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'M' and S_MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.MODTAGER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  FREIGHT_PAY = 'M' and S_MODTAGER is null and MODTAGER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and FREIGHT_PAY = 'M' and S_MODTAGER is null and MODTAGER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union  select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'N' and S_SLUTSPED is not null union select distinct BOOK_NR, SELSKAB, S_SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'N' and S_SLUTSPED is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_SLUTSPED = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.SLUTSPED, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'N' and S_SLUTSPED is null union select distinct BOOK_NR, SELSKAB, SLUTSPED, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'N' and S_SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.SLUTSPED = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  FREIGHT_PAY = 'N' and S_SLUTSPED is null and SLUTSPED is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and FREIGHT_PAY = 'N' and S_SLUTSPED is null and SLUTSPED is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0  union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = '2' and S_NOTIFY2 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '2' and S_NOTIFY2 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY2 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY2, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = '2' and S_NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, NOTIFY2, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '2' and S_NOTIFY2 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY2 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  FREIGHT_PAY = '2' and S_NOTIFY2 is null and NOTIFY2 is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and FREIGHT_PAY = '2' and S_NOTIFY2 is null and NOTIFY2 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = '3' and S_NOTIFY3 is not null union select distinct BOOK_NR, SELSKAB, S_NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '3' and S_NOTIFY3 is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.S_NOTIFY3 = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A'  union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.NOTIFY3, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = '3' and S_NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, NOTIFY3, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = '3' and S_NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubB1.NOTIFY3 = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K'  union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  FREIGHT_PAY = '3' and S_NOTIFY3 is null and NOTIFY3 is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and FREIGHT_PAY = '3' and S_NOTIFY3 is null and NOTIFY3 is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0 union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (	select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.S_CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and  FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is not null union select distinct BOOK_NR, SELSKAB, S_CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is not null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on 	hubB1.S_CONTRACT_HOLDER = hubC.number and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.BOOK_NR=hubC.bookingNumber and hubB1.srcSystemId = hubC.srcSystemId and hubC.refType='B' and hubC.customerType = 'A' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking, src.BOOK_NR, src.SELSKAB, src.CONTRACT_HOLDER, src.SrcSystemId from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted =0 and   FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, CONTRACT_HOLDER, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted =0 and  FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on 	hubB1.CONTRACT_HOLDER = hubC.customerNr and hubB1.SELSKAB = hubC.accessCompanyId and hubB1.srcSystemId = hubC. srcSystemId and hubC.customerType = 'K' union select distinct hubC.dwhIdHubCustomers, hubB1.dwhIdHubBooking from hub.hubCustomers hubC inner join (select hubB.dwhIdHubBooking from hub.hubBooking hubB inner join (select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.UNITY_Book src where isDeleted = 0 and  FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is null and CONTRACT_HOLDER is null union select distinct BOOK_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.MSCRUS_Book src where isDeleted = 0 and FREIGHT_PAY = 'C' and S_CONTRACT_HOLDER is null and CONTRACT_HOLDER is null) src on hubB.bookingNumber = src.BOOK_NR and hubB.accessCompanyId =src.SELSKAB and hubB.srcSystemId =src.SrcSystemId) hubB1 on hubC.dwhIdHubCustomers = -1 and hubC.accessCompanyId =  -1 and hubC.srcSystemId = 0)q
lnkBookingCustomers.satLnk.CountRows =  select count (*) c from sat.satLnkBookingCustomers

lnkBookingFileLiner.lnk.CountRows =  select count (*) c from lin.lnkBookingFileLiner
lnkBookingFileLiner.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubFileLiner hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.SAGSNR, src.AFDELING from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, SAGSNR, AFDELING from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 union select BOOK_NR, SELSKAB, SrcSystemId, SAGSNR, AFDELING from StagingAreaTest.stg.UNITY_Book where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.serviceCode = srcHub1.AFDELING and hub2.fileLinerNr = srcHub1.SAGSNR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingFileLiner.satLnk.CountRows =  select count (*) c from sat.satLnkBookingFileLiner
lnkBookingImportExport.lnk.CountRows =  select count (*) c from lin.lnkBookingImportExport
lnkBookingImportExport.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubImportExport, srcHub1.SrcSystemId from  hub.hubImportExport hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.IMP_EXP from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, IMP_EXP from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and IMP_EXP is not null union select BOOK_NR, SELSKAB, SrcSystemId, IMP_EXP from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and IMP_EXP is not null) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.importExportCode = srcHub1.IMP_EXP union select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubImportExport, srcHub1.SrcSystemId from  hub.hubImportExport hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId, src.IMP_EXP from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, IMP_EXP from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and IMP_EXP is null union select BOOK_NR, SELSKAB, SrcSystemId, IMP_EXP from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and IMP_EXP is null) src on   hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubImportExport = -1)q
lnkBookingImportExport.satLnk.CountRows =  select count (*) c from sat.satLnkBookingImportExport
lnkBookingLocations.lnk.CountRows =  select count (*) c from lin.lnkBookingLocations
lnkBookingLocations.condition_AFG_ZONE.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, AFG_ZONE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and AFG_ZONE is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, AFG_ZONE from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and AFG_ZONE is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.AFG_ZONE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, AFG_ZONE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and AFG_ZONE is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, AFG_ZONE from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and AFG_ZONE is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_ANK_ZONE_notNull.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.ANK_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, ANK_ZONE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and ANK_ZONE is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, ANK_ZONE from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and ANK_ZONE is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.ANK_ZONE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q 
lnkBookingLocations.condition_ANK_ZONE_Null.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.POD, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, POD from StagingAreaTest.stg.MSCRUS_BookDryPort where isDeleted = 0 and BOOK_NR  in (select distinct BOOK_NR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and ANK_ZONE is null)union select distinct BOOK_NR, SELSKAB, SrcSystemId, POD from StagingAreaTest.stg.UNITY_BookDryPort where isDeleted = 0 and BOOK_NR  in (select distinct BOOK_NR from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and ANK_ZONE is null)) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.POD and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId )q
lnkBookingLocations.condition_ANK_ZONE_Null_ForBothNull.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking,  src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and ANK_ZONE is null union select distinct BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and ANK_ZONE is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q 
lnkBookingLocations.condition_POD.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.POD, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, POD from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and POD is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, POD from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and POD is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.POD and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.POD, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, POD from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and POD is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, POD from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and POD is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q 
lnkBookingLocations.condition_POR_notNull.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.POR, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, POR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and POR is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, POR from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and POR is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.POR and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q 
lnkBookingLocations.condition_POR_Null.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.POR, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, POR from StagingAreaTest.stg.MSCRUS_BookDryPort where isDeleted = 0 and BOOK_NR  in (select distinct BOOK_NR from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and POR is null) union  select distinct BOOK_NR, SELSKAB, SrcSystemId, POR from StagingAreaTest.stg.UNITY_BookDryPort  where isDeleted = 0 and BOOK_NR  in (select distinct BOOK_NR from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and POR is null)) src on  hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on  hub2.locationCode = srcHub1.POR and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingLocations.condition_POR_Null_ForBothNull.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking,  src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and POR is null union select distinct BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and POR is null) src on  hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_PORT_TRANS.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.PORT_TRANS and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_PORT_TRANS2.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS2, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS2 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS2 is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS2 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS2 is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.PORT_TRANS2 and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS2, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS2 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS2 is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS2 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS2 is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_PORT_TRANS3.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS3, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS3 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS3 is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS3 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS3 is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.PORT_TRANS3 and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS3, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS3 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS3 is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS3 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS3 is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_PORT_TRANS4.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS4, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS4 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS4 is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS4 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS4 is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.PORT_TRANS4 and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS4, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS4 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS4 is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS4 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS4 is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_PORT_TRANS5.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS5, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS5 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS5 is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS5 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS5 is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.PORT_TRANS5 and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_TRANS5, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS5 from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_TRANS5 is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_TRANS5 from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_TRANS5 is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_FREIGHT_PAY.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.FREIGHT_PAY, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and FREIGHT_PAY is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and FREIGHT_PAY is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.FREIGHT_PAY and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.FREIGHT_PAY, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and FREIGHT_PAY is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and FREIGHT_PAY is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_FREIGHT_PAY_IMS.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.FREIGHT_PAY_IMS, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY_IMS from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and FREIGHT_PAY_IMS is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY_IMS from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and FREIGHT_PAY_IMS is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.FREIGHT_PAY_IMS and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.FREIGHT_PAY_IMS, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY_IMS from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and FREIGHT_PAY_IMS is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, FREIGHT_PAY_IMS from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and FREIGHT_PAY_IMS is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_DRY_PORT.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.DRY_PORT, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.MSCRUS_BookDryPort where isDeleted = 0 and DRY_PORT is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.UNITY_BookDryPort where isDeleted = 0 and DRY_PORT is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.DRY_PORT and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.DRY_PORT, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.MSCRUS_BookDryPort where isDeleted = 0 and DRY_PORT is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.UNITY_BookDryPort where isDeleted = 0 and DRY_PORT is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_PORT_SAIL.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_SAIL, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_SAIL from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_SAIL is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_SAIL from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_SAIL is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.PORT_SAIL and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_SAIL, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_SAIL from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_SAIL is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_SAIL from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_SAIL is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.condition_PORT_FEED.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_FEED, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_FEED from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_FEED is not null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_FEED from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_FEED is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.locationCode = srcHub1.PORT_FEED and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBooking, src.PORT_FEED, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_FEED from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and PORT_FEED is null union select distinct BOOK_NR, SELSKAB, SrcSystemId, PORT_FEED from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and PORT_FEED is null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingLocations.satLnk.CountRows =  select count (*) c from sat.satLnkBookingLocations
lnkBookingPPCCEE.lnk.CountRows =  select count (*) c from lin.lnkBookingPPCCEE
lnkBookingPPCCEE.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubPPCCEE, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubPPCCEE hub2 inner join (select hub1.dwhIdHubBooking, src.BET_KODE, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, BET_KODE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and BET_KODE is not null union select BOOK_NR, SELSKAB, SrcSystemId, BET_KODE from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and BET_KODE is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.paymentTermCode = srcHub1.BET_KODE union select distinct hub2.dwhIdHubPPCCEE, srcHub1.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubPPCCEE hub2 inner join (select hub1.dwhIdHubBooking, src.BET_KODE, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId, BET_KODE from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 and BET_KODE is  null union select BOOK_NR, SELSKAB, SrcSystemId, BET_KODE from StagingAreaTest.stg.UNITY_Book where isDeleted = 0 and BET_KODE is  null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubPPCCEE = -1 and hub2.srcSystemId = 0)q
lnkBookingPPCCEE.satLnk.CountRows =  select count (*) c from sat.satLnkBookingPPCCEE

lnkBookingCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingCompany
lnkBookingCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBooking, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBooking, src.SELSKAB, src.SrcSystemId from hub.hubBooking hub1 inner join (select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Book where isDeleted = 0 union select BOOK_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Book where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingCompany.satLnk.CountRows =  select count (*) c from sat.satLnkBookingCompany

lnkBookingBookingManifestAdditionals.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingManifestAdditionals
lnkBookingBookingManifestAdditionals.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifestAdditionals, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingManifestAdditionals, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingManifestAdditionals hub1 inner join (select BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDetails where isDeleted = 0 union select BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookDetails where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.segmentCode = src.SEGMENT_CODE and hub1.sequenceNr = src.SEQ_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingManifestAdditionals.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingManifestAdditionals

lnkBookingManifestAdditionalsCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingManifestAdditionalsCompany
lnkBookingManifestAdditionalsCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifestAdditionals, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingManifestAdditionals, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingManifestAdditionals hub1 inner join (select BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDetails where isDeleted = 0 union select BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookDetails where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.segmentCode = src.SEGMENT_CODE and hub1.sequenceNr = src.SEQ_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingManifestAdditionalsCompany.satLnk.CountRows =  select count (*) c from sat.satLnkBookingManifestAdditionalsCompany

lnkBookingBookingManifestedHaulage.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingManifestedHaulage
lnkBookingBookingManifestedHaulage.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifestedHaulage, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingManifestedHaulage, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingManifestedHaulage hub1 inner join (select BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDetailsMof where isDeleted = 0 union select BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookDetailsMof where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.sequenceNumber = src.SEQ_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingManifestedHaulage.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingManifestedHaulage

lnkBookingManifestedHaulageTransportMode.lnk.CountRows =  select count (*) c from lin.lnkBookingManifestedHaulageTransportMode
lnkBookingManifestedHaulageTransportMode.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifestedHaulage, hub2.dwhIdHubTransportMode, srcHub1.SrcSystemId from  hub.hubTransportMode hub2 inner join (select hub1.dwhIdHubBookingManifestedHaulage, src.SELSKAB, src.SrcSystemId, src.PRE_CARRIAGE_MODE from hub.hubBookingManifestedHaulage hub1 inner join (select BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId, PRE_CARRIAGE_MODE from StagingAreaTest.stg.MSCRUS_BookDetailsMof where isDeleted = 0 and PRE_CARRIAGE_MODE is not null union select  BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId, PRE_CARRIAGE_MODE from StagingAreaTest.stg.UNITY_BookDetailsMof where isDeleted = 0 and PRE_CARRIAGE_MODE is not null) src on  hub1.bookingNumber = src.BOOK_NR and  hub1.sequenceNumber = src.SEQ_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.transportModeCode = srcHub1.PRE_CARRIAGE_MODE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubBookingManifestedHaulage, hub2.dwhIdHubTransportMode, srcHub1.SrcSystemId from  hub.hubTransportMode hub2 inner join (select hub1.dwhIdHubBookingManifestedHaulage, src.SELSKAB, src.SrcSystemId, src.PRE_CARRIAGE_MODE from hub.hubBookingManifestedHaulage hub1 inner join (select BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId, PRE_CARRIAGE_MODE from StagingAreaTest.stg.MSCRUS_BookDetailsMof where isDeleted = 0 and PRE_CARRIAGE_MODE is null union select  BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId, PRE_CARRIAGE_MODE from StagingAreaTest.stg.UNITY_BookDetailsMof where isDeleted = 0 and PRE_CARRIAGE_MODE is null) src on hub1.bookingNumber = src.BOOK_NR and hub1.sequenceNumber = src.SEQ_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubTransportMode = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingManifestedHaulageTransportMode.satLnk.CountRows =  select count (*) c from sat.satLnkBookingManifestedHaulageTransportMode

lnkBookingManifestedHaulageCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingManifestedHaulageCompany
lnkBookingManifestedHaulageCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifestedHaulage, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingManifestedHaulage, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingManifestedHaulage hub1 inner join (select BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDetailsMof where isDeleted = 0 union select BOOK_NR, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookDetailsMof where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.sequenceNumber = src.SEQ_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingManifestedHaulageCompany.satLnk.CountRows = select count (*) c from sat.satLnkBookingManifestedHaulageCompany

lnkBookingBookingEvents.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingEvents
lnkBookingBookingEvents.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingEvents, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingEvents, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingEvents hub1 inner join (select SEQ, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.MSCRUS_BookEvent where isDeleted = 0 and BOOK_NR is not null union select SEQ, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.UNITY_BookEvent where isDeleted = 0 and BOOK_NR is not null) src on hub1.bookingEventId = src.SEQ and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingEvents.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingEvents

lnkBookingEventsCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingEventsCompany
lnkBookingEventsCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingEvents, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingEvents, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingEvents hub1 inner join (select SEQ, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.MSCRUS_BookEvent where isDeleted = 0 union select SEQ, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.UNITY_BookEvent where isDeleted = 0) src on hub1.bookingEventId = src.SEQ and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingEventsCompany.satLnk.CountRows = select count (*) c from sat.satlnkBookingEventsCompany

lnkBookingBookingCharges.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingCharges
lnkBookingBookingCharges.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCharges, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingCharges, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingCharges hub1 inner join (select BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookFak where isDeleted = 0 union select BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookFak where isDeleted = 0) src on hub1.bookingNr = src.BOOK_NR and hub1.positionNr = src.FRG_BT_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and  hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingCharges.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingCharges

lnkBookingChargesCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingChargesCompany
lnkBookingChargesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCharges, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingCharges, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingCharges hub1 inner join (select BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookFak where isDeleted = 0 union select BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookFak where isDeleted = 0) src on hub1.bookingNr = src.BOOK_NR and hub1.positionNr = src.FRG_BT_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingChargesCompany.satLnk.CountRows = select count (*) c from sat.satLnkBookingChargesCompany

lnkBookingBookingCargo.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingCargo
lnkBookingBookingCargo.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCargo, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingCargo, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and  hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingCargo.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingCargo

lnkBookingCargoBookingHaulageDetails.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoBookingHaulageDetails
lnkBookingCargoBookingHaulageDetails.condition.CountRows = select count (*) c from (select distinct hubBChubBHD.dwhIdHubBookingCargo, hubBChubBHD.dwhIdhubBookingHaulageDetails from sat.satBookingHaulageDetails satBHD inner join (select hubBHD.dwhIdHubBookingHaulageDetails, hubBC.dwhIdHubBookingCargo, hubBC.BOOK_NR, hubBC.VAREPOST_NR, hubBC.SELSKAB, hubBC.SrcSystemId from hub.hubBookingHaulageDetails hubBHD inner join (select hbc.dwhIdHubBookingCargo, src.BOOK_NR, src.VAREPOST_NR, src.SELSKAB, src.SrcSystemId from hub.hubBookingCargo hbc inner join (select distinct BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId from  StagingAreaTest.stg.UNITY_BookGods union select distinct BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId from  StagingAreaTest.stg.MSCRUS_BookGods) src on hbc.bookingNumber = src.BOOK_NR and hbc.cargoLineNr =  src.VAREPOST_NR and hbc.accessCompanyId = src.SELSKAB and hbc.srcSystemId = src.srcSystemId) hubBC on hubBHD.bookingNumber = hubBC.BOOK_NR and hubBHD.accessCompanyId = hubBC.SELSKAB and hubBHD.srcSystemId = hubBC.srcSystemId) hubBChubBHD on hubBChubBHD.dwhIdhubBookingHaulageDetails = satBHD.dwhIdhubBookingHaulageDetails and hubBChubBHD.VAREPOST_NR =satBHD.bookLineNr and hubBChubBHD.SrcSystemId = satBHD.srcSystemId)q
lnkBookingCargoBookingHaulageDetails.satLnk.CountRows =  select count (*) c from sat.satLnkBookingCargoBookingHaulageDetails
lnkBookingCargoBookingHaulageDetails.error.CountRows = select count (*) c from (select packageName, srcTablename, ErrorDate, description, BOOK_NR, VAREPOST_NR, SELSKAB  from etl.errLogLnkDataVault where packageName like '%lnkBookingCargoBookingHaulageDetails%')q

lnkBookingCargoContainerType.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoContainerType
lnkBookingCargoContainerType.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubContainerType, srcHub1.dwhIdHubBookingCargo, srcHub1.SrcSystemId from  hub.hubContainerType hub2 inner join (select hub1.dwhIdHubBookingCargo, src.CONT_TYPE, src.SELSKAB, src.SrcSystemId from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, CONT_TYPE from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and CONT_TYPE is not null union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, CONT_TYPE from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and CONT_TYPE is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.cargoLineNr  = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and  hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.containerTypeCode = srcHub1.CONT_TYPE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubContainerType, srcHub1.dwhIdHubBookingCargo, srcHub1.SrcSystemId from  hub.hubContainerType hub2 inner join (select hub1.dwhIdHubBookingCargo, src.CONT_TYPE, src.SELSKAB, src.SrcSystemId from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, CONT_TYPE from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and CONT_TYPE is  null union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, CONT_TYPE from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and CONT_TYPE is  null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.cargoLineNr  = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on  hub2.dwhIdHubContainerType = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingCargoContainerType.satLnk.CountRows =  select count (*) c from sat.satLnkBookingCargoContainerType

lnkBookingCargoFullEmpty.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoFullEmpty
lnkBookingCargoFullEmptyE.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCargo, hub2.dwhIdHubFullEmpty, srcHub1.SrcSystemId from  hub.hubFullEmpty hub2 inner join (select hub1.dwhIdHubBookingCargo, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, TRP_MADE1, TRP_MADE2  from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and (TRP_MADE1='MTY' or TRP_MADE2='MTY') union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, TRP_MADE1, TRP_MADE2  from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and (TRP_MADE1='MTY' or TRP_MADE2='MTY') ) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.fillingStatus = 'E' )q
lnkBookingCargoFullEmptyF.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCargo, hub2.dwhIdHubFullEmpty, srcHub1.SrcSystemId from  hub.hubFullEmpty hub2 inner join (select hub1.dwhIdHubBookingCargo, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, TRP_MADE1, TRP_MADE2  from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and (TRP_MADE1 !='MTY' and TRP_MADE2 !='MTY') union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, TRP_MADE1, TRP_MADE2  from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and (TRP_MADE1 !='MTY' and TRP_MADE2 !='MTY')) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.fillingStatus = 'F')q
lnkBookingCargoFullEmpty.satLnk.CountRows = select count (*) c from sat.satLnkBookingCargoFullEmpty

lnkBookingCargoLocations.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoLocations
lnkBookingCargoLocations.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBookingCargo, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBookingCargo, src.DRY_PORT, src.SELSKAB, src.SrcSystemId from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and DRY_PORT is not null union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and DRY_PORT is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.cargoLineNr  = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and  hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.DRY_PORT and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubBookingCargo, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubBookingCargo, src.DRY_PORT, src.SELSKAB, src.SrcSystemId from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 and DRY_PORT is  null union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId, DRY_PORT from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0 and DRY_PORT is  null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.cargoLineNr  = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingCargoLocations.satLnk.CountRows =  select count (*) c from sat.satLnkBookingCargoLocations

lnkBookingCargoCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingCargoCompany
lnkBookingCargoCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCargo, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingCargo, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingCargo hub1 inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookGods where isDeleted = 0 union select BOOK_NR, VAREPOST_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookGods where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.cargoLineNr = src.VAREPOST_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q  
lnkBookingCargoCompany.satLnk.CountRows = select count (*) c from sat.satLnkBookingCargoCompany

lnkBookingHaulageDetailsCustomers.lnk.CountRows =  select count (*) c from lin.lnkBookingHaulageDetailsCustomers
lnkBookingHaulageDetailsCustomers.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingHaulageDetails, hub2.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCustomers hub2 inner join (select hub1.dwhIdHubBookingHaulageDetails, src.SELSKAB, src.SrcSystemId, src.KUNDE from hub.hubBookingHaulageDetails hub1 inner join (select BOOK_NR, LOBE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.MSCRUS_BookKor where isDeleted = 0 and KUNDE is not null union select BOOK_NR, LOBE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.UNITY_BookKor where isDeleted = 0 and KUNDE is not null ) src on  hub1.bookingNumber = src.BOOK_NR and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.customerNr = srcHub1.KUNDE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubBookingHaulageDetails, hub2.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCustomers hub2 inner join (select hub1.dwhIdHubBookingHaulageDetails, src.SELSKAB, src.SrcSystemId, src.KUNDE from hub.hubBookingHaulageDetails hub1 inner join (select BOOK_NR, LOBE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.MSCRUS_BookKor where isDeleted = 0 and KUNDE is null union select BOOK_NR, LOBE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.UNITY_BookKor where isDeleted = 0 and KUNDE is  null) src on  hub1.bookingNumber = src.BOOK_NR and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on  hub2.dwhIdHubCustomers = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingHaulageDetailsCustomers.satLnk.CountRows =  select count (*) c from sat.satLnkBookingHaulageDetailsCustomers

lnkBookingHaulageDetailsCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingHaulageDetailsCompany
lnkBookingHaulageDetailsCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingHaulageDetails, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingHaulageDetails, src.SELSKAB, src.SrcSystemId from hub.hubBookingHaulageDetails hub1 inner join (select BOOK_NR, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookKor where isDeleted = 0 union select BOOK_NR, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookKor where isDeleted = 0 ) src on hub1.bookingNumber = src.BOOK_NR and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingHaulageDetailsCompany.satLnk.CountRows = select count (*) c from sat.satLnkBookingHaulageDetailsCompany

lnkBookingChargeLinesCurrency.lnk.CountRows =  select count (*) c from lin.lnkBookingChargeLinesCurrency
lnkBookingChargeLinesCurrency.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingChargeLines, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubBookingChargeLines, src.SELSKAB, src.SrcSystemId, src.OMR_VALUTA from hub.hubBookingChargeLines hub1 inner join (select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId, OMR_VALUTA from StagingAreaTest.stg.MSCRUS_BookLin where isDeleted = 0 and OMR_VALUTA is not null union select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId, OMR_VALUTA from StagingAreaTest.stg.UNITY_BookLin where isDeleted = 0 and OMR_VALUTA is not null) src on  hub1.bookingNumber = src.BOOK_NR and hub1.positionNr = src.FRG_BT_NR and hub1.lineNr = src.LINIE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.OMR_VALUTA and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubBookingChargeLines, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubBookingChargeLines, src.SELSKAB, src.SrcSystemId, src.OMR_VALUTA from hub.hubBookingChargeLines hub1 inner join (select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId, OMR_VALUTA from StagingAreaTest.stg.MSCRUS_BookLin where isDeleted = 0 and OMR_VALUTA is  null union select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId, OMR_VALUTA from StagingAreaTest.stg.UNITY_BookLin where isDeleted = 0 and OMR_VALUTA is null) src on hub1.bookingNumber = src.BOOK_NR and hub1.positionNr = src.FRG_BT_NR and hub1.lineNr = src.LINIE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCurrency = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingChargeLinesCurrency.satLnk.CountRows =  select count (*) c from sat.satLnkBookingChargeLinesCurrency

lnkBookingChargesBookingChargeLines.lnk.CountRows =  select count (*) c from lin.lnkBookingChargesBookingChargeLines
lnkBookingChargesBookingChargeLines.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingChargeLines, hub2.dwhIdHubBookingCharges, srcHub1.SrcSystemId from  hub.hubBookingCharges hub2 inner join (select hub1.dwhIdHubBookingChargeLines, src.SELSKAB, src.SrcSystemId, src.BOOK_NR, src.FRG_BT_NR from hub.hubBookingChargeLines hub1 inner join (select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookLin where isDeleted = 0 union select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookLin where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.positionNr = src.FRG_BT_NR and hub1.lineNr = src.LINIE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNr = srcHub1.BOOK_NR and hub2.positionNr = srcHub1.FRG_BT_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingChargesBookingChargeLines.satLnk.CountRows =  select count (*) c from sat.satLnkBookingChargesBookingChargeLines

lnkBookingChargeLinesCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingChargeLinesCompany
lnkBookingChargeLinesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingChargeLines, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingChargeLines, src.SELSKAB, src.SrcSystemId, src.BOOK_NR, src.FRG_BT_NR from hub.hubBookingChargeLines hub1 inner join (select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookLin where isDeleted = 0 union select BOOK_NR, FRG_BT_NR, LINIE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookLin where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and  hub1.positionNr = src.FRG_BT_NR and hub1.lineNr = src.LINIE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q  
lnkBookingChargeLinesCompany.satLnk.CountRows = select count (*) c from sat.satLnkBookingChargeLinesCompany

lnkBookingBookingManifest.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingManifest
lnkBookingBookingManifest.condition.CountRows =select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifest, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingManifest, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingManifest hub1 inner join (select BOOK_MFT_ID, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.MSCRUS_BookManifests where isDeleted = 0 union select BOOK_MFT_ID, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.UNITY_BookManifests where isDeleted = 0) src on hub1.bookMftId = src.BOOK_MFT_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingManifest.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingManifest

lnkBookingBookingManifestShadowCopy.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingManifestShadowCopy
lnkBookingBookingManifestShadowCopy.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifest, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingManifest, src.SELSKAB, src.SrcSystemId, src.REF_BOOK_NR from hub.hubBookingManifest hub1 inner join (select BOOK_MFT_ID, SELSKAB, SrcSystemId, REF_BOOK_NR from StagingAreaTest.stg.MSCRUS_BookManifests where isDeleted = 0 union select BOOK_MFT_ID, SELSKAB, SrcSystemId, REF_BOOK_NR from StagingAreaTest.stg.UNITY_BookManifests where isDeleted = 0) src on hub1.bookMftId = src.BOOK_MFT_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.REF_BOOK_NR and hub2.accessCompanyID <100 and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingManifestShadowCopy.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingManifestShadowCopy

lnkBookingManifestBookingDTXFile.lnk.CountRows =  select count (*) c from lin.lnkBookingManifestBookingDTXFile
lnkBookingManifestBookingDTXFile.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifest, hub2.dwhIdHubBookingDTXFile, srcHub1.SrcSystemId from  hub.hubBookingDTXFile hub2 inner join (select hub1.dwhIdHubBookingManifest, src.SELSKAB, src.SrcSystemId, src.MFT_FILE_ID from hub.hubBookingManifest hub1 inner join (select BOOK_MFT_ID, SELSKAB, SrcSystemId, MFT_FILE_ID from StagingAreaTest.stg.MSCRUS_BookManifests where isDeleted = 0 union select BOOK_MFT_ID, SELSKAB, SrcSystemId, MFT_FILE_ID from StagingAreaTest.stg.UNITY_BookManifests where isDeleted = 0) src on hub1.bookMftId = src.BOOK_MFT_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.manifestFileId = srcHub1.MFT_FILE_ID and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingManifestBookingDTXFile.satLnk.CountRows =  select count (*) c from sat.satLnkBookingManifestBookingDTXFile
lnkBookingManifestBookingDTXFile.error.CountRows = select count(*) c from (select packageName, srcTablename, ErrorDate, description, BOOK_MFT_ID, SELSKAB  from etl.errLogLnkDataVault where packageName like '%lnkBookingManifestBookingDTXFile%')q

lnkBookingManifestCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingManifestCompany
lnkBookingManifestCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingManifest, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingManifest, src.SELSKAB, src.SrcSystemId, src.MFT_FILE_ID from hub.hubBookingManifest hub1 inner join (select BOOK_MFT_ID, SELSKAB, SrcSystemId, MFT_FILE_ID from StagingAreaTest.stg.MSCRUS_BookManifests where isDeleted = 0 union select BOOK_MFT_ID, SELSKAB, SrcSystemId, MFT_FILE_ID from StagingAreaTest.stg.UNITY_BookManifests where isDeleted = 0) src on hub1.bookMftId = src.BOOK_MFT_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q  
lnkBookingManifestCompany.satLnk.CountRows = select count (*) c from sat.satLnkBookingManifestCompany

lnkBookingDTXFileCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingDTXFileCompany
lnkBookingDTXFileCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingDTXFile, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingDTXFile, src.SELSKAB, src.SrcSystemId, src.MFT_FILE_ID from hub.hubBookingDTXFile hub1 inner join (select MFT_FILE_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookMftFile where isDeleted = 0 union select MFT_FILE_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookMftFile where isDeleted = 0) src on hub1.manifestFileId = src.MFT_FILE_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingDTXFileCompany.satLnk.CountRows = select count (*) c from sat.satLnkBookingDTXFileCompany

lnkBookingEMCRemarksBookingManifest.lnk.CountRows =  select count (*) c from lin.lnkBookingEMCRemarksBookingManifest
lnkBookingEMCRemarksBookingManifest.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingEMCRemarks, hub2.dwhIdHubBookingManifest, srcHub1.SrcSystemId from hub.hubBookingManifest hub2 inner join (select hub1.dwhIdHubBookingEMCRemarks, src.SELSKAB, src.SrcSystemId, src.BOOK_MFT_ID from hub.hubBookingEMCRemarks hub1 inner join (select BOOK_MFT_ID, SEQ, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookMftRemarks where isDeleted = 0 union select BOOK_MFT_ID, SEQ, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookMftRemarks where isDeleted = 0) src on hub1.manifestFileId = src.BOOK_MFT_ID and hub1.remarkId = src.SEQ and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookMftId = srcHub1.BOOK_MFT_ID and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingEMCRemarksBookingManifest.satLnk.CountRows =  select count (*) c from sat.satLnkBookingEMCRemarksBookingManifest

lnkBookingEMCRemarksCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingEMCRemarksCompany
lnkBookingEMCRemarksCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingEMCRemarks, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingEMCRemarks, src.SELSKAB, src.SrcSystemId  from hub.hubBookingEMCRemarks hub1 inner join (select BOOK_MFT_ID, SEQ, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookMftRemarks where isDeleted = 0 union select BOOK_MFT_ID, SEQ, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookMftRemarks where isDeleted = 0) src on hub1.manifestFileId = src.BOOK_MFT_ID and hub1.remarkId = src.SEQ and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingEMCRemarksCompany.satLnk.CountRows = select count (*) c from sat.satLnkBookingEMCRemarksCompany

lnkBookingBookingOceanVessel.lnk.CountRows =  select count (*) c from lin.lnkBookingBookingOceanVessel
lnkBookingBookingOceanVessel.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingOceanVessel, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubBookingOceanVessel, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingOceanVessel hub1 inner join (select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookVessel where isDeleted = 0 union select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookVessel where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.bookVesselId = src.BOOK_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkBookingBookingOceanVessel.satLnk.CountRows =  select count (*) c from sat.satLnkBookingBookingOceanVessel

lnkBookingOceanVesselExportVessels.lnk.CountRows =  select count (*) c from lin.lnkBookingOceanVesselExportVessels
lnkBookingOceanVesselExportVessels.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubExportVessels, srcHub1.dwhIdHubBookingOceanVessel, srcHub1.SrcSystemId from  hub.hubExportVessels hub2 inner join (select hub1.dwhIdHubBookingOceanVessel, src.EXP_VESSEL_ID, src.SELSKAB, src.SrcSystemId from hub.hubBookingOceanVessel hub1 inner join (select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId, EXP_VESSEL_ID from StagingAreaTest.stg.MSCRUS_BookVessel where isDeleted = 0 and EXP_VESSEL_ID is not null union select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId, EXP_VESSEL_ID from StagingAreaTest.stg.UNITY_BookVessel where isDeleted = 0 and EXP_VESSEL_ID is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.bookVesselId = src.BOOK_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.expVesselId = srcHub1.EXP_VESSEL_ID and hub2.srcSystemId = srcHub1.SrcSystemId )q
lnkBookingOceanVesselExportVessels.satLnk.CountRows =  select count (*) c from sat.satLnkBookingOceanVesselExportVessels

lnkBookingOceanVesselOceanVesselStatus.lnk.CountRows =  select count (*) c from lin.lnkBookingOceanVesselOceanVesselStatus
lnkBookingOceanVesselOceanVesselStatus.condition.CountRows =select count (*) c from (select distinct hub2.dwhIdHubOceanVesselStatus, srcHub1.dwhIdHubBookingOceanVessel, srcHub1.SrcSystemId from  hub.hubOceanVesselStatus hub2 inner join (select hub1.dwhIdHubBookingOceanVessel, src.STATUS, src.SELSKAB, src.SrcSystemId from hub.hubBookingOceanVessel hub1 inner join (select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId, STATUS from StagingAreaTest.stg.MSCRUS_BookVessel where isDeleted = 0 and STATUS is not null union select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId, STATUS from StagingAreaTest.stg.UNITY_BookVessel where isDeleted = 0 and STATUS is not null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.bookVesselId  = src.BOOK_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.statusCode = srcHub1.STATUS and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubOceanVesselStatus, srcHub1.dwhIdHubBookingOceanVessel, srcHub1.SrcSystemId from  hub.hubOceanVesselStatus hub2 inner join (select hub1.dwhIdHubBookingOceanVessel, src.STATUS, src.SELSKAB, src.SrcSystemId from hub.hubBookingOceanVessel hub1 inner join (select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId, STATUS from StagingAreaTest.stg.MSCRUS_BookVessel where isDeleted = 0 and STATUS is  null union select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId, STATUS from StagingAreaTest.stg.UNITY_BookVessel where isDeleted = 0 and STATUS is  null) src on hub1.bookingNumber =  src.BOOK_NR and hub1.bookVesselId  = src.BOOK_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and  hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubOceanVesselStatus = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkBookingOceanVesselOceanVesselStatus.satLnk.CountRows =  select count (*) c from sat.satLnkBookingOceanVesselOceanVesselStatus

lnkBookingOceanVesselCompany.lnk.CountRows =  select count (*) c from lin.lnkBookingOceanVesselCompany
lnkBookingOceanVesselCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingOceanVessel, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubBookingOceanVessel, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubBookingOceanVessel hub1 inner join (select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookVessel where isDeleted = 0 union select BOOK_NR, BOOK_VESSEL_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookVessel where isDeleted = 0) src on hub1.bookingNumber = src.BOOK_NR and hub1.bookVesselId = src.BOOK_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q  
lnkBookingOceanVesselCompany.satLnk.CountRows = select count (*) c from sat.satLnkBookingOceanVesselCompany

lnkWeekendsHolidaysCompany.lnk.CountRows =  select count (*) c from lin.lnkWeekendsHolidaysCompany
lnkWeekendsHolidaysCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubWeekendsHolidays, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubWeekendsHolidays, src.SELSKAB, src.SrcSystemId from hub.hubWeekendsHolidays hub1 inner join (select AFDELING, DATO, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_ContHolliday where isDeleted = 0 union select AFDELING, DATO, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_ContHolliday where isDeleted = 0) src on hub1.serviceCode = src.AFDELING and hub1.date = src.DATO and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkWeekendsHolidaysCompany.satLnk.CountRows = select count (*) c from sat.satLnkWeekendsHolidaysCompany

lnkContainerMovesBooking.lnk.CountRows =  select count (*) c from lin.lnkContainerMovesBooking
lnkContainerMovesBooking.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerMoves, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubContainerMoves, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubContainerMoves hub1 inner join (select LOBE_NR, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.MSCRUS_ContRep where isDeleted = 0 and BOOK_NR is not null union select LOBE_NR, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.UNITY_ContRep where isDeleted = 0 and BOOK_NR is not null) src on hub1.moveId = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.BOOK_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkContainerMovesBooking.satLnk.CountRows =  select count (*) c from sat.satLnkContainerMovesBooking

lnkContainerMovesContainerLocation.lnk.CountRows =  select count (*) c from lin.lnkContainerMovesContainerLocation
lnkContainerMovesContainerLocation.condition.CountRows =select count (*) c from (select distinct srcHub1.dwhIdHubContainerMoves, hub2.dwhIdHubContainerLocation, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubContainerMoves, src.SELSKAB, src.SrcSystemId, src.LOC from hub.hubContainerMoves hub1 inner join (select LOBE_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.MSCRUS_ContRep where isDeleted = 0 and LOC is not null union select LOBE_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.UNITY_ContRep where isDeleted = 0 and LOC is not null) src on hub1.moveId = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.containerLocationCode = srcHub1.LOC and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubContainerMoves, hub2.dwhIdHubContainerLocation, srcHub1.SrcSystemId from  hub.hubContainerLocation hub2 inner join (select hub1.dwhIdHubContainerMoves, src.SELSKAB, src.SrcSystemId, src.LOC from hub.hubContainerMoves hub1 inner join (select LOBE_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.MSCRUS_ContRep where isDeleted = 0 and LOC is null union select LOBE_NR, SELSKAB, SrcSystemId, LOC from StagingAreaTest.stg.UNITY_ContRep where isDeleted = 0 and LOC is null) src on hub1.moveId = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on  hub2.dwhIdHubContainerLocation = -1 and  hub2.accessCompanyId =  -1 and  hub2.srcSystemId = 0)q
lnkContainerMovesContainerLocation.satLnk.CountRows =  select count (*) c from sat.satLnkContainerMovesContainerLocation

lnkContainerMovesCompany.lnk.CountRows =  select count (*) c from lin.lnkContainerMovesCompany
lnkContainerMovesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerMoves, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubContainerMoves, src.SELSKAB, src.SrcSystemId, src.BOOK_NR from hub.hubContainerMoves hub1 inner join (select LOBE_NR, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.MSCRUS_ContRep where isDeleted = 0 union select LOBE_NR, SELSKAB, SrcSystemId, BOOK_NR from StagingAreaTest.stg.UNITY_ContRep where isDeleted = 0) src on hub1.moveId = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q 
lnkContainerMovesCompany.satLnk.CountRows = select count (*) c from sat.satLnkContainerMovesCompany

lnkControllingOfficeLocations.lnk.CountRows =  select count (*) c from lin.lnkControllingOfficeLocations
lnkControllingOfficeLocations.condition.CountRows = select count (*) c from(select distinct dwhIdHubLocations, dwhIdHubControllingOffice from (select distinct hubL.dwhIdHubLocations, hubCO1.dwhIdHubControllingOffice from hub.hubLocations hubL inner join (select  hubCO.dwhIdHubControllingOffice, src.COMPANY_ID, src.OFFICE_ID, src.Location_Code from hub.hubControllingOffice hubCO inner join (select distinct q.COMPANY_ID, q.OFFICE_ID, q.Location_Code from (select distinct COMPANY_ID, ISNULL (OFFICE_ID, 0) as OFFICE_ID, Location_Code from StagingAreaTest.stg.EXCEL_ControllingOfficeLocationCode where Office_ID is null union select distinct COMPANY_ID,  OFFICE_ID, Location_Code from StagingAreaTest.stg.EXCEL_ControllingOfficeLocationCode where Office_ID is not null)q) src on src.COMPANY_ID = hubCO.companyId and src.OFFICE_ID = hubCO.officeId and src.Location_Code is not null) hubCO1 on hubCO1.LOCATION_CODE = hubL.locationCode and hubCO1.COMPANY_ID = hubL.accessCompanyId union select distinct hubL.dwhIdHubLocations, hubCO1.dwhIdHubControllingOffice from hub.hubLocations hubL inner join (select  hubCO.dwhIdHubControllingOffice, src.COMPANY_ID, src.OFFICE_ID, src.Location_Code from hub.hubControllingOffice hubCO inner join (select distinct q.COMPANY_ID, q.OFFICE_ID, q.Location_Code from (select distinct COMPANY_ID, ISNULL (OFFICE_ID, 0) as OFFICE_ID, Location_Code from StagingAreaTest.stg.EXCEL_ControllingOfficeLocationCode where Office_ID is null union select distinct COMPANY_ID,  OFFICE_ID, Location_Code from StagingAreaTest.stg.EXCEL_ControllingOfficeLocationCode where Office_ID is not null)q) src on src.COMPANY_ID = hubCO.companyId and src.OFFICE_ID = hubCO.officeId and src.Location_Code is null) hubCO1 on hubCO1.COMPANY_ID = hubL.accessCompanyId and hubL.dwhIdHubLocations = -1)un)q
lnkControllingOfficeLocations.satLnk.CountRows =  select count (*) c from sat.satLnkControllingOfficeLocations

lnkContainerTypeContainerTypeSpecEquip.lnk.CountRows =  select count (*) c from lin.lnkContainerTypeContainerTypeSpecEquip
lnkContainerTypeContainerTypeSpecEquip.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubContainerTypeSpecEquip, srcHub1.SrcSystemId from  hub.hubContainerTypeSpecEquip hub2 inner join (select hub1.dwhIdHubContainerType, src.SELSKAB, src.SrcSystemId, src.CONT_FEET, src.CONT_SIZE, src.CONT_TYPE, src.TEKST from hub.hubContainerType hub1 inner join (select KODE, SELSKAB, SrcSystemId, CONT_FEET, CONT_SIZE, CONT_TYPE, TEKST from StagingAreaTest.stg.MSCRUS_ContType where isDeleted = 0 union select KODE, SELSKAB, SrcSystemId, CONT_FEET, CONT_SIZE, CONT_TYPE, TEKST from StagingAreaTest.stg.UNITY_ContType where isDeleted = 0) src on hub1.containerTypeCode = src.KODE and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.contFeet = srcHub1.CONT_FEET and hub2.contSize = srcHub1.CONT_SIZE and hub2.contType = srcHub1.CONT_TYPE and hub2.contTypeName = srcHub1.TEKST )q
lnkContainerTypeContainerTypeSpecEquip.satLnk.CountRows =  select count (*) c from sat.satLnkContainerTypeContainerTypeSpecEquip

lnkContainerTypeIsoCode.lnk.CountRows =  select count (*) c from lin.lnkContainerTypeIsoCode
lnkContainerTypeIsoCode.isoCode4_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubIsoCode, hub2.isoCodeRole from hub.hubIsoCode hub2 inner join (select hub1.dwhIdHubContainerType, src.ISO_KODE4, src.SELSKAB, src.SrcSystemId from hub.hubContainerType hub1 inner join (SELECT distinct ISO_KODE4, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE4 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE4, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE4 IS NOT NULL and IsDeleted = 0) src on hub1.containerTypeCode =  src.KODE and hub1.accessCompanyId =  src.SELSKAB and hub1.srcSystemId =  src.SrcSystemId) srcHub1 on hub2.isoCode = srcHub1.ISO_KODE4 and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId and hub2.isoCodeRole ='ISO_KODE4')q
lnkContainerTypeIsoCode.isoCode6_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubIsoCode, hub2.isoCodeRole from hub.hubIsoCode hub2 inner join (select hub1.dwhIdHubContainerType, src.ISO_KODE6, src.SELSKAB, src.SrcSystemId from hub.hubContainerType hub1 inner join (SELECT distinct ISO_KODE6, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6 IS NOT NULL and IsDeleted = 0) src on hub1.containerTypeCode =  src.KODE and hub1.accessCompanyId =  src.SELSKAB and hub1.srcSystemId =  src.SrcSystemId) srcHub1 on hub2.isoCode = srcHub1.ISO_KODE6 and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId and hub2.isoCodeRole ='ISO_KODE6')q
lnkContainerTypeIsoCode.isoCode6_2_condition.CountRows =  select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubIsoCode, hub2.isoCodeRole from hub.hubIsoCode hub2 inner join (select hub1.dwhIdHubContainerType, src.ISO_KODE6_2, src.SELSKAB, src.SrcSystemId from hub.hubContainerType hub1 inner join (SELECT distinct ISO_KODE6_2, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_2 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_2, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_2 IS NOT NULL and IsDeleted = 0) src on hub1.containerTypeCode =  src.KODE and hub1.accessCompanyId =  src.SELSKAB and hub1.srcSystemId =  src.SrcSystemId) srcHub1 on hub2.isoCode = srcHub1.ISO_KODE6_2 and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId and hub2.isoCodeRole ='ISO_KODE6_2')q
lnkContainerTypeIsoCode.isoCode6_3_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubIsoCode, hub2.isoCodeRole from hub.hubIsoCode hub2 inner join (select hub1.dwhIdHubContainerType, src.ISO_KODE6_3, src.SELSKAB, src.SrcSystemId from hub.hubContainerType hub1 inner join (SELECT distinct ISO_KODE6_3, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_3 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_3, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_3 IS NOT NULL and IsDeleted = 0) src on hub1.containerTypeCode =  src.KODE and hub1.accessCompanyId =  src.SELSKAB and hub1.srcSystemId =  src.SrcSystemId) srcHub1 on hub2.isoCode = srcHub1.ISO_KODE6_3 and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId and hub2.isoCodeRole ='ISO_KODE6_3')q
lnkContainerTypeIsoCode.isoCode6_4_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubIsoCode, hub2.isoCodeRole from hub.hubIsoCode hub2 inner join (select hub1.dwhIdHubContainerType, src.ISO_KODE6_4, src.SELSKAB, src.SrcSystemId from hub.hubContainerType hub1 inner join (SELECT distinct ISO_KODE6_4, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_4 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_4, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_4 IS NOT NULL and IsDeleted = 0) src on hub1.containerTypeCode =  src.KODE and hub1.accessCompanyId =  src.SELSKAB and hub1.srcSystemId =  src.SrcSystemId) srcHub1 on hub2.isoCode = srcHub1.ISO_KODE6_4 and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId and hub2.isoCodeRole ='ISO_KODE6_4')q
lnkContainerTypeIsoCode.isoCode6_5_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubIsoCode, hub2.isoCodeRole from hub.hubIsoCode hub2 inner join (select hub1.dwhIdHubContainerType, src.ISO_KODE6_5, src.SELSKAB, src.SrcSystemId from hub.hubContainerType hub1 inner join (SELECT distinct ISO_KODE6_5, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_5 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_5, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_5 IS NOT NULL and IsDeleted = 0) src on hub1.containerTypeCode =  src.KODE and hub1.accessCompanyId =  src.SELSKAB and hub1.srcSystemId =  src.SrcSystemId) srcHub1 on hub2.isoCode = srcHub1.ISO_KODE6_5 and hub2.accessCompanyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId and hub2.isoCodeRole ='ISO_KODE6_5')q
lnkContainerTypeIsoCode.satLnk.CountRows =  select count (*) c from sat.satLnkContainerTypeIsoCode

lnkIsoCodeCompany.lnk.CountRows =  select count (*) c from lin.lnkIsoCodeCompany
lnkIsoCodeCompany.isoCode4_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubIsoCode, hub2.dwhIdHubCompany, srcHub1.isoCodeRole from hub.hubCompany hub2 inner join (select  hub1.dwhIdHubIsoCode, hub1.isoCodeRole, src.SELSKAB, src.srcSystemId, src.ISO_KODE4 from hub.hubIsoCode hub1 inner join (SELECT distinct ISO_KODE4, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE4 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE4, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE4 IS NOT NULL and IsDeleted = 0 ) src on hub1.isoCode = src.ISO_KODE4 and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.SrcSystemId and hub1.isoCodeRole ='ISO_KODE4') srcHub1 on hub2.CompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkIsoCodeCompany.isoCode6_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubIsoCode, hub2.dwhIdHubCompany, srcHub1.isoCodeRole from hub.hubCompany hub2 inner join (select  hub1.dwhIdHubIsoCode, hub1.isoCodeRole, src.SELSKAB, src.srcSystemId, src.ISO_KODE6 from hub.hubIsoCode hub1 inner join (SELECT distinct ISO_KODE6, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6 IS NOT NULL and IsDeleted = 0 ) src on hub1.isoCode = src.ISO_KODE6 and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.SrcSystemId and hub1.isoCodeRole ='ISO_KODE6') srcHub1 on hub2.CompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkIsoCodeCompany.isoCode6_2_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubIsoCode, hub2.dwhIdHubCompany, srcHub1.isoCodeRole from hub.hubCompany hub2 inner join (select  hub1.dwhIdHubIsoCode, hub1.isoCodeRole, src.SELSKAB, src.srcSystemId, src.ISO_KODE6_2 from hub.hubIsoCode hub1 inner join (SELECT distinct ISO_KODE6_2, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_2 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_2, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_2 IS NOT NULL and IsDeleted = 0 ) src on hub1.isoCode = src.ISO_KODE6_2 and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.SrcSystemId and hub1.isoCodeRole ='ISO_KODE6_2') srcHub1 on hub2.CompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkIsoCodeCompany.isoCode6_3_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubIsoCode, hub2.dwhIdHubCompany, srcHub1.isoCodeRole from hub.hubCompany hub2 inner join (select  hub1.dwhIdHubIsoCode, hub1.isoCodeRole, src.SELSKAB, src.srcSystemId, src.ISO_KODE6_3 from hub.hubIsoCode hub1 inner join (SELECT distinct ISO_KODE6_3, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_3 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_3, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_3 IS NOT NULL and IsDeleted = 0 ) src on hub1.isoCode = src.ISO_KODE6_3 and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.SrcSystemId and hub1.isoCodeRole ='ISO_KODE6_3') srcHub1 on hub2.CompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkIsoCodeCompany.isoCode6_4_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubIsoCode, hub2.dwhIdHubCompany, srcHub1.isoCodeRole from hub.hubCompany hub2 inner join (select  hub1.dwhIdHubIsoCode, hub1.isoCodeRole, src.SELSKAB, src.srcSystemId, src.ISO_KODE6_4 from hub.hubIsoCode hub1 inner join (SELECT distinct ISO_KODE6_4, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_4 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_4, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_4 IS NOT NULL and IsDeleted = 0 ) src on hub1.isoCode = src.ISO_KODE6_4 and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.SrcSystemId and hub1.isoCodeRole ='ISO_KODE6_4') srcHub1 on hub2.CompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkIsoCodeCompany.isoCode6_5_condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubIsoCode, hub2.dwhIdHubCompany, srcHub1.isoCodeRole from hub.hubCompany hub2 inner join (select  hub1.dwhIdHubIsoCode, hub1.isoCodeRole, src.SELSKAB, src.srcSystemId, src.ISO_KODE6_5 from hub.hubIsoCode hub1 inner join (SELECT distinct ISO_KODE6_5, SELSKAB, srcSystemId, KODE FROM StagingAreaTest.stg.UNITY_ContType WHERE ISO_KODE6_5 IS NOT NULL and IsDeleted = 0 union SELECT distinct ISO_KODE6_5, SELSKAB, srcSystemId, KODE  FROM StagingAreaTest.stg.MSCRUS_ContType WHERE ISO_KODE6_5 IS NOT NULL and IsDeleted = 0 ) src on hub1.isoCode = src.ISO_KODE6_5 and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.SrcSystemId and hub1.isoCodeRole ='ISO_KODE6_5') srcHub1 on hub2.CompanyId =  srcHub1.SELSKAB and hub2.srcSystemId =  srcHub1.SrcSystemId)q
lnkIsoCodeCompany.satLnk.CountRows = select count (*) c from sat.satLnkIsoCodeCompany

lnkContainerTypeCompany.lnk.CountRows =  select count (*) c from lin.lnkContainerTypeCompany
lnkContainerTypeCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerType, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubContainerType, src.SELSKAB, src.SrcSystemId from hub.hubContainerType hub1 inner join (select KODE, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_ContType where isDeleted = 0 union select KODE, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_ContType where isDeleted = 0) src on hub1.containerTypeCode = src.KODE and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkContainerTypeCompany.satLnk.CountRows = select count (*) c from sat.satLnkContainerTypeCompany

lnkOceanVesselServiceCompany.lnk.CountRows =  select count (*) c from lin.lnkOceanVesselServiceCompany
lnkOceanVesselServiceCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubOceanVesselService, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubOceanVesselService, src.SELSKAB, src.SrcSystemId from hub.hubOceanVesselService hub1 inner join (select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_EdiKonv where isDeleted = 0 union select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_EdiKonv where isDeleted = 0) src on hub1.carrierCode = src.AGENT and hub1.serviceCode = src.FELT and hub1.shortName = src.FRA and hub1.fullName = src.TIL and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkOceanVesselServiceCompany.satLnk.CountRows = select count (*) c from sat.satLnkOceanVesselServiceCompany

lnkImsChargeLinesCompany.lnk.CountRows =  select count (*) c from lin.lnkImsChargeLinesCompany
lnkImsChargeLinesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubImsChargeLines, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubImsChargeLines, src.SELSKAB, src.SrcSystemId from hub.hubImsChargeLines hub1 inner join (select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_EdiKonv where isDeleted = 0 union  select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_EdiKonv where isDeleted = 0) src on hub1.carrierCode = src.AGENT and hub1.imsCode = src.FELT and hub1.xmlTag  = src.FRA and hub1.chargeLineNr = src.TIL and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkImsChargeLinesCompany.satLnk.CountRows = select count (*) c from sat.satLnkImsChargeLinesCompany

lnkSpecialContractTypesCompany.lnk.CountRows =  select count (*) c from lin.lnkSpecialContractTypesCompany
lnkSpecialContractTypesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubSpecialContractTypes, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubSpecialContractTypes, src.SELSKAB, src.SrcSystemId from hub.hubSpecialContractTypes hub1 inner join (select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_EdiKonv where isDeleted = 0 union select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_EdiKonv where isDeleted = 0) src on hub1.carrierCode = src.AGENT and hub1.dtxCode = src.FELT and hub1.segmentCode   = src.FRA and hub1.contractTypeCode = src.TIL and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkSpecialContractTypesCompany.satLnk.CountRows = select count (*) c from sat.satLnkSpecialContractTypesCompany

lnkSublocationCompany.lnk.CountRows =  select count (*) c from lin.lnkSublocationCompany
lnkSublocationCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubSublocation, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubSublocation, src.SELSKAB, src.SrcSystemId from hub.hubSublocation hub1 inner join (select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_EdiKonv where isDeleted = 0 union  select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_EdiKonv where isDeleted = 0) src on hub1.carrierCode = src.AGENT and hub1.dtxCode = src.FELT and hub1.segmentCode   = src.FRA and hub1.sublocationCode = src.TIL and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkSublocationCompany.satLnk.CountRows = select count (*) c from sat.satLnkSublocationCompany

lnkTransportModeCompany.lnk.CountRows =  select count (*) c from lin.lnkTransportModeCompany
lnkTransportModeCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubTransportMode, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubTransportMode, src.SELSKAB, src.SrcSystemId from hub.hubTransportMode hub1 inner join (select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_EdiKonv where isDeleted = 0 union  select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_EdiKonv where isDeleted = 0) src on hub1.carrierCode = src.AGENT and hub1.dtxCode = src.FELT and hub1.segmentCode   = src.FRA and hub1.transportModeCode = src.TIL and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkTransportModeCompany.satLnk.CountRows = select count (*) c from sat.satLnkTransportModeCompany

lnkCorrectorRemarkTypesCompany.lnk.CountRows =  select count (*) c from lin.lnkCorrectorRemarkTypesCompany
lnkCorrectorRemarkTypesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubCorrectorRemarkTypes, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubCorrectorRemarkTypes, src.SELSKAB, src.SrcSystemId from hub.hubCorrectorRemarkTypes hub1 inner join (select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_EdiKonv where isDeleted = 0 union select AGENT, FELT, FRA, TIL, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_EdiKonv where isDeleted = 0) src on hub1.carrierCode = src.AGENT and hub1.dtxCode = src.FELT and hub1.segmentCode   = src.FRA and hub1.remarkCode = src.TIL and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkCorrectorRemarkTypesCompany.satLnk.CountRows = select count (*) c from sat.satLnkCorrectorRemarkTypesCompany

lnkExportVesselsLocations.lnk.CountRows =  select count (*) c from lin.lnkExportVesselsLocations
lnkExportVesselsLocations.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubExportVessels, hub2.dwhIdHubLocations, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubExportVessels, src.SELSKAB, src.SrcSystemId, src.TS_PORT from hub.hubExportVessels hub1 inner join (select EXP_VESSEL_ID, SELSKAB, SrcSystemId, TS_PORT from StagingAreaTest.stg.MSCRUS_ExpVessels where isDeleted = 0 and TS_PORT is not null union select EXP_VESSEL_ID, SELSKAB, SrcSystemId, TS_PORT from StagingAreaTest.stg.UNITY_ExpVessels where isDeleted = 0 and TS_PORT is not null) src on  hub1.expVesselId = src.EXP_VESSEL_ID and  hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.TS_PORT and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubExportVessels, hub2.dwhIdHubLocations, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubExportVessels, src.SELSKAB, src.SrcSystemId, src.TS_PORT from hub.hubExportVessels hub1 inner join (select EXP_VESSEL_ID, SELSKAB, SrcSystemId, TS_PORT from StagingAreaTest.stg.MSCRUS_ExpVessels where isDeleted = 0 and TS_PORT is null union select EXP_VESSEL_ID, SELSKAB, SrcSystemId, TS_PORT from StagingAreaTest.stg.UNITY_ExpVessels where isDeleted = 0 and TS_PORT is null) src on  hub1.expVesselId = src.EXP_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and  hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkExportVesselsLocations.satLnk.CountRows = select count (*) c from sat.satLnkExportVesselsLocations

lnkExportVesselsOceanVesselService.lnk.CountRows =  select count (*) c from lin.lnkExportVesselsOceanVesselService
lnkExportVesselsOceanVesselService.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubExportVessels, hub2.dwhIdHubOceanVesselService, srcHub1.SrcSystemId from  hub.hubOceanVesselService hub2 inner join (select hub1.dwhIdHubExportVessels, src.SELSKAB, src.SrcSystemId, src.SERV_DIR from hub.hubExportVessels hub1 inner join (select EXP_VESSEL_ID, SELSKAB, SrcSystemId, SERV_DIR from StagingAreaTest.stg.MSCRUS_ExpVessels where isDeleted = 0 and SERV_DIR is not null union select EXP_VESSEL_ID, SELSKAB, SrcSystemId, SERV_DIR from StagingAreaTest.stg.UNITY_ExpVessels where isDeleted = 0 and SERV_DIR is not null) src on  hub1.expVesselId = src.EXP_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.shortName = srcHub1.SERV_DIR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubExportVessels, hub2.dwhIdHubOceanVesselService, srcHub1.SrcSystemId from  hub.hubOceanVesselService hub2 inner join (select hub1.dwhIdHubExportVessels, src.SELSKAB, src.SrcSystemId, src.SERV_DIR from hub.hubExportVessels hub1 inner join (select EXP_VESSEL_ID, SELSKAB, SrcSystemId, SERV_DIR from StagingAreaTest.stg.MSCRUS_ExpVessels where isDeleted = 0 and SERV_DIR is null union select EXP_VESSEL_ID, SELSKAB, SrcSystemId, SERV_DIR from StagingAreaTest.stg.UNITY_ExpVessels where isDeleted = 0 and SERV_DIR is null) src on hub1.expVesselId = src.EXP_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubOceanVesselService = -1 and  hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkExportVesselsOceanVesselService.satLnk.CountRows = select count (*) c from sat.satLnkExportVesselsOceanVesselService

lnkExportVesselsVesselRegistry.lnk.CountRows =  select count (*) c from lin.lnkExportVesselsVesselRegistry
lnkExportVesselsVesselRegistry.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubExportVessels, hub2.dwhIdHubVesselRegistry, srcHub1.SrcSystemId from  hub.hubVesselRegistry hub2 inner join (select hub1.dwhIdHubExportVessels, src.SELSKAB, src.SrcSystemId, src.VESSEL_CODE from hub.hubExportVessels hub1 inner join (select EXP_VESSEL_ID, SELSKAB, SrcSystemId, VESSEL_CODE from StagingAreaTest.stg.MSCRUS_ExpVessels where isDeleted = 0 and VESSEL_CODE is not null union select EXP_VESSEL_ID, SELSKAB, SrcSystemId, VESSEL_CODE from StagingAreaTest.stg.UNITY_ExpVessels where isDeleted = 0 and VESSEL_CODE is not null) src on hub1.expVesselId = src.EXP_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.feederCode = srcHub1.VESSEL_CODE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct sat2hub1.dwhIdHubExportVessels, hub2.dwhIdHubVesselRegistry, sat2hub1.SrcSystemId from  hub.hubVesselRegistry hub2 inner join (select sat2.dwhIdhubVesselRegistry, srcHub1.dwhIdHubExportVessels, srcHub1.SELSKAB, srcHub1.SrcSystemId from sat.satVesselRegistry sat2 inner join (select hub1.dwhIdHubExportVessels, src.SELSKAB, src.SrcSystemId, src.VESSEL_NAME from hub.hubExportVessels hub1 inner join (select EXP_VESSEL_ID, SELSKAB, SrcSystemId, VESSEL_NAME from StagingAreaTest.stg.MSCRUS_ExpVessels where isDeleted = 0 and VESSEL_CODE is null union select EXP_VESSEL_ID, SELSKAB, SrcSystemId, VESSEL_NAME from StagingAreaTest.stg.UNITY_ExpVessels where isDeleted = 0 and VESSEL_CODE is null) src on hub1.expVesselId = src.EXP_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on srcHub1.VESSEL_NAME = sat2.vesselName and srcHub1.SrcSystemId = sat2.srcSystemId)sat2hub1 on sat2hub1.dwhIdHubVesselRegistry = hub2.dwhIdHubVesselRegistry and sat2hub1.SELSKAB = hub2.accessCompanyId and sat2hub1.srcSystemId = hub2.srcSystemId)q
lnkExportVesselsVesselRegistry.satLnk.CountRows = select count (*) c from sat.satLnkExportVesselsVesselRegistry

lnkExportVesselsCompany.lnk.CountRows =  select count (*) c from lin.lnkExportVesselsCompany
lnkExportVesselsCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubExportVessels, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubExportVessels, src.SELSKAB, src.SrcSystemId from hub.hubExportVessels hub1 inner join (select EXP_VESSEL_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_ExpVessels where isDeleted = 0  union select EXP_VESSEL_ID, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_ExpVessels where isDeleted = 0) src on  hub1.expVesselId = src.EXP_VESSEL_ID and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkExportVesselsCompany.satLnk.CountRows = select count (*) c from sat.satLnkExportVesselsCompany


lnkInvoicePostingAccountingTransaction.lnk.CountRows =  select count (*) c from lin.lnkInvoicePostingAccountingTransaction
lnkInvoicePostingAccountingTransaction.condition.CountRows = select count (*) c from (select satAT.dwhIdhubAccountingTransaction, hubAt1.dwhIdhubInvoicePosting from sat.satAccountingTransaction satAT inner join (select hubAT.dwhIdhubAccountingTransaction, hubIP1.dwhIdhubInvoicePosting, hubIP1.DAGBOG, hubIP1.SELSKAB, hubIP1.SrcSystemId  from hub.hubAccountingTransaction hubAT inner join (select hubIP.dwhIdhubInvoicePosting, src.BILAGSNR, src.DAGBOG, src.SELSKAB, src.SrcSystemId from hub.hubInvoicePosting hubIP inner join (select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId, BILAGSNR, DAGBOG from  StagingAreaTest.stg.MSCRUS_FaktPost  where isDeleted = 0 union select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId, BILAGSNR, DAGBOG from  StagingAreaTest.stg.UNITY_FaktPost  where isDeleted = 0) src on hubIP.invoiceType = src.F_TYPE and hubIP.invoiceNr = src.FAKTURANR and hubIP.debitCredit = src.K_TYPE and hubIP.customerCode = src.KUNDE and hubIP.accessCompanyId = src.SELSKAB and hubIP.srcSystemId = src.srcSystemId) hubIP1 on hubAT.itemNr = hubIP1.BILAGSNR and hubAT.accessCompanyId = hubIP1.SELSKAB and hubAT.srcSystemId = hubIP1.srcSystemId) hubAt1 on satAT.diaryNum = hubAt1.DAGBOG and satAT.dwhIdhubAccountingTransaction = hubAt1.dwhIdhubAccountingTransaction and satAT.srcSystemId = hubAt1.srcSystemId)q
lnkInvoicePostingAccountingTransaction.satLnk.CountRows = select count (*) c from sat.satLnkInvoicePostingAccountingTransaction

lnkInvoicePostingCurrency.lnk.CountRows =  select count (*) c from lin.lnkInvoicePostingCurrency
lnkInvoicePostingCurrency.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubInvoicePosting, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hubIP.dwhIdhubInvoicePosting, src.SELSKAB, src.SrcSystemId, src.VALUTA from hub.hubInvoicePosting hubIP inner join (select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId, VALUTA from  StagingAreaTest.stg.MSCRUS_FaktPost  where isDeleted = 0 and VALUTA is not null union select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId, VALUTA from  StagingAreaTest.stg.UNITY_FaktPost  where isDeleted = 0 and VALUTA is not null) src on hubIP.invoiceType = src.F_TYPE and hubIP.invoiceNr = src.FAKTURANR and hubIP.debitCredit = src.K_TYPE and hubIP.customerCode = src.KUNDE and hubIP.accessCompanyId = src.SELSKAB and hubIP.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.VALUTA and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubInvoicePosting, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hubIP.dwhIdhubInvoicePosting, src.SrcSystemId from hub.hubInvoicePosting hubIP inner join (select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId, VALUTA from  StagingAreaTest.stg.MSCRUS_FaktPost  where isDeleted = 0 and VALUTA is null union select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId, VALUTA from  StagingAreaTest.stg.UNITY_FaktPost  where isDeleted = 0 and VALUTA is null) src on hubIP.invoiceType = src.F_TYPE and hubIP.invoiceNr = src.FAKTURANR and hubIP.debitCredit = src.K_TYPE and hubIP.customerCode = src.KUNDE and hubIP.accessCompanyId = src.SELSKAB and hubIP.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCurrency = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkInvoicePostingCurrency.satLnk.CountRows = select count (*) c from sat.satLnkInvoicePostingCurrency

lnkInvoicePostingCompany.lnk.CountRows =  select count (*) c from lin.lnkInvoicePostingCompany
lnkInvoicePostingCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubInvoicePosting, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hubIP.dwhIdhubInvoicePosting, src.SELSKAB, src.SrcSystemId from hub.hubInvoicePosting hubIP inner join (select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId from  StagingAreaTest.stg.MSCRUS_FaktPost  where isDeleted = 0 union select distinct F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, SrcSystemId from  StagingAreaTest.stg.UNITY_FaktPost  where isDeleted = 0) src on hubIP.invoiceType = src.F_TYPE and hubIP.invoiceNr = src.FAKTURANR and hubIP.debitCredit = src.K_TYPE and hubIP.customerCode = src.KUNDE and hubIP.accessCompanyId = src.SELSKAB and hubIP.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkInvoicePostingCompany.satLnk.CountRows = select count (*) c from sat.satLnkInvoicePostingCompany

lnkLocationsCountry.lnk.CountRows =  select count (*) c from lin.lnkLocationsCountry
lnkLocationsCountry.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubLocations, hub2.dwhIdHubCountry, srcHub1.SrcSystemId from  hub.hubCountry hub2 inner join (select hub1.dwhIdHubLocations, src.SELSKAB, src.SrcSystemId, src.MONT_ENHED from hub.hubLocations hub1 inner join (select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.MSCRUS_Henvis where isDeleted = 0 and ART= 'LO' and LOBE_NR= '1' union select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId, MONT_ENHED from StagingAreaTest.stg.UNITY_Henvis where isDeleted = 0 and ART= 'LO' and LOBE_NR= '1') src on hub1.dictionaryType = src.ART and hub1.locationCode = src.KODE and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.countryCode = srcHub1.MONT_ENHED and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkLocationsCountry.satLnk.CountRows = select count (*) c from sat.satLnkLocationsCountry

lnkLocationsLocationsPortsOverview.lnk.CountRows =  select count (*) c from lin.lnkLocationsLocationsPortsOverview
lnkLocationsLocationsPortsOverview.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubLocations, hub2.dwhIdHubLocationsPortsOverview, srcHub1.SrcSystemId from  hub.hubLocationsPortsOverview hub2 inner join (select hub1.dwhIdHubLocations, src.SELSKAB, src.SrcSystemId, src.KODE from hub.hubLocations hub1 inner join (select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Henvis where isDeleted = 0 and ART= 'LO' and LOBE_NR= '1' union select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Henvis where isDeleted = 0 and ART= 'LO' and LOBE_NR= '1') src on hub1.dictionaryType = src.ART and hub1.locationCode = src.KODE and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.KODE)q
lnkLocationsLocationsPortsOverview.satLnk.CountRows = select count (*) c from sat.satLnkLocationsLocationsPortsOverview
lnkLocationsLocationsPortsOverview.error.CountRows =  select count (*) c from (select packageName, srcTablename, ErrorDate, description, SELSKAB from etl.errLogLnkDataVault where packageName like '%lnkLocationsLocationsPortsOverview%')q

lnkCountryCompany.lnk.CountRows =  select count (*) c from lin.lnkCountryCompany
lnkCountryCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubCountry, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubCountry, src.SELSKAB, src.SrcSystemId, src.KODE from hub.hubCountry hub1 inner join (select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Henvis where isDeleted = 0 and ART= 'LA' and LOBE_NR= '1' union select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Henvis where isDeleted = 0 and ART= 'LA' and LOBE_NR= '1') src on hub1.dictionaryType = src.ART and hub1.countryCode = src.KODE and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkCountryCompany.satLnk.CountRows = select count (*) c from sat.satLnkCountryCompany

lnkLocationsCompany.lnk.CountRows =  select count (*) c from lin.lnkLocationsCompany
lnkLocationsCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubLocations, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubLocations, src.SELSKAB, src.SrcSystemId, src.KODE from hub.hubLocations hub1 inner join (select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Henvis where isDeleted = 0 and ART= 'LO' and LOBE_NR= '1' union select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Henvis where isDeleted = 0 and ART= 'LO' and LOBE_NR= '1') src on hub1.dictionaryType = src.ART and hub1.locationCode = src.KODE and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkLocationsCompany.satLnk.CountRows = select count (*) c from sat.satLnkLocationsCompany

lnkContainerLocationCompany.lnk.CountRows =  select count (*) c from lin.lnkContainerLocationCompany
lnkContainerLocationCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubContainerLocation, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubContainerLocation, src.SELSKAB, src.SrcSystemId, src.KODE from hub.hubContainerLocation hub1 inner join (select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Henvis where isDeleted = 0 and ART= 'CL' and LOBE_NR= '1' union select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Henvis where isDeleted = 0 and ART= 'CL' and LOBE_NR= '1') src on hub1.dictionaryType = src.ART and hub1.containerLocationCode = src.KODE and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkContainerLocationCompany.satLnk.CountRows = select count (*) c from sat.satLnkContainerLocationCompany

lnkVesselRegistryCompany.lnk.CountRows =  select count (*) c from lin.lnkVesselRegistryCompany
lnkVesselRegistryCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubVesselRegistry, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubVesselRegistry, src.SELSKAB, src.SrcSystemId, src.KODE from hub.hubVesselRegistry hub1 inner join (select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Henvis where isDeleted = 0 and ART= 'FE' and LOBE_NR= '1' union select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Henvis where isDeleted = 0 and ART= 'FE' and LOBE_NR= '1') src on hub1.dictionaryType = src.ART and hub1.feederCode = src.KODE and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkVesselRegistryCompany.satLnk.CountRows = select count (*) c from sat.satLnkVesselRegistryCompany

lnkCurrencyCompany.lnk.CountRows =  select count (*) c from lin.lnkCurrencyCompany
lnkCurrencyCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubCurrency, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubCurrency, src.SELSKAB, src.SrcSystemId, src.KODE from hub.hubCurrency hub1 inner join (select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Henvis where isDeleted = 0 and ART= 'VA' and LOBE_NR= '1' union select ART, KODE, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Henvis where isDeleted = 0 and ART= 'VA' and LOBE_NR= '1') src on hub1.dictionaryType = src.ART and hub1.currencyCode = src.KODE and hub1.sequenceNumber = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkCurrencyCompany.satLnk.CountRows = select count (*) c from sat.satLnkCurrencyCompany

lnkCustomersLocations.lnk.CountRows =  select count (*) c from lin.lnkCustomersLocations
lnkCustomersLocations.satLnk.CountRows = select count (*) c from sat.satLnkCustomersLocations
lnkCustomersLocations_Kunde.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubCustomers, src.CITY_CODE, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hub1 inner join (select distinct KUNDENR, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.MSCRUS_Kunde where isDeleted = 0 and CITY_CODE is not null union select distinct KUNDENR, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.UNITY_Kunde where isDeleted = 0 and CITY_CODE is not null) src on hub1.customerNr =  src.KUNDENR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.CITY_CODE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubCustomers, src.CITY_CODE, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hub1 inner join (select distinct KUNDENR, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.MSCRUS_Kunde where isDeleted = 0 and CITY_CODE is  null union select distinct KUNDENR, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.UNITY_Kunde where isDeleted = 0 and CITY_CODE is  null) src on hub1.customerNr =  src.KUNDENR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId )srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q
lnkCustomersLocations_Adresse.condition.CountRows = select count (*) c from (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubCustomers, src.CITY_CODE, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hub1 inner join (select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.MSCRUS_Adresse where isDeleted = 0 and CITY_CODE is not null union select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.UNITY_Adresse where isDeleted = 0 and CITY_CODE is not null) src on hub1.number =  src.NR and hub1.bookingNumber =  src.REF_NR and hub1.refType = src.REF_TYPE and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId) srcHub1 on hub2.locationCode = srcHub1.CITY_CODE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubCustomers, src.CITY_CODE, src.SELSKAB, src.SrcSystemId from hub.hubCustomers hub1 inner join (select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.MSCRUS_Adresse where isDeleted = 0 and CITY_CODE is  null union select NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId, CITY_CODE from StagingAreaTest.stg.UNITY_Adresse where isDeleted = 0 and CITY_CODE is  null ) src on hub1.number =  src.NR and hub1.bookingNumber =  src.REF_NR and hub1.refType = src.REF_TYPE and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0)q

lnkInvoiceBooking.lnk.CountRows =  select count (*) c from lin.lnkInvoiceBooking
lnkInvoiceBooking.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.REG_NR from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId, REG_NR from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 and REG_NR is not null union select ORDRE_NR, SELSKAB, SrcSystemId, REG_NR from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0 and REG_NR is not null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.REG_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId) union (select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubBooking, srcHub1.SrcSystemId from  hub.hubBooking hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.REG_NR from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId, REG_NR from StagingAreaTest.stg.MSCRUS_Ordre where REG_NR is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select ORDRE_NR, SELSKAB, SrcSystemId, REG_NR from StagingAreaTest.stg.UNITY_Ordre where REG_NR is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.bookingNumber = srcHub1.REG_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q
lnkInvoiceBooking.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceBooking

lnkInvoiceBookingCharges.lnk.CountRows = select count (*) c from lin.lnkInvoiceBookingCharges
lnkInvoiceBookingCharges.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubBookingCharges, hub2.dwhIdhubInvoice, srcHub1.SrcSystemId from  sat.satInvoice sat2 inner join (select hub1.dwhIdHubBookingCharges, src.SELSKAB, src.SrcSystemId, src.BOOK_NR, src.FRG_BT_NR from hub.hubBookingCharges hub1 inner join (select BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookFak where isDeleted = 0 and BOOK_NR is not null and FRG_BT_NR is not null union select BOOK_NR, FRG_BT_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookFak where isDeleted = 0 and BOOK_NR is not null and FRG_BT_NR is not null) src on hub1.bookingNr = src.BOOK_NR and hub1.positionNr = src.FRG_BT_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on sat2.bookingNr = srcHub1.BOOK_NR and sat2.positionNr = srcHub1.FRG_BT_NR and sat2.srcSystemId = srcHub1.SrcSystemId inner join hub.hubInvoice hub2 on hub2.dwhIdhubInvoice = sat2.dwhIdhubInvoice and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkInvoiceBookingCharges.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceBookingCharges

lnkInvoiceCurrency.lnk.CountRows =  select count (*) c from lin.lnkInvoiceCurrency
lnkInvoiceCurrency.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.VALUTAKODE from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 and VALUTAKODE is not null union select ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0 and VALUTAKODE is not null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.VALUTAKODE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.VALUTAKODE from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 and VALUTAKODE is null union select ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0 and VALUTAKODE is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCurrency = -1 and  hub2.accessCompanyId =  -1 and  hub2.srcSystemId = 0) union (select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.VALUTAKODE from hub.hubInvoice hub1 inner join (select  ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.MSCRUS_Ordre where VALUTAKODE is not null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.UNITY_Ordre where  VALUTAKODE is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.VALUTAKODE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.VALUTAKODE from hub.hubInvoice hub1 inner join (select  ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.MSCRUS_Ordre where VALUTAKODE is null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  ORDRE_NR, SELSKAB, SrcSystemId, VALUTAKODE from StagingAreaTest.stg.UNITY_Ordre where  VALUTAKODE is null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCurrency = -1 and  hub2.accessCompanyId =  -1 and  hub2.srcSystemId = 0))q
lnkInvoiceCurrency.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceCurrency

lnkInvoiceCustomers.lnk.CountRows =  select count (*) c from lin.lnkInvoiceCustomers
lnkInvoiceCustomers.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCustomers hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.KUNDE from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 and KUNDE is not null union select ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0 and KUNDE is not null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.customerNr = srcHub1.KUNDE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCustomers hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.KUNDE from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 and KUNDE is null union select ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0 and KUNDE is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCustomers = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0) union (select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCustomers hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.KUNDE from hub.hubInvoice hub1 inner join (select  ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.MSCRUS_Ordre where KUNDE is not null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.UNITY_Ordre where KUNDE is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.customerNr = srcHub1.KUNDE and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCustomers, srcHub1.SrcSystemId from  hub.hubCustomers hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.KUNDE from hub.hubInvoice hub1 inner join (select  ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.MSCRUS_Ordre where KUNDE is null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  ORDRE_NR, SELSKAB, SrcSystemId, KUNDE from StagingAreaTest.stg.UNITY_Ordre where KUNDE is null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubCustomers = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0))q
lnkInvoiceCustomers.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceCustomers

lnkInvoiceInvoice.lnk.CountRows =  select count (*) c from lin.lnkInvoiceInvoice
lnkInvoiceInvoice.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubInvoice as dwhIdHubInvoice1, hub2.dwhIdHubInvoice as dwhIdHubInvoice2, srcHub1.SrcSystemId from  hub.hubInvoice hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.REL_TO_ORDRE_NR from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId, REL_TO_ORDRE_NR from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 union select ORDRE_NR, SELSKAB, SrcSystemId, REL_TO_ORDRE_NR from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.orderNr = srcHub1.REL_TO_ORDRE_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId) union (select distinct srcHub1.dwhIdHubInvoice as dwhIdHubInvoice1, hub2.dwhIdHubInvoice as dwhIdHubInvoice2, srcHub1.SrcSystemId from  hub.hubInvoice hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.REL_TO_ORDRE_NR from hub.hubInvoice hub1 inner join (select  ORDRE_NR, SELSKAB, SrcSystemId, REL_TO_ORDRE_NR from StagingAreaTest.stg.MSCRUS_Ordre where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  ORDRE_NR, SELSKAB, SrcSystemId, REL_TO_ORDRE_NR from StagingAreaTest.stg.UNITY_Ordre where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.orderNr = srcHub1.REL_TO_ORDRE_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q
lnkInvoiceInvoice.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceInvoice

lnkInvoiceInvoiceLines.lnk.CountRows =  select count (*) c from lin.lnkInvoiceInvoiceLines
lnkInvoiceInvoiceLines.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubInvoiceLines, srcHub1.SrcSystemId from  hub.hubInvoiceLines hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.ORDRE_NR from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 union select ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.orderNr = srcHub1.ORDRE_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)union (select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubInvoiceLines, srcHub1.SrcSystemId from  hub.hubInvoiceLines hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId, src.ORDRE_NR from hub.hubInvoice hub1 inner join (select  ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Ordre where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Ordre where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.orderNr = srcHub1.ORDRE_NR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q
lnkInvoiceInvoiceLines.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceInvoiceLines
lnkInvoiceInvoiceLines.error.CountRows = select count (*) c from (select packageName, srcTablename, ErrorDate, description, ORDRE_NR, SELSKAB from etl.errLogLnkDataVault where packageName like '%lnkInvoiceInvoiceLines%')q

lnkInvoiceInvoicePosting.lnk.CountRows = select count (*) c from lin.lnkInvoiceInvoicePosting
lnkInvoiceInvoicePosting.condition.CountRows = select COUNT (*) c from (select hub2.dwhIdhubInvoice, hub1sat1.dwhIdhubInvoicePosting from hub.hubInvoice hub2 inner join (select sat.dwhIdHubInvoice, hub1sat.dwhIdHubInvoicePosting, hub1sat.BILAGSNR, hub1sat.SELSKAB, hub1sat.srcSystemId from sat.satInvoice sat inner join (select hub1.dwhIdHubInvoicePosting, src.BILAGSNR, src.SELSKAB, src.srcSystemId from hub.hubInvoicePosting hub1 inner join (select F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, srcSystemId, BILAGSNR from StagingAreaTest.stg.UNITY_FaktPost where isDeleted=0 and BILAGSNR is not null union select F_TYPE, FAKTURANR, K_TYPE, KUNDE, SELSKAB, srcSystemId, BILAGSNR from StagingAreaTest.stg.MSCRUS_FaktPost where isDeleted=0 and BILAGSNR is not null) src on hub1.invoiceType = src.F_TYPE and hub1.invoiceNr = src.FAKTURANR and hub1.debitCredit = src.K_TYPE and hub1.customerCode = src.KUNDE and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId) hub1sat on sat.invoiceNr = hub1sat.BILAGSNR and sat.srcSystemId = hub1sat.SrcSystemId) hub1sat1 on hub2.dwhIdhubInvoice = hub1sat1.dwhIdHubInvoice and hub2.accessCompanyId = hub1sat1.SELSKAB and hub2.srcSystemId = hub1sat1.SrcSystemId)q
lnkInvoiceInvoicePosting.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceInvoicePosting

lnkInvoiceCompany.lnk.CountRows =  select count (*) c from lin.lnkInvoiceCompany
lnkInvoiceCompany.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId from hub.hubInvoice hub1 inner join (select ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Ordre where isDeleted = 0 union select ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Ordre where isDeleted = 0) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)union (select distinct srcHub1.dwhIdHubInvoice, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubInvoice, src.SELSKAB, src.SrcSystemId from hub.hubInvoice hub1 inner join (select  ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Ordre where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0)or reg_dato  < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Ordre where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or reg_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q


lnkInvoiceLinesCurrency.lnk.CountRows =  select count (*) c from lin.lnkInvoiceLinesCurrency
lnkInvoiceLinesCurrency.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubInvoiceLines, hub2.dwhIdHubCurrency, srcHub1.SrcSystemId from  hub.hubCurrency hub2 inner join (select hub1.dwhIdHubInvoiceLines, src.SELSKAB, src.SrcSystemId, src.OMR_VALUTA from hub.hubInvoiceLines hub1 inner join (select LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId, OMR_VALUTA from StagingAreaTest.stg.MSCRUS_OrdreLin where isDeleted = 0 and OMR_VALUTA is not null union select LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId, OMR_VALUTA from StagingAreaTest.stg.UNITY_OrdreLin where isDeleted = 0 and OMR_VALUTA is not null) src on hub1.invoiceLineNr = src.LINIE_NR and hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.currencyCode = srcHub1.OMR_VALUTA and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkInvoiceLinesCurrency.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceLinesCurrency

lnkInvoiceLinesCompany.lnk.CountRows =  select count (*) c from lin.lnkInvoiceLinesCompany
lnkInvoiceLinesCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubInvoiceLines, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubInvoiceLines, src.SELSKAB, src.SrcSystemId from hub.hubInvoiceLines hub1 inner join (select LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_OrdreLin where isDeleted = 0 union select LINIE_NR, ORDRE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_OrdreLin where isDeleted = 0) src on hub1.invoiceLineNr = src.LINIE_NR and hub1.orderNr = src.ORDRE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkInvoiceLinesCompany.satLnk.CountRows = select count (*) c from sat.satLnkInvoiceLinesCompany

lnkFileLinerFileROE.lnk.CountRows =  select count (*) c from lin.lnkFileLinerFileROE
lnkFileLinerFileROE.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubFileLiner, hub2.dwhIdHubFileROE, srcHub1.SrcSystemId from  hub.hubFileROE hub2 inner join (select hub1.dwhIdHubFileLiner, src.SELSKAB, src.SrcSystemId, src.AFDELING, src.SAGSNR from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Sag where isDeleted = 0 union select AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Sag where isDeleted = 0) src on hub1.serviceCode = src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.serviceCode = srcHub1.AFDELING and hub2.fileLinerNr = srcHub1.SAGSNR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId) union (select distinct srcHub1.dwhIdHubFileLiner, hub2.dwhIdHubFileROE, srcHub1.SrcSystemId from  hub.hubFileROE hub2 inner join (select hub1.dwhIdHubFileLiner, src.SELSKAB, src.SrcSystemId, src.AFDELING, src.SAGSNR from hub.hubFileLiner hub1 inner join (select  AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Sag where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Sag where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.serviceCode = src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.serviceCode = srcHub1.AFDELING and hub2.fileLinerNr = srcHub1.SAGSNR and hub2.accessCompanyID = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q
lnkFileLinerFileROE.satLnk.CountRows = select count (*) c from sat.satLnkFileLinerFileROE

lnkFileLinerLocations.lnk.CountRows =  select count (*) c from lin.lnkFileLinerLocations
lnkFileLinerLocations_EXP.condition.CountRows = select count (*) c from ((select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.IMP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId, IMP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where isDeleted = 0 and IMP_AFG_ZONE is not null and EXP_AFG_ZONE is null union  select AFDELING, SAGSNR, SELSKAB, SrcSystemId, IMP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where isDeleted = 0 and IMP_AFG_ZONE is not null and EXP_AFG_ZONE is null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.IMP_AFG_ZONE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.IMP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId, IMP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where isDeleted = 0 and IMP_AFG_ZONE is null and EXP_AFG_ZONE is not null union select AFDELING, SAGSNR, SELSKAB, SrcSystemId, IMP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where isDeleted = 0 and IMP_AFG_ZONE is null and EXP_AFG_ZONE is not null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on  hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0) union (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.IMP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select distinct AFDELING, SAGSNR, SELSKAB, SrcSystemId, IMP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where IMP_AFG_ZONE is not null and EXP_AFG_ZONE is null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union  select distinct AFDELING, SAGSNR, SELSKAB, SrcSystemId,IMP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where IMP_AFG_ZONE is not null and EXP_AFG_ZONE is null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.IMP_AFG_ZONE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.IMP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select distinct AFDELING, SAGSNR, SELSKAB, SrcSystemId, IMP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where IMP_AFG_ZONE is null and EXP_AFG_ZONE is not null  and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select distinct AFDELING, SAGSNR, SELSKAB, SrcSystemId,IMP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where IMP_AFG_ZONE is null and EXP_AFG_ZONE is not null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on  hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0))q
lnkFileLinerLocations_IMP.condition.CountRows = select count (*) c from ((select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.EXP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where isDeleted = 0 and EXP_AFG_ZONE is not null  and IMP_AFG_ZONE is null union select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where isDeleted = 0 and EXP_AFG_ZONE is not null and IMP_AFG_ZONE is null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.EXP_AFG_ZONE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.EXP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where isDeleted = 0 and EXP_AFG_ZONE is null and IMP_AFG_ZONE is not null union select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where isDeleted = 0 and EXP_AFG_ZONE is null and IMP_AFG_ZONE is not null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0) union (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.EXP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where EXP_AFG_ZONE is not null  and IMP_AFG_ZONE is null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where  EXP_AFG_ZONE is not null and IMP_AFG_ZONE is null and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.locationCode = srcHub1.EXP_AFG_ZONE and hub2.accessCompanyId =  srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId union select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.EXP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select  AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE  from StagingAreaTest.stg.MSCRUS_Sag where EXP_AFG_ZONE is null and IMP_AFG_ZONE is not null  and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where EXP_AFG_ZONE is null and IMP_AFG_ZONE is not null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0))q
lnkFileLinerLocations_bothNull.condition.CountRows = select count (*) c from ((select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.EXP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where isDeleted = 0 and EXP_AFG_ZONE is null and IMP_AFG_ZONE is  null union select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where isDeleted = 0 and EXP_AFG_ZONE is null and IMP_AFG_ZONE is  null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0) union (select distinct hub2.dwhIdHubLocations, srcHub1.dwhIdHubFileLiner, srcHub1.SrcSystemId from  hub.hubLocations hub2 inner join (select hub1.dwhIdHubFileLiner, src.EXP_AFG_ZONE, src.SELSKAB, src.SrcSystemId from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.MSCRUS_Sag where EXP_AFG_ZONE is null and IMP_AFG_ZONE is  null  and (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select  AFDELING, SAGSNR, SELSKAB, SrcSystemId, EXP_AFG_ZONE from StagingAreaTest.stg.UNITY_Sag where EXP_AFG_ZONE is null and IMP_AFG_ZONE is  null and(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.serviceCode =  src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.dwhIdHubLocations = -1 and hub2.accessCompanyId =  -1 and hub2.srcSystemId = 0))q
lnkFileLinerLocations.satLnk.CountRows = select count (*) c from sat.satLnkFileLinerLocations

lnkFileLinerCompany.lnk.CountRows =  select count (*) c from lin.lnkFileLinerCompany
lnkFileLinerCompany.condition.CountRows = select count (*) c from ((select distinct srcHub1.dwhIdHubFileLiner, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubFileLiner, src.SELSKAB, src.SrcSystemId, src.AFDELING, src.SAGSNR from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Sag where isDeleted = 0 union select AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Sag where isDeleted = 0) src on hub1.serviceCode = src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId) union (select distinct srcHub1.dwhIdHubFileLiner, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubFileLiner, src.SELSKAB, src.SrcSystemId, src.AFDELING, src.SAGSNR from hub.hubFileLiner hub1 inner join (select AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_Sag where(SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.MSCRUS_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.MSCRUS_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104))) and ReasonDeleted not in (2,3) and cdcTimeStamp is null union select distinct AFDELING, SAGSNR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_Sag where (SELSKAB not in (select distinct SELSKAB from StagingAreaTest.stg.UNITY_EdiKonv where AGENT = 'MSC' and FELT = 'ID' and FRA = 'DWH_LOAD_SELSKAB' and TIL = 'Y' and isDeleted = 0) or start_dato < (SELECT  CONVERT(datetime, (SELECT c_val FROM StagingAreaTest.stg.UNITY_utsConstants WHERE c_name = 'DWH_START_DATE' and  partitionId =0 and isDeleted =0), 104)))and ReasonDeleted not in (2,3) and cdcTimeStamp is null) src on hub1.serviceCode = src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId))q  
lnkFileLinerCompany.satLnk.CountRows = select count (*) c from sat.satLnkFileLinerCompany

lnkFileROECompany.lnk.CountRows =  select count (*) c from lin.lnkFileROECompany
lnkFileROECompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubFileROE, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubFileROE, src.SELSKAB, src.SrcSystemId, src.AFDELING, src.SAGSNR from hub.hubFileROE hub1 inner join (select AFDELING, SAGSNR, VALUTA, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_SagKurs where isDeleted = 0  union select AFDELING, SAGSNR, VALUTA, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_SagKurs where isDeleted = 0) src on hub1.serviceCode = src.AFDELING and hub1.fileLinerNr = src.SAGSNR and hub1.currencyCode = src.VALUTA and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q
lnkFileROECompany.satLnk.CountRows = select count (*) c from sat.satLnkFileROECompany

lnkDailyRoeCompany.lnk.CountRows =  select count (*) c from lin.lnkDailyRoeCompany
lnkDailyRoeCompany.condition.CountRows = select count (*) c from (select distinct srcHub1.dwhIdHubDailyRoe, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubDailyRoe, src.SELSKAB, src.SrcSystemId from hub.hubDailyRoe hub1 inner join (select DATO, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_ShipKurs where isDeleted = 0  union select DATO, LOBE_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_ShipKurs where isDeleted = 0) src on hub1.roeDate = src.DATO and hub1.sequenceNr = src.LOBE_NR and hub1.accessCompanyId = src.SELSKAB and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.companyId = srcHub1.SELSKAB and hub2.srcSystemId = srcHub1.SrcSystemId)q 
lnkDailyRoeCompany.satLnk.CountRows = select count (*) c from sat.satLnkDailyRoeCompany

bookingCargoCharges.fct.CountRows = select count (*) c from fct.fctBookingCargoCharges
bookingCargoCharges.fctCondition_InitialLoad.CountRows = select count (*) c from (select  hubComp.dwhIdHubCompany, hubComp1.dwhIdHubBookingCargo, hubComp1.dwhIdHubCurrency, hubComp1.cdcTimestamp, hubComp1.A_PRIS, hubComp1.ANTAL, hubComp1.DISTINCT_BET_KODE, hubComp1.ENHED, hubComp1.FRG_BT_NR, hubComp1.OMR_KURS, hubComp1.TOTAL_BEL, hubComp1.GRUPPE from hub.hubCompany hubComp inner join(select  srcWithHubBC.dwhIdHubBookingCargo , hubCur.dwhIdHubCurrency, srcWithHubBC.SELSKAB, srcWithHubBC.srcSystemId, srcWithHubBC.cdcTimestamp, srcWithHubBC.A_PRIS, srcWithHubBC.ANTAL, srcWithHubBC.DISTINCT_BET_KODE, srcWithHubBC.ENHED, srcWithHubBC.FRG_BT_NR, srcWithHubBC.OMR_KURS, srcWithHubBC.TOTAL_BEL, srcWithHubBC.GRUPPE from hub.hubCurrency hubCur inner join (select hubBC.dwhIdHubBookingCargo as dwhIdHubBookingCargo, src.OMR_VALUTA, src.SELSKAB, src.srcSystemId, src.cdcTimestamp, src.A_PRIS, src.ANTAL, src.DISTINCT_BET_KODE, src.ENHED, src.FRG_BT_NR, src.OMR_KURS, src.TOTAL_BEL, src.GRUPPE from hub.hubBookingCargo hubBC inner join (select  BOOK_NR, VAREPOST_NR, OMR_VALUTA, SELSKAB, srcSystemId, cdcTimestamp,A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, OMR_KURS, TOTAL_BEL, GRUPPE from StagingAreaTest.stg.MSCRUS_getCharges where OMR_VALUTA is not null and cdcTimestamp is null union select  BOOK_NR, VAREPOST_NR, OMR_VALUTA, SELSKAB, srcSystemId, cdcTimestamp,A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, OMR_KURS, TOTAL_BEL, GRUPPE from StagingAreaTest.stg.UNITY_getCharges where OMR_VALUTA is not null and cdcTimestamp is null ) src on hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubCur.currencyCode = srcWithHubBC.OMR_VALUTA and hubCur.accessCompanyId = srcWithHubBC.SELSKAB and hubCur.srcSystemId =srcWithHubBC.srcSystemId) hubComp1 on hubComp1.SELSKAB = hubComp.companyId and hubComp1.srcSystemId = hubComp.srcSystemId union select s.dwhIdHubCompany, s.dwhIdHubBookingCargo, hubCur.dwhIdHubCurrency, s.cdcTimestamp, s.A_PRIS, s.ANTAL, s.DISTINCT_BET_KODE, s.ENHED, s.FRG_BT_NR, s.OMR_KURS, s.TOTAL_BEL, s.GRUPPE from hub.hubCurrency hubCur inner join (select  hubCurCode.dwhIdHubBookingCargo,  hubCurCode.dwhIdHubCompany, hubCurCode.srcSystemId, hubCurCode.companyId, satC.homeCurrencyCode as OMR_VALUTA, hubCurCode.cdcTimestamp, hubCurCode.A_PRIS, hubCurCode.ANTAL, hubCurCode.DISTINCT_BET_KODE, hubCurCode.ENHED, hubCurCode.FRG_BT_NR, hubCurCode.OMR_KURS, hubCurCode.TOTAL_BEL, hubCurCode.GRUPPE from sat.satCompany satC inner join (select  srcWithHubBC.dwhIdHubBookingCargo, hubC.dwhIdHubCompany, hubC.srcSystemId, hubC.companyId, srcWithHubBC.OMR_VALUTA,  srcWithHubBC.cdcTimestamp, srcWithHubBC.A_PRIS, srcWithHubBC.ANTAL, srcWithHubBC.DISTINCT_BET_KODE, srcWithHubBC.ENHED, srcWithHubBC.FRG_BT_NR, srcWithHubBC.OMR_KURS, srcWithHubBC.TOTAL_BEL, srcWithHubBC.GRUPPE from hub.hubCompany hubC inner join (select hubBC.dwhIdHubBookingCargo, src.SELSKAB, src.OMR_VALUTA, src.srcSystemId, src.cdcTimestamp, src.A_PRIS, src.ANTAL, src.DISTINCT_BET_KODE, src.ENHED, src.FRG_BT_NR, src.OMR_KURS, src.TOTAL_BEL, src.GRUPPE from hub.hubBookingCargo hubBC inner join (select  BOOK_NR, VAREPOST_NR, SELSKAB, OMR_VALUTA, srcSystemId, cdcTimestamp, A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, OMR_KURS, TOTAL_BEL, GRUPPE from StagingAreaTest.stg.MSCRUS_getCharges where OMR_VALUTA is null and cdcTimestamp is null union select  BOOK_NR, VAREPOST_NR, SELSKAB, OMR_VALUTA, srcSystemId, cdcTimestamp, A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, OMR_KURS, TOTAL_BEL, GRUPPE from StagingAreaTest.stg.UNITY_getCharges where OMR_VALUTA is null and cdcTimestamp is null) src on  hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubC.companyId = srcWithHubBC.SELSKAB and hubC.srcSystemId = srcWithHubBC.srcSystemId) hubCurCode on satC.dwhIdHubCompany= hubCurCode.dwhIdHubCompany) s on hubCur.currencyCode = s.OMR_VALUTA and hubCur.srcSystemId = s.srcSystemId and hubCur.accessCompanyId =  s.companyId)x
bookingCargoCharges.lnkCondition_Union.CountRows = select count (*) c from(select  distinct srcWithHubBC.dwhIdHubBookingCargo , hubCur.dwhIdHubCurrency, srcWithHubBC.srcSystemId from hub.hubCurrency hubCur inner join (select hubBC.dwhIdHubBookingCargo as dwhIdHubBookingCargo, src.OMR_VALUTA, src.SELSKAB, src.srcSystemId from hub.hubBookingCargo hubBC inner join (select distinct BOOK_NR, VAREPOST_NR, OMR_VALUTA, SELSKAB, srcSystemId from StagingAreaTest.stg.v_getCharges where OMR_VALUTA is not null) src on hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubCur.currencyCode = srcWithHubBC.OMR_VALUTA COLLATE SQL_Latin1_General_CP1_CS_AS and hubCur.accessCompanyId = srcWithHubBC.SELSKAB and hubCur.srcSystemId =srcWithHubBC.srcSystemId union select distinct s.dwhIdHubBookingCargo, hubCur.dwhIdHubCurrency, s.srcSystemId from hub.hubCurrency hubCur inner join (select  hubCurCode.dwhIdHubBookingCargo, satC.homeCurrencyCode, hubCurCode.srcSystemId, hubCurCode.companyId from sat.satCompany satC inner join (select  srcWithHubBC.dwhIdHubBookingCargo, hubC.dwhIdHubCompany as dwhIdHubCompany, hubC.srcSystemId as srcSystemId, hubC.companyId as companyId from hub.hubCompany hubC inner join (select distinct hubBC.dwhIdHubBookingCargo as dwhIdHubBookingCargo, src.SELSKAB, src.srcSystemId from hub.hubBookingCargo hubBC inner join (select distinct BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId from StagingAreaTest.stg.v_getCharges where OMR_VALUTA is null) src on hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubC.companyId = srcWithHubBC.SELSKAB and hubC.srcSystemId = srcWithHubBC.srcSystemId) hubCurCode on satC.dwhIdHubCompany= hubCurCode.dwhIdHubCompany) s on hubCur.currencyCode = s.homeCurrencyCode and hubCur.srcSystemId = s.srcSystemId and hubCur.accessCompanyId = s.companyId)x
bookingCargoCharges.satLnk.CountRows = select count (*) c from sat.satLnkBookingCargoCharges
bookingCargoCharges.sat.CountRows = select count (*) c from sat.satBookingCargoCharges
bookingCargoCharges.satCondition_ValutaIsNull.CountRows = select count (*) c from (select s.dwhIdHubBookingCargo, hubCur.dwhIdHubCurrency, s.srcSystemId from hub.hubCurrency hubCur inner join (select  hubCurCode.dwhIdHubBookingCargo, satC.homeCurrencyCode, hubCurCode.srcSystemId, hubCurCode.companyId, hubCurCode.A_PRIS, hubCurCode.ANTAL, hubCurCode.DISTINCT_BET_KODE, hubCurCode.ENHED, hubCurCode.FRG_BT_NR, hubCurCode.GRUPPE, hubCurCode.OMR_KURS, hubCurCode.TOTAL_BEL from sat.satCompany satC inner join (select  srcWithHubBC.dwhIdHubBookingCargo, hubC.dwhIdHubCompany as dwhIdHubCompany, hubC.srcSystemId as srcSystemId, hubC.companyId as companyId, srcWithHubBC.A_PRIS, srcWithHubBC.ANTAL, srcWithHubBC.DISTINCT_BET_KODE, srcWithHubBC.ENHED, srcWithHubBC.FRG_BT_NR, srcWithHubBC.GRUPPE, srcWithHubBC.OMR_KURS, srcWithHubBC.TOTAL_BEL from hub.hubCompany hubC inner join (select hubBC.dwhIdHubBookingCargo as dwhIdHubBookingCargo, src.SELSKAB, src.srcSystemId, src.A_PRIS, src.ANTAL, src.DISTINCT_BET_KODE, src.ENHED, src.FRG_BT_NR, src.GRUPPE, src.OMR_KURS, src.TOTAL_BEL from hub.hubBookingCargo hubBC inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, GRUPPE, OMR_KURS, TOTAL_BEL from StagingAreaTest.stg.v_getCharges where OMR_VALUTA is null) src on hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubC.companyId = srcWithHubBC.SELSKAB and hubC.srcSystemId = srcWithHubBC.srcSystemId) hubCurCode on satC.dwhIdHubCompany= hubCurCode.dwhIdHubCompany) s on hubCur.currencyCode = s.homeCurrencyCode and hubCur.srcSystemId = s.srcSystemId and hubCur.accessCompanyId = s.companyId)n
bookingCargoCharges.satCondition_ValutaIsNotNull.CountRows = select count (*) c from (select  srcWithHubBC.dwhIdHubBookingCargo , hubCur.dwhIdHubCurrency, srcWithHubBC.srcSystemId from hub.hubCurrency hubCur inner join (select  hubBC.dwhIdHubBookingCargo as dwhIdHubBookingCargo, src.OMR_VALUTA, src.SELSKAB, src.srcSystemId, src.A_PRIS, src.ANTAL, src.DISTINCT_BET_KODE, src.ENHED, src.FRG_BT_NR, src.GRUPPE, src.OMR_KURS, src.TOTAL_BEL from hub.hubBookingCargo hubBC inner join (select  BOOK_NR, VAREPOST_NR, OMR_VALUTA, SELSKAB, srcSystemId, A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, GRUPPE, OMR_KURS, TOTAL_BEL from StagingAreaTest.stg.v_getCharges where OMR_VALUTA is not null) src on hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubCur.currencyCode = srcWithHubBC.OMR_VALUTA and hubCur.accessCompanyId = srcWithHubBC.SELSKAB and hubCur.srcSystemId =srcWithHubBC.srcSystemId )q
bookingCargoCharges.satCondition_Union.CountRows = select count (*) c from (select s.dwhIdHubBookingCargo, hubCur.dwhIdHubCurrency, s.srcSystemId from hub.hubCurrency hubCur inner join (select  hubCurCode.dwhIdHubBookingCargo, satC.homeCurrencyCode, hubCurCode.srcSystemId, hubCurCode.companyId, hubCurCode.A_PRIS, hubCurCode.ANTAL, hubCurCode.DISTINCT_BET_KODE, hubCurCode.ENHED, hubCurCode.FRG_BT_NR, hubCurCode.GRUPPE, hubCurCode.OMR_KURS, hubCurCode.TOTAL_BEL from sat.satCompany satC inner join (select  srcWithHubBC.dwhIdHubBookingCargo, hubC.dwhIdHubCompany as dwhIdHubCompany, hubC.srcSystemId as srcSystemId, hubC.companyId as companyId, srcWithHubBC.A_PRIS, srcWithHubBC.ANTAL, srcWithHubBC.DISTINCT_BET_KODE, srcWithHubBC.ENHED, srcWithHubBC.FRG_BT_NR, srcWithHubBC.GRUPPE, srcWithHubBC.OMR_KURS, srcWithHubBC.TOTAL_BEL from hub.hubCompany hubC inner join (select hubBC.dwhIdHubBookingCargo as dwhIdHubBookingCargo, src.SELSKAB, src.srcSystemId, src.A_PRIS, src.ANTAL, src.DISTINCT_BET_KODE, src.ENHED, src.FRG_BT_NR, src.GRUPPE, src.OMR_KURS, src.TOTAL_BEL from hub.hubBookingCargo hubBC inner join (select BOOK_NR, VAREPOST_NR, SELSKAB, srcSystemId, A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, GRUPPE, OMR_KURS, TOTAL_BEL from StagingAreaTest.stg.v_getCharges where OMR_VALUTA is null) src on hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubC.companyId = srcWithHubBC.SELSKAB and hubC.srcSystemId = srcWithHubBC.srcSystemId) hubCurCode on satC.dwhIdHubCompany= hubCurCode.dwhIdHubCompany) s on hubCur.currencyCode = s.homeCurrencyCode and hubCur.srcSystemId = s.srcSystemId and hubCur.accessCompanyId = s.companyId union select  srcWithHubBC.dwhIdHubBookingCargo , hubCur.dwhIdHubCurrency, srcWithHubBC.srcSystemId from hub.hubCurrency hubCur inner join (select distinct hubBC.dwhIdHubBookingCargo as dwhIdHubBookingCargo, src.OMR_VALUTA, src.SELSKAB, src.srcSystemId, src.A_PRIS, src.ANTAL, src.DISTINCT_BET_KODE, src.ENHED, src.FRG_BT_NR, src.GRUPPE, src.OMR_KURS, src.TOTAL_BEL from hub.hubBookingCargo hubBC inner join (select  BOOK_NR, VAREPOST_NR, OMR_VALUTA, SELSKAB, srcSystemId, A_PRIS, ANTAL, DISTINCT_BET_KODE, ENHED, FRG_BT_NR, GRUPPE, OMR_KURS, TOTAL_BEL from StagingAreaTest.stg.v_getCharges where OMR_VALUTA is not null) src on hubBC.bookingNumber = src.BOOK_NR and hubBC.cargoLineNr = src.VAREPOST_NR and hubBC.accessCompanyId = src.SELSKAB and hubBC.srcSystemId = src.srcSystemId) srcWithHubBC on hubCur.currencyCode = srcWithHubBC.OMR_VALUTA and hubCur.accessCompanyId = srcWithHubBC.SELSKAB and hubCur.srcSystemId =srcWithHubBC.srcSystemId)n

lnkShipItConstantsCompany.lnk.CountRows =  select count (*) c from lin.lnkShipItConstantsCompany
lnkShipItConstantsCompany.satCondition.CountRows= select count (*) c from (select distinct srcHub1.dwhIdHubShipItConstants, hub2.dwhIdHubCompany, srcHub1.SrcSystemId from  hub.hubCompany hub2 inner join (select hub1.dwhIdHubShipItConstants, src.SrcSystemId from hub.hubShipItConstants hub1 inner join (select C_NAME, SrcSystemId from StagingAreaTest.stg.MSCRUS_UtsConstants where isDeleted = 0  union select C_NAME, SrcSystemId from StagingAreaTest.stg.UNITY_UtsConstants where isDeleted = 0) src on hub1.cName = 'CPH_SELSKAB' and hub1.srcSystemId = src.srcSystemId)srcHub1 on hub2.srcSystemId = srcHub1.SrcSystemId)q

system.PercentOfRows = 0.0005

customers.dwh.CountRows = select count (*) c from (select distinct dwhIdHubCustomers, validFrom from sat.satCustomers union select distinct dwhIdHubCustomers, validFrom from sat.satCustomersStatus) q
customers.dim.CountRows = select COUNT (*) c from (select dwhIdHubCustomers, validFrom c from [dim].[dimCustomers])q
customers.dataInDV.RowByRowNum = select * from (SELECT ROW_NUMBER() OVER (Order by hubSat.dwhIdHubCustomers) AS RowNumber, hubSat.dwhIdHubCustomers, hubSat.customerNr, hubSat.number, hubSat.bookingNumber, hubSat.blNumber, hubSat.customerType, hubSat.refType, hubSat.customerName, hubSat.shortName, hubSat.TMScustomerNr, hubSat.address1, hubSat.address2, hubSat.address3, hubSat.email, hubSat.fax, hubSat.phone, hubSat.countryCode, hubSat.cityCode, hubSat.cityName, hubSat.masterNameCode, hubSat.clientReference, hubSat.accountManagerCode1, hubSat.accountManagerCode2, hubSat.accessCompanyId, hubSat.srcSystemId, satStatus.status, satStatus.validFrom  from sat.satCustomersStatus satStatus inner join (select distinct hub.dwhIdHubCustomers, hub.customerNr, hub.number, hub.bookingNumber, hub.blNumber, hub.customerType, hub.refType, sat.customerName, sat.shortName, sat.TMScustomerNr, sat.address1, sat.address2, sat.address3, sat.email, sat.fax, sat.phone, sat.countryCode, sat.cityCode, sat.cityName, sat.masterNameCode, sat.clientReference, sat.accountManagerCode1, sat.accountManagerCode2, hub.accessCompanyId, hub.srcSystemId  from sat.satCustomers sat inner join (select dwhIdHubCustomers, customerNr, number, bookingNumber, blNumber, customerType, refType, accessCompanyId, srcSystemId from hub.hubCustomers) hub on hub.dwhIdHubCustomers = sat.dwhIdHubCustomers) hubSat on hubSat.dwhIdHubCustomers = satStatus.dwhIdHubCustomers) q where RowNumber =
customers.dataInDM.RowByKeys = select dwhIdHubCustomers, customerNr, number, bookingNumber, blNumber, customerType, refType, customerName, shortName, TMScustomerNr, address1, address2, address3, email, fax, phone,countryCode, cityCode, cityName, masterNameCode, clientReference, accountManagerCode1, accountManagerCode2,accessCompanyId, srcSystemId, dmStatus as status, validFrom  from  dim.dimCustomers

fileLiner.dwh.CountRows = select count (*) c from (select distinct dwhIdHubFileLiner, validFrom from sat.satFileLiner union select distinct dwhIdHubFileLiner, validFrom from sat.satFileLinerStatus) q
fileLiner.dim.CountRows = select COUNT (*) c from (select dwhIdHubFileLiner, validFrom c from dim.dimFileLiner)q
fileLiner.dataInDV.RowByRowNum = select * from (SELECT ROW_NUMBER() OVER (Order by hubSat.dwhIdHubFileLiner) AS RowNumber, hubSat.dwhIdHubFileLiner, hubSat.serviceCode, hubSat.fileLinerNr, hubSat.accessCompanyId, hubSat.expPolDate, hubSat.impPodDate, hubSat.voyageNr, hubSat.vesselName, hubSat.temporaryFlag, hubSat.openDate, hubSat.closeDate, hubSat.callId, hubSat.sailingWeek, hubSat.proformaDate, hubSat.status,  hubSat.srcSystemId, satStatus.status as satStatus, satStatus.validFrom from sat.satFileLinerStatus satStatus inner join (select distinct hub.dwhIdHubFileLiner, hub.serviceCode, hub.fileLinerNr, hub.accessCompanyId, sat.expPolDate, sat.impPodDate, sat.voyageNr, sat.vesselName, sat.temporaryFlag, sat.openDate, sat.closeDate, sat.callId, sat.sailingWeek, sat.proformaDate, sat.status,  hub.srcSystemId from sat.satFileLiner sat inner join (select dwhIdHubFileLiner, serviceCode, fileLinerNr, accessCompanyId,  srcSystemId  from hub.hubFileLiner) hub on hub.dwhIdHubFileLiner = sat.dwhIdHubFileLiner) hubSat on hubSat.dwhIdHubFileLiner = satStatus.dwhIdHubFileLiner) q where RowNumber =
fileLiner.datainDM.RowByKeys = select dwhIdHubFileLiner, serviceCode, fileLinerNr, accessCompanyId, expPolDate, srcSystemId , impPodDate, voyageNr, vesselName,temporaryFlag, openDate, closeDate, callId, sailingWeek, proformaDate, status, dmStatus as satStatus, validFrom from  dim.dimFileLiner


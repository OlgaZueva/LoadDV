abPost.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_AbPost where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
abPost.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.F_TYPE, src.FAKTURANR, src.K_TYPE, src.KUNDE, src.LOBE_NR, src.SELSKAB,src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_AbPost src inner join (select  cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_AbPost where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.F_TYPE =srcInMoment.F_TYPE and src.FAKTURANR =srcInMoment.FAKTURANR and src.K_TYPE =srcInMoment.K_TYPE and src.KUNDE =srcInMoment.KUNDE and src.LOBE_NR =srcInMoment.LOBE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
abPost.MSCRUS.InDWithHub.counts = select count (*) c from (select src.F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_AbPost src inner join (select * from DataVaultTest.hub.hubPayments) hub on hub.invoiceType = src.F_TYPE and hub.invoiceNr = src.FAKTURANR and hub.debitCredit = src.K_TYPE and hub.customerCode = src.KUNDE and hub.sequenceNr = src.LOBE_NR and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
abPost.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_AbPost where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
abPost.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_AbPost where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
abPost.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.F_TYPE, src.FAKTURANR, src.K_TYPE, src.KUNDE, src.LOBE_NR, src.SELSKAB,src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_AbPost src inner join (select  cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_AbPost where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.F_TYPE =srcInMoment.F_TYPE and src.FAKTURANR =srcInMoment.FAKTURANR and src.K_TYPE =srcInMoment.K_TYPE and src.KUNDE =srcInMoment.KUNDE and src.LOBE_NR =srcInMoment.LOBE_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
abPost.UNITY.InDWithHub.counts = select count (*) c from (select src.F_TYPE, FAKTURANR, K_TYPE, KUNDE, LOBE_NR, SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_AbPost src inner join (select * from DataVaultTest.hub.hubPayments) hub on hub.invoiceType = src.F_TYPE and hub.invoiceNr = src.FAKTURANR and hub.debitCredit = src.K_TYPE and hub.customerCode = src.KUNDE and hub.sequenceNr = src.LOBE_NR and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
abPost.UNITY.delete.count = select count (*) c from stg.UNITY_AbPost where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

book.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_Book where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
book.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_Book src inner join (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_Book where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
book.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_Book src inner join (select * from DataVaultTest.hub.hubBooking) hub on src.BOOK_NR =  hub.bookingNumber and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
book.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_Book where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
book.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_Book where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
book.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_Book src inner join (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_Book where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
book.UNITY.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_Book src inner join (select * from DataVaultTest.hub.hubBooking) hub on src.BOOK_NR =  hub.bookingNumber and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
book.UNITY.delete.count = select count (*) c from stg.UNITY_Book where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

bookDryPort.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookDryPort where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookDryPort.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_BookDryPort src inner join (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookDryPort where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookDryPort.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDryPort src inner join (select * from DataVaultTest.hub.hubBooking) hub on src.BOOK_NR =  hub.bookingNumber and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookDryPort.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_BookDryPort where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
bookDryPort.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookDryPort where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookDryPort.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_BookDryPort src inner join (select  cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookDryPort where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookDryPort.UNITY.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_BookDryPort src inner join (select * from DataVaultTest.hub.hubBooking) hub on src.BOOK_NR =  hub.bookingNumber and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookDryPort.UNITY.delete.count = select count (*) c from stg.UNITY_BookDryPort where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

bookManifest.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookManifests where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookManifest.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_MFT_ID, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_BookManifests src inner join (select  cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookManifests where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_MFT_ID =srcInMoment.BOOK_MFT_ID and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookManifest.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.BOOK_MFT_ID, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_BookManifests src inner join (select * from DataVaultTest.hub.hubBookingManifest) hub on src.BOOK_MFT_ID =  hub.bookMftId and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookManifest.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_BookManifests where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
bookManifest.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookManifests where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookManifest.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_MFT_ID, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_BookManifests src inner join (select  cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookManifests where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_MFT_ID, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_MFT_ID =srcInMoment.BOOK_MFT_ID and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookManifest.UNITY.InDWithHub.counts = select count (*) c  from (select src.BOOK_MFT_ID, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_BookManifests src inner join (select * from DataVaultTest.hub.hubBookingManifest) hub on src.BOOK_MFT_ID =  hub.bookMftId and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookManifest.UNITY.delete.count = select count (*) c from stg.UNITY_BookManifests where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

adresse.MSCRUS.countMutiMoments.counts = select count (*) c from (select  cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_Adresse where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q 
adresse.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.NR, src.REF_NR, src.REF_TYPE, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted from StagingAreaTest.stg.MSCRUS_Adresse src inner join (select  cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_Adresse where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.NR = srcInMoment.NR and src.REF_NR = srcInMoment.REF_NR and src.REF_TYPE = srcInMoment.REF_TYPE and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
adresse.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.NR, REF_NR, REF_TYPE, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_Adresse src inner join (select * from DataVaultTest.hub.hubCustomers) hub on src.NR =  hub.number and src.REF_NR =  hub.bookingNumber and src.REF_TYPE =  hub.refType and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
adresse.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_Adresse where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
adresse.UNITY.countMutiMoments.counts = select count (*) c from (select  cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_Adresse where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q 
adresse.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.NR, src.REF_NR, src.REF_TYPE, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted from StagingAreaTest.stg.UNITY_Adresse src inner join (select  cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_Adresse where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, NR, REF_NR, REF_TYPE, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.NR = srcInMoment.NR and src.REF_NR = srcInMoment.REF_NR and src.REF_TYPE = srcInMoment.REF_TYPE and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and src.cdcOperation is not null and src.cdcOperation != 'D ')q
adresse.UNITY.InDWithHub.counts = select count (*) c  from (select src.NR, REF_NR, REF_TYPE, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_Adresse src inner join (select * from DataVaultTest.hub.hubCustomers) hub on src.NR =  hub.number and src.REF_NR =  hub.bookingNumber and src.REF_TYPE =  hub.refType and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
adresse.UNITY.delete.count = select count (*) c from stg.UNITY_Adresse where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3

bookDetails.MSCRUS.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.MSCRUS_BookDetails where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookDetails.MSCRUS.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR, src.SEGMENT_CODE, src.SEQ_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.MSCRUS_BookDetails src inner join (select  cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDetails where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.SEGMENT_CODE = srcInMoment.SEGMENT_CODE and src.SEQ_NR =srcInMoment.SEQ_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookDetails.MSCRUS.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, SEGMENT_CODE, SEQ_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.MSCRUS_BookDetails src inner join (select * from DataVaultTest.hub.hubBookingManifestAdditionals) hub on src.BOOK_NR =  hub.bookingNumber and src.SEGMENT_CODE =  hub.segmentCode and src.SEQ_NR =  hub.sequenceNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookDetails.MSCRUS.delete.count = select count (*) c from stg.MSCRUS_BookDetails where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
bookDetails.UNITY.countMutiMoments.counts =  select count (*) c from (select  cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId  from StagingAreaTest.stg.UNITY_BookDetails where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1)q
bookDetails.UNITY.MomentsMultiIUD.notD.counts = select count (*) c from (select  src.cdcTimestamp, src.cdcOperation, src.cdcCscn, src.cdcRsid, src.BOOK_NR, src.SEGMENT_CODE, src.SEQ_NR, src.SELSKAB, src.SrcSystemId, src.IsDeleted, src.PartitionId, src.ReasonDeleted  from StagingAreaTest.stg.UNITY_BookDetails src inner join (select  cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId from StagingAreaTest.stg.UNITY_BookDetails where cdcOperation is not null and ReasonDeleted not in (1,2) group by cdcTimestamp, BOOK_NR, SEGMENT_CODE, SEQ_NR, SELSKAB, SrcSystemId having count (cdcTimestamp) >1) srcInMoment on src.BOOK_NR =srcInMoment.BOOK_NR and src.SEGMENT_CODE = srcInMoment.SEGMENT_CODE and src.SEQ_NR =srcInMoment.SEQ_NR and src.SELSKAB = srcInMoment.SELSKAB and src.SrcSystemId =  srcInMoment.SrcSystemId and src.CdcTimestamp = srcInMoment.CdcTimestamp and  src.cdcOperation is not null and src.cdcOperation != 'D ')q
bookDetails.UNITY.InDWithHub.counts = select count (*) c  from (select src.BOOK_NR, SEGMENT_CODE, SEQ_NR, src.SELSKAB, src.SrcSystemId from StagingAreaTest.stg.UNITY_BookDetails src inner join (select * from DataVaultTest.hub.hubBookingManifestAdditionals) hub on src.BOOK_NR =  hub.bookingNumber and src.SEGMENT_CODE =  hub.segmentCode and src.SEQ_NR =  hub.sequenceNr and src.SELSKAB =  hub.accessCompanyId and src.SrcSystemId = hub.srcSystemId and src.cdcOperation = 'D ' and src.ReasonDeleted not in (1,2))q
bookDetails.UNITY.delete.count = select count (*) c from stg.UNITY_BookDetails where partitionId =1 and isDeleted = 1 and ReasonDeleted = 3
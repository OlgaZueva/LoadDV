system.default.RowsForMatch = 8
system.PercentOfRows = 1

fctBookingCargo.dwh.CountRows = select count (*) c from (select distinct dwhIdHubBookingCargo, validFrom from sat.satBookingCargo union select distinct dwhIdHubBookingCargo, validFrom from sat.satBookingCargoStatus union select distinct dwhIdHubBookingCargo, validFrom from sat.satLnkBookingBookingCargo union select distinct dwhIdHubBookingCargo, validFrom from sat.satLnkBookingCargoContainerType union select distinct dwhIdHubBookingCargo, validFrom from sat.satLnkBookingCargoFullEmpty) q
fctBookingCargo.fct.CountRows = select COUNT (*) c from (select dwhIdHubBookingCargo, validFrom  from fct.factBookingCargo)q
fctBookingCargo.dataInDV.RowByRowNum = select * from (SELECT ROW_NUMBER() OVER (Order by allSatLnk2.dwhIdHubBookingCargo) AS RowNumber, allSatLnk2.dwhIdHubBooking, allSatLnk2.dwhIdHubBookingCargo, allSatLnk2.dwhIdHubContainerType, satLnk3.dwhIdHubFullEmpty, allSatLnk2.teus, allSatLnk2.containerCount, allSatLnk2.accessCompanyId, allSatLnk2.srcSystemId, allSatLnk2.status, allSatLnk2.validFrom   FROM sat.satLnkBookingCargoFullEmpty satLnk3 LEFT JOIN (SELECT  allSatLnk1.dwhIdHubBooking, allSatLnk1.dwhIdHubBookingCargo, satLnk2.dwhIdHubContainerType, allSatLnk1.teus, allSatLnk1.containerCount, allSatLnk1.accessCompanyId, allSatLnk1.srcSystemId, allSatLnk1.status, allSatLnk1.validFrom  FROM sat.satLnkBookingCargoContainerType satLnk2 LEFT JOIN (SELECT  satLnk1.dwhIdHubBooking, hubSatStatus.dwhIdHubBookingCargo,hubSatStatus.teus, hubSatStatus.containerCount, hubSatStatus.accessCompanyId, hubSatStatus.srcSystemId, hubSatStatus.status, hubSatStatus.validFrom FROM sat.satLnkBookingBookingCargo satLnk1 LEFT JOIN ( SELECT hubSat.dwhIdHubBookingCargo, hubSat.teus, hubSat.containerCount,  hubSat.accessCompanyId, hubSat.srcSystemId, satStatus.status, satStatus.validFrom  from sat.satBookingCargoStatus satStatus inner join (SELECT dwhIdHubBookingCargo, CASE WHEN containerTypeCode =2 THEN 1 WHEN containerTypeCode =4 THEN 2 ELSE 0 end teus,  containerCount, accessCompanyId, srcSystemId FROM (select distinct hub.dwhIdHubBookingCargo, LTRIM(SUBSTRING (sat.containerTypeCode, 1,1)) AS containerTypeCode, sat.containerCount, hub.accessCompanyId, hub.srcSystemId from sat.satBookingCargo sat inner join (select  dwhIdHubBookingCargo, srcSystemId, accessCompanyId from hub.hubBookingCargo) hub on hub.dwhIdHubBookingCargo = sat.dwhIdHubBookingCargo) substrContTypeCode) hubSat ON   hubSat.dwhIdHubBookingCargo = satStatus.dwhIdHubBookingCargo) hubSatStatus ON hubSatStatus.dwhIdHubBookingCargo = satLnk1.dwhIdHubBookingCargo) allSatLnk1 ON allSatLnk1.dwhIdHubBookingCargo = satLnk2.dwhIdHubBookingCargo) allSatLnk2 ON allSatLnk2.dwhIdHubBookingCargo = satLnk3.dwhIdHubBookingCargo) q where RowNumber =
fctBookingCargo.dataInDM.RowByKeys = SELECT  dwhIdHubBooking, dwhIdHubBookingCargo, dwhIdHubContainerType, dwhIdHubFullEmpty, teus, containerCount, srcSystemId, accessCompanyId, dmStatus AS status, validFrom from  fct.factBookingCargo